<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ScribbleTools: Free Online Calculators & Tools for Math, Text, Finance, Health</title>
    <meta name="description" content="ScribbleTools is the professional, ad-free toolbox for math, text, finance, health, and more. Fast, privacy-first, and always free. Trusted by students, teachers, and professionals.">
    <meta name="keywords" content="online calculator, math calculator, area calculator, volume calculator, perimeter calculator, surface area calculator, text tools, financial calculator, health calculator, free utilities, ad-free tools, privacy-first tools, professional calculators">
    <meta name="robots" content="index, follow">
    <meta name="author" content="ScribbleTools Team">
    <meta http-equiv="Content-Language" content="en">
    <link rel="canonical" href="https://scribbletools.com/">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta name="theme-color" content="#D9534F">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="website">
    <meta property="og:title" content="ScribbleTools: Free Online Calculators & Tools for Math, Text, Finance, Health">
    <meta property="og:description" content="ScribbleTools is the professional, ad-free toolbox for math, text, finance, health, and more. Fast, privacy-first, and always free. Trusted by students, teachers, and professionals.">
    <meta property="og:url" content="https://scribbletools.com/">
    <meta property="og:site_name" content="ScribbleTools">
    <meta property="og:image" content="https://scribbletools.com/assets/og-image.svg">
    <meta property="og:image:alt" content="ScribbleTools - Free Online Calculators & Tools for Math, Text, Finance, Health">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ScribbleTools: Free Online Calculators & Tools for Math, Text, Finance, Health">
    <meta name="twitter:description" content="ScribbleTools is the professional, ad-free toolbox for math, text, finance, health, and more. Fast, privacy-first, and always free. Trusted by students, teachers, and professionals.">
    <meta name="twitter:image" content="https://scribbletools.com/assets/og-image.svg">
    <meta name="twitter:site" content="@scribbletools">
    <meta name="twitter:creator" content="@scribbletools">
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "ScribbleTools",
      "url": "https://scribbletools.com/",
      "description": "ScribbleTools is the professional, ad-free toolbox for math, text, finance, health, and more. Fast, privacy-first, and always free.",
      "inLanguage": "en",
      "publisher": {
        "@type": "Organization",
        "name": "ScribbleTools Team",
        "url": "https://scribbletools.com/"
      },
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://scribbletools.com/?q={search_term_string}",
        "query-input": "required name=search_term_string"
      }
    }
    </script>
    <!-- Configuration -->
    <script src="config.js"></script>

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'GA_MEASUREMENT_ID', {
            page_title: document.title,
            page_location: window.location.href
        });
    </script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Suppress Tailwind CDN production warning
        if (typeof tailwind !== 'undefined') {
            tailwind.config = {
                ...tailwind.config,
                corePlugins: {
                    preflight: true,
                }
            };
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>

    <!-- Google Fonts: Caveat for handwritten style, and Poppins for readability -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
                body, html {
    overflow-x: hidden;
    width: 100%;
    margin: 0;
}
body { 
    font-family: 'Poppins', sans-serif; 
    background-color: #F8F4E8;
    color: #4A4A4A;
    font-size: clamp(0.85rem, 2vw, 1.1rem);
    padding: clamp(0.125rem, 2vw, 1rem);
    line-height: 1.4;
}
h1, h2, h3 {
    font-size: clamp(1.25rem, 4vw, 2rem);
    line-height: 1.2;
    margin: 0.5rem 0;
}
.handwritten {
    font-family: 'Caveat', cursive;
    cursor: pointer;
}
#app-container, .container {
    width: 100%;
    max-width: 100%;
    box-sizing: border-box;
    padding: clamp(0.25rem, 3vw, 1.5rem);
    margin: 0 auto;
}
#app-container > * { animation: fadeIn 0.5s ease-in-out; }
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

/* Marquee Animation */
@keyframes marquee {
    0% { transform: translateX(100%); }
    100% { transform: translateX(-100%); }
}
.marquee-content {
    display: inline-block;
    animation: marquee 20s linear infinite;
    animation-delay: 0.5s;
    font-size: 14px;
    font-weight: 500;
    will-change: transform;
    backface-visibility: hidden;
}
#mobile-marquee {
    contain: layout style paint;
}
.spinner {
    border: 4px solid rgba(0, 0, 0, 0.1);
    border-radius: 50%;
    border-top: 4px solid #D9534F;
    width: 24px;
    height: 24px;
    animation: spin 1s linear infinite;
}
@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}
.nav-category summary {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-size: clamp(0.9rem, 2.5vw, 1.1rem);
    font-weight: 700;
    color: #333;
    padding: clamp(0.4rem, 2vw, 0.75rem);
    border-radius: 0.5rem;
    cursor: pointer;
    transition: all 0.2s ease;
    list-style: none;
    min-height: 44px;
    box-sizing: border-box;
    background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
    border: 1px solid #e2e8f0;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}
.nav-category summary::-webkit-details-marker { display: none; }
.nav-category summary:hover { 
    background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
    border-color: #D9534F;
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(217, 83, 79, 0.1);
}
.nav-category summary .arrow { 
    margin-left: auto; 
    transition: transform 0.2s ease;
    color: #D9534F;
    font-weight: bold;
}
.nav-category[open] > summary .arrow { transform: rotate(90deg); }
.nav-category[open] > summary { 
    background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
    border-color: #D9534F;
    color: #D9534F;
}

/* Enhanced dropdown transitions */
.nav-category, .nav-subcategory {
    transition: all 0.2s ease;
}
.nav-category .arrow, .nav-subcategory .arrow {
    transition: transform 0.2s ease;
}
.nav-category[open] .nav-links, .nav-subcategory[open] .nav-links {
    animation: dropdownOpen 0.2s ease;
}
@keyframes dropdownOpen {
    from { opacity: 0; transform: translateY(-5px); }
    to { opacity: 1; transform: translateY(0); }
}
/* Desktop dropdown auto-close styling */
.nav-category:not([open]) .nav-links, .nav-subcategory:not([open]) .nav-links {
    animation: dropdownClose 0.2s ease;
}
@keyframes dropdownClose {
    from { opacity: 1; transform: translateY(0); }
    to { opacity: 0; transform: translateY(-5px); }
}
/* Smooth summary transitions */
.nav-category summary, .nav-subcategory summary {
    transition: all 0.2s ease, background-color 0.2s ease;
}
.nav-category[open] summary, .nav-subcategory[open] summary {
    transition: all 0.2s ease, background-color 0.2s ease;
}
.nav-links {
    padding-left: clamp(0.25rem, 2vw, 1rem);
    border-left: none;
    margin-left: clamp(0.25rem, 2vw, 0.75rem);
    margin-top: 0.5rem;
    background: linear-gradient(135deg, #fafbfc 0%, #f8fafc 100%);
    border-radius: 0.5rem;
    padding: 0.5rem;
    box-shadow: inset 0 1px 2px rgba(0,0,0,0.05);
}
.nav-link {
    display: block;
    padding: clamp(0.3rem, 1.5vw, 0.5rem) clamp(0.4rem, 2vw, 1rem);
    border-radius: 0.375rem;
    font-size: clamp(0.8rem, 2vw, 0.9rem);
    color: #6C6C6C;
    transition: all 0.2s ease;
    font-weight: 500;
    min-height: 40px;
    display: flex;
    align-items: center;
    line-height: 1.2;
    word-wrap: break-word;
    hyphens: auto;
    background: white;
    border: 1px solid transparent;
    margin-bottom: 0.125rem;
}
.nav-link:hover { 
    background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
    color: #333; 
    border-color: #D9534F;
    transform: translateX(4px);
    box-shadow: 0 2px 4px rgba(217, 83, 79, 0.1);
}
.nav-link.active { 
    background: linear-gradient(135deg, #D9534F 0%, #c44347 100%);
    color: white; 
    border-color: #D9534F;
    box-shadow: 0 2px 8px rgba(217, 83, 79, 0.3);
}
.nav-subcategory summary {
    font-size: clamp(0.8rem, 2vw, 0.9rem);
    padding: clamp(0.3rem, 1.5vw, 0.6rem);
    gap: 0.5rem;
    font-weight: 600;
    min-height: 40px;
    background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
    border-radius: 0.375rem;
    border: 1px solid #e2e8f0;
    transition: all 0.2s ease;
    margin-bottom: 0.25rem;
}
.nav-subcategory summary:hover {
    background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
    border-color: #D9534F;
    transform: translateY(-1px);
}
.nav-subcategory .nav-links {
     margin-left: clamp(0.25rem, 2vw, 0.75rem);
     padding-left: clamp(0.25rem, 2vw, 0.75rem);
     background: white;
     border-radius: 0.375rem;
     border: 1px solid #e2e8f0;
     padding: 0.375rem;
}
.sub-nav-link {
    font-size: clamp(0.75rem, 1.8vw, 0.85rem);
    padding-left: clamp(0.4rem, 2vw, 1rem);
    min-height: 38px;
    background: #fafbfc;
    border: 1px solid #f1f5f9;
    border-radius: 0.25rem;
    margin-bottom: 0.125rem;
    transition: all 0.2s ease;
}
.sub-nav-link:hover {
    background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
    border-color: #D9534F;
    transform: translateX(2px);
}

/* External link styling */
.external-link {
    background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%) !important;
    border-color: #22c55e !important;
    color: #15803d !important;
    font-weight: 500 !important;
}

.external-link:hover {
    background: linear-gradient(135deg, #bbf7d0 0%, #86efac 100%) !important;
    border-color: #16a34a !important;
    color: #14532d !important;
    transform: translateX(4px) !important;
}

#mobile-nav-toggle, #mobile-header-toggle {
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    min-width: 44px;
    min-height: 44px;
    font-size: clamp(0.8rem, 2.5vw, 1.3rem);
    padding: clamp(0.5rem, 2vw, 0.6rem);
    border-radius: 0.5rem;
    touch-action: manipulation;
}
#nav-toggle-icon {
    transition: transform 0.3s ease;
}
#tool-nav {
    transition: all 0.3s ease;
}
#mobile-header-menu {
    transition: all 0.3s ease;
    border-top: 1px solid #e5e7eb;
    width: 100vw;
    position: absolute;
    left: 0;
    top: 60px;
    background: #F8F4E8;
    z-index: 999;
}
.mobile-nav-link {
    font-weight: 500;
    color: #374151;
    border-bottom: 1px solid #f3f4f6;
    min-height: 44px;
    display: flex;
    align-items: center;
    font-size: clamp(0.9rem, 2.5vw, 1rem);
}
.mobile-nav-link:last-child {
    border-bottom: none;
}
#mobile-header-toggle:hover {
    background-color: #f9fafb;
}
img, video {
    max-width: 100%;
    height: auto;
    display: block;
}
/* Utility classes for better space usage */
.under-development {
    color: #ff9800;
    font-size: 0.8em;
}
/* --- Mobile Responsive --- */
@media (max-width: 768px) {
  body {
    padding: 0.125rem;
    font-size: 0.9rem;
    line-height: 1.5;
  }
  
  .container {
    max-width: 100vw;
    padding: 0.125rem;
    margin: 0;
  }
  
  #app-container {
    padding: 0.25rem;
    margin: 0;
    border-radius: 0.375rem;
    width: 100%;
    max-width: 100%;
    box-shadow: none;
    border: none;
  }
  
  /* Modern card-based navigation */
  .nav-category,
  .nav-links,
  .nav-subcategory {
    width: 100%;
    display: block;
    overflow-x: visible;
    padding: 0;
    box-sizing: border-box;
    margin: 0 0 0.5rem 0;
    background: white;
    border-radius: 8px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  }
  
  .nav-category summary {
    padding: 0.75rem;
    font-size: 1rem;
    font-weight: 600;
    min-height: 48px;
    display: flex;
    align-items: center;
    background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
    border-radius: 8px;
    margin-bottom: 0.5rem;
  }
  
  .nav-subcategory {
    background: #fafafa;
    border-radius: 6px;
    margin: 0.25rem 0;
  }
  
  .nav-subcategory summary {
    padding: 0.5rem 0.75rem;
    font-size: 0.9rem;
    font-weight: 500;
    min-height: 42px;
    background: #f8f9fa;
    border-radius: 6px;
  }
  
  .nav-link,
  .sub-nav-link {
    display: block;
    font-size: 0.85rem;
    margin-bottom: 0.125rem;
    padding: 0.6rem 0.75rem;
    min-height: 44px;
    line-height: 1.3;
    word-wrap: break-word;
    background: white;
    border-radius: 4px;
    border: 1px solid #e2e8f0;
    transition: all 0.2s ease;
  }
  
  .nav-link:hover,
  .sub-nav-link:hover {
    background: #f0f9ff;
    border-color: #D9534F;
    transform: translateY(-1px);
  }
  
  .nav-links {
    padding: 0.5rem;
    margin: 0;
    border: none;
    background: transparent;
  }
  
  .nav-subcategory .nav-links {
    margin: 0;
    padding: 0.5rem;
    background: white;
    border-radius: 0 0 6px 6px;
  }
  
  /* Header optimization */
  header .container {
    padding: 0.5rem;
  }
  
  .handwritten {
    font-size: 1.25rem;
  }
  
  /* Mobile navigation improvements */
  #mobile-nav-toggle {
    padding: 0.75rem;
    font-size: 0.9rem;
    min-height: 48px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(217, 83, 79, 0.2);
  }
  
  #tool-search {
    padding: 0.75rem 0.75rem 0.75rem 2.5rem;
    font-size: 0.9rem;
    border-width: 1px;
    border-radius: 8px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  }
  
  /* Optimize spacing */
  .flex.gap-4 {
    gap: 0.5rem;
  }
  
  .py-4 {
    padding-top: 0.5rem;
    padding-bottom: 0.5rem;
  }
  
  .mb-3 {
    margin-bottom: 0.5rem;
  }
  
  .space-y-1 > * + * {
    margin-top: 0.25rem;
  }
  
  .space-y-2 > * + * {
    margin-top: 0.5rem;
  }
  
  /* Footer optimization */
  footer {
    padding: 0.5rem;
  }
  
  footer .container {
    padding: 0.25rem;
  }
  
  footer .gap-6 {
    gap: 1rem;
  }
}

@media (max-width: 480px) {
    body {
        padding: 0.0625rem;
        font-size: 0.85rem;
        line-height: 1.4;
    }
    
    .container, #app-container {
        padding: 0.125rem;
        margin: 0;
        width: 100%;
        max-width: 100%;
    }
    
    /* Enhanced card design for smaller screens */
    .nav-category summary {
        padding: 0.6rem;
        font-size: 0.9rem;
        min-height: 44px;
        background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
        border-radius: 6px;
    }
    
    .nav-subcategory summary {
        padding: 0.4rem 0.6rem;
        font-size: 0.8rem;
        min-height: 40px;
        background: #f8f9fa;
        border-radius: 4px;
    }
    
    .nav-link, .sub-nav-link {
        padding: 0.5rem 0.6rem;
        font-size: 0.8rem;
        min-height: 40px;
        line-height: 1.3;
        border-radius: 4px;
        margin-bottom: 0.125rem;
    }
    
    .nav-category,
    .nav-subcategory {
        margin-bottom: 0.375rem;
        box-shadow: 0 1px 2px rgba(0,0,0,0.08);
    }
    
    /* Tool content area optimization */
    #tool-content {
        padding: 0.5rem;
        margin: 0;
        width: 100%;
        border-radius: 8px;
        background: #ffffff;
        box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        overflow: hidden;
    }
    
    /* Logo optimization for mobile */
    .logo {
        font-size: 1.2rem !important;
        padding: 0.25rem 0.5rem;
    }
    
    /* Search input mobile optimization */
    #tool-search {
        padding: 0.6rem 0.6rem 0.6rem 2.25rem;
        font-size: 0.85rem;
        border-radius: 6px;
    }
    
    /* Mobile nav toggle */
    #mobile-nav-toggle {
        padding: 0.6rem;
        font-size: 0.85rem;
        min-height: 44px;
        border-radius: 6px;
    }
}

@media (max-width: 360px) {
    body {
        padding: 0.0313rem;
        font-size: 0.8rem;
        line-height: 1.35;
    }
    
    .container, #app-container {
        padding: 0.0625rem;
        margin: 0;
        width: 100%;
        max-width: 100%;
    }
    
    /* Ultra-compact card design */
    .nav-category summary {
        padding: 0.5rem;
        font-size: 0.85rem;
        min-height: 40px;
        background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
        border-radius: 5px;
    }
    
    .nav-subcategory summary {
        padding: 0.35rem 0.5rem;
        font-size: 0.75rem;
        min-height: 36px;
        background: #f8f9fa;
        border-radius: 4px;
    }
    
    .nav-link, .sub-nav-link {
        padding: 0.4rem 0.5rem;
        font-size: 0.75rem;
        min-height: 36px;
        line-height: 1.2;
        border-radius: 3px;
        margin-bottom: 0.1rem;
    }
    
    .nav-category,
    .nav-subcategory {
        margin-bottom: 0.25rem;
        box-shadow: 0 1px 2px rgba(0,0,0,0.06);
    }
    
    /* Tool content ultra-compact */
    #tool-content {
        padding: 0.375rem;
        border-radius: 6px;
        margin: 0;
        width: 100%;
    }
    
    /* Logo ultra-compact */
    .logo {
        font-size: 1rem !important;
        padding: 0.2rem 0.4rem;
    }
    
    /* Search ultra-compact */
    #tool-search {
        padding: 0.5rem 0.5rem 0.5rem 2rem;
        font-size: 0.8rem;
        border-radius: 5px;
    }
    
    /* Mobile nav toggle ultra-compact */
    #mobile-nav-toggle {
        padding: 0.5rem;
        font-size: 0.8rem;
        min-height: 40px;
        border-radius: 5px;
    }
    
    .nav-links {
        padding: 0.375rem;
        margin: 0;
    }
    
    .nav-subcategory .nav-links {
        margin: 0;
        padding: 0.375rem;
    }
    
    .handwritten {
        font-size: 1rem;
    }
    
    #mobile-nav-toggle {
        padding: 0.6rem;
        font-size: 0.8rem;
        min-height: 44px;
        border-radius: 6px;
    }
    
    #tool-search {
        padding: 0.6rem 0.6rem 0.6rem 2.25rem;
        font-size: 0.8rem;
        border-radius: 6px;
    }
    
    /* Ultra-compact spacing for smaller screens */
    .space-y-1 > * + * {
        margin-top: 0.125rem;
    }
    
    .relative.mb-2 {
        margin-bottom: 0.25rem;
    }
    
    /* Optimize header for smaller screens */
    header .container {
        padding: 0.25rem;
    }
    
    /* Footer ultra-compact */
    footer {
        padding: 0.25rem;
    }
    
    footer .container {
        padding: 0.125rem;
    }
    
    footer .gap-6 {
        gap: 0.5rem;
    }
    
    footer .text-sm {
        font-size: 0.75rem;
    }
}

/* Extra small devices - modern card layout */
@media (max-width: 360px) {
    body {
        padding: 0;
        font-size: 0.8rem;
        line-height: 1.4;
    }
    
    .container, #app-container {
        padding: 0.0625rem;
        border-radius: 0.25rem;
        width: 100%;
        max-width: 100%;
    }
    
    header .container {
        padding: 0.125rem;
    }
    
    .handwritten {
        font-size: 0.9rem;
    }
    
    /* Micro card design for ultra-small screens */
    .nav-category {
        margin-bottom: 0.25rem;
        box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        border-radius: 6px;
    }
    
    .nav-category summary {
        padding: 0.5rem;
        font-size: 0.85rem;
        min-height: 42px;
        background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
        border-radius: 6px;
        font-weight: 600;
    }
    
    .nav-subcategory {
        margin: 0.125rem 0;
        border-radius: 4px;
    }
    
    .nav-subcategory summary {
        padding: 0.375rem 0.5rem;
        font-size: 0.75rem;
        min-height: 38px;
        background: #f8f9fa;
        border-radius: 4px;
        font-weight: 500;
    }
    
    .nav-link, .sub-nav-link {
        padding: 0.4rem 0.5rem;
        font-size: 0.75rem;
        min-height: 38px;
        line-height: 1.2;
        border-radius: 3px;
        margin-bottom: 0.1rem;
        background: white;
        border: 1px solid #e2e8f0;
    }
    
    .nav-links {
        padding: 0.25rem;
        margin: 0;
    }
    
    .nav-subcategory .nav-links {
        margin: 0;
        padding: 0.25rem;
        background: white;
        border-radius: 0 0 4px 4px;
    }
    
    #mobile-nav-toggle {
        padding: 0.5rem;
        font-size: 0.75rem;
        min-height: 42px;
        border-radius: 6px;
    }
    
    #tool-search {
        padding: 0.5rem 0.5rem 0.5rem 2rem;
        font-size: 0.75rem;
        border-radius: 6px;
    }
    
    .mobile-nav-link {
        font-size: 0.85rem;
        padding: 0.5rem 1rem;
    }
    
    /* Minimal spacing for ultra-compact view */
    .space-y-1 > * + * {
        margin-top: 0.1rem;
    }
    
    .relative.mb-2 {
        margin-bottom: 0.125rem;
    }
    
    footer {
        padding: 0.125rem;
    }
    
    footer .container {
        padding: 0;
    }
    
    footer .gap-6 {
        gap: 0.25rem;
    }
    
    footer .text-sm {
        font-size: 0.7rem;
    }
    
    .mb-3 {
        margin-bottom: 0.25rem;
    }
    
    /* Enhanced visual separation */
    .nav-category:not(:last-child) {
        border-bottom: 1px solid #f1f5f9;
        padding-bottom: 0.25rem;
    }
}

/* Modern Tool Content Area Styling */
@media (max-width: 768px) {
    #tool-content {
        padding: 1rem;
        margin: 0.5rem 0;
        width: 100%;
        max-width: 100%;
        border-radius: 12px;
        background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
        box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        border: 1px solid #e2e8f0;
        overflow: hidden;
    }
    
    #tool-content iframe {
        width: 100% !important;
        min-height: 60vh;
        border: none;
        border-radius: 8px;
    }
    
    /* Ensure all tool elements use full width */
    #tool-content * {
        max-width: 100% !important;
        box-sizing: border-box;
    }
    
    /* Tool loading state */
    #tool-content:empty::after {
        content: "Select a tool from the menu to get started";
        display: block;
        text-align: center;
        color: #64748b;
        font-style: italic;
        padding: 2rem;
        background: #f8fafc;
        border-radius: 8px;
        border: 2px dashed #cbd5e1;
    }
}

/* Mobile Privacy Notice Optimization */
@media (max-width: 768px) {
    #privacy-notice {
        bottom: 1rem;
        right: 0.5rem;
        z-index: 40;
    }
    
    #privacy-btn {
        width: 3rem;
        height: 3rem;
        padding: 0;
        box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        border: 2px solid rgba(255,255,255,0.3);
    }
    
    #privacy-btn:hover {
        transform: scale(1.1);
        box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }
    
    /* Reduce animation intensity on mobile */
    #privacy-btn {
        animation: none;
    }
    
    /* Mobile hover tooltip positioning */
    .mobile-privacy-tooltip {
        position: absolute;
        bottom: 100%;
        right: 0;
        margin-bottom: 0.5rem;
        background: rgba(0,0,0,0.8);
        color: white;
        padding: 0.25rem 0.5rem;
        border-radius: 0.375rem;
        font-size: 0.75rem;
        white-space: nowrap;
        opacity: 0;
        transform: translateY(10px);
        transition: all 0.3s ease;
        pointer-events: none;
    }
    
    #privacy-btn:hover .mobile-privacy-tooltip {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Modern Interactive Effects */
@media (max-width: 768px) {
    /* Enhanced navigation hover effects */
    .nav-category summary:hover {
        background: linear-gradient(135deg, #e2e8f0 0%, #cbd5e1 100%);
        transform: translateY(-1px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.12);
        transition: all 0.2s ease;
    }
    
    .nav-subcategory summary:hover {
        background: #e2e8f0;
        transform: translateY(-1px);
        box-shadow: 0 2px 4px rgba(0,0,0,0.08);
        transition: all 0.2s ease;
    }
    
    .nav-link:hover, .sub-nav-link:hover {
        background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
        color: #1d4ed8;
        transform: translateX(4px);
        box-shadow: 0 2px 6px rgba(59, 130, 246, 0.2);
        transition: all 0.2s ease;
    }
    
    /* Search input focus state */
    #tool-search:focus {
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        background: white;
        outline: none;
        transition: all 0.2s ease;
    }
    
    /* Mobile nav toggle hover state */
    #mobile-nav-toggle:hover {
        background: #dc2626;
        transform: translateY(-1px);
        box-shadow: 0 4px 8px rgba(220, 38, 38, 0.3);
        transition: all 0.2s ease;
    }
    
    /* Active states */
    .nav-category[open] > summary {
        background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
        color: #1d4ed8;
        border-bottom: 2px solid #3b82f6;
    }
    
    .nav-subcategory[open] > summary {
        background: #dbeafe;
        color: #1d4ed8;
    }
}

@media (max-width: 480px) {
    #privacy-notice {
        bottom: 0.75rem;
        right: 0.25rem;
    }
    
    #privacy-btn {
        width: 2.5rem;
        height: 2.5rem;
        box-shadow: 0 1px 6px rgba(0,0,0,0.15);
    }
    
    #privacy-btn span {
        font-size: 1rem;
    }
}

@media (max-width: 360px) {
    #privacy-notice {
        bottom: 0.5rem;
        right: 0.125rem;
    }
    
    #privacy-btn {
        width: 2.25rem;
        height: 2.25rem;
    }
    
    #privacy-btn span {
        font-size: 0.9rem;
    }
}
    </style>
</head>
<body class="antialiased">
    <!-- Mobile Marquee Message -->
    <div id="mobile-marquee" class="block md:hidden bg-gradient-to-r from-blue-600 to-purple-600 text-white py-2 overflow-hidden">
        <div class="marquee-content whitespace-nowrap">
            ðŸ“± All tools available on mobile! Try desktop for enhanced experience âœ¨ | ðŸ“± All tools available on mobile! Try desktop for enhanced experience âœ¨
        </div>
    </div>

    <div class="min-h-screen flex flex-col">
        <!-- Header Navigation -->
        <header class="w-full bg-white shadow-sm border-b border-gray-200 relative">
            <div class="container mx-auto flex justify-between items-center py-4 px-4">
                <a href="#home" id="logo-link" class="handwritten text-3xl text-[#D9534F] hover:underline focus:outline-none">ScribbleTools</a>
                
                <!-- Desktop Navigation -->
                <div class="hidden md:flex items-center gap-8">
                    <nav class="flex gap-4 sidebar-nav hover:w-auto transition-all duration-200">
                        <a href="#about" class="nav-link flex items-center"><span class="sidebar-label">About</span></a>
                        <a href="#personal-notes" class="nav-link flex items-center"><span class="sidebar-label">Personal Notes</span></a>
                        <a href="#blogs" class="nav-link flex items-center"><span class="sidebar-label">Blogs</span></a>
                        <a href="#all-tools" class="nav-link flex items-center"><span class="sidebar-label">Keymap</span></a>
                        <a href="#feedback" class="nav-link flex items-center"><span class="sidebar-label">Feedback</span></a>
                        <a href="#contact" class="nav-link flex items-center"><span class="sidebar-label">Contact</span></a>
                        <a href="#request-tool" class="nav-link flex items-center"><span class="sidebar-label">Request a Tool</span></a>
                    </nav>
                </div>
                
                <!-- Mobile Menu Button -->
                <button id="mobile-header-toggle" class="md:hidden p-2 hover:bg-gray-100 rounded-lg transition-colors" title="Open menu" aria-label="Open navigation menu">
                    <svg id="mobile-header-icon" class="w-6 h-6 text-gray-700 transition-transform" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                    </svg>
                </button>
            </div>
            
            <!-- Mobile Menu Dropdown -->
            <div id="mobile-header-menu" class="absolute top-full left-0 right-0 bg-white shadow-lg border-b border-gray-200 hidden md:hidden z-50">
                <nav class="flex flex-col py-4">
                    <a href="#about" class="mobile-nav-link px-6 py-3 hover:bg-gray-50 transition-colors">About</a>
                    <a href="#personal-notes" class="mobile-nav-link px-6 py-3 hover:bg-gray-50 transition-colors">Personal Notes</a>
                    <a href="#blogs" class="mobile-nav-link px-6 py-3 hover:bg-gray-50 transition-colors">Blogs</a>
                    <a href="#all-tools" class="mobile-nav-link px-6 py-3 hover:bg-gray-50 transition-colors">Keymap</a>
                    <a href="#feedback" class="mobile-nav-link px-6 py-3 hover:bg-gray-50 transition-colors">Feedback</a>
                    <a href="#contact" class="mobile-nav-link px-6 py-3 hover:bg-gray-50 transition-colors">Contact</a>
                    <a href="#request-tool" class="mobile-nav-link px-6 py-3 hover:bg-gray-50 transition-colors">Request a Tool</a>
                </nav>
            </div>
        </header>
        <!-- Main Content Area -->
        <div class="container mx-auto px-0 md:px-4 py-1 md:py-8 flex-grow">
            <div class="flex flex-col md:flex-row gap-1 md:gap-8">
                
                <!-- Sidebar Navigation -->
                <aside class="w-full md:w-1/4 lg:w-1/5">
                    <!-- Mobile Toggle Button -->
                    <div class="md:hidden mb-0.5">
                        <button id="mobile-nav-toggle" class="w-full bg-[#D9534F] text-white py-2 px-3 rounded-lg font-semibold flex items-center justify-center gap-2 hover:bg-[#c44347] transition-colors text-sm">
                            <svg id="nav-toggle-icon" class="w-4 h-4 transition-transform" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd" />
                            </svg>
                            <span id="nav-toggle-text">Show Tools Menu</span>
                        </button>
                    </div>
                    
                     <nav id="tool-nav" class="flex flex-col space-y-0 md:space-y-2 hidden md:flex">
                        <!-- Search Bar at top -->
                        <div class="relative mb-0.5 md:mb-3 px-0 md:px-2">
                            <input type="text" id="tool-search" placeholder="Find a tool..." class="w-full p-3 pl-10 border-2 border-gray-200 rounded-lg bg-white focus:border-red-400 focus:ring-2 focus:ring-red-100 focus:outline-none text-xs md:text-sm transition-all duration-200 shadow-sm">
                            <svg class="absolute left-3 md:left-6 top-1/2 -translate-y-1/2 w-4 h-4 md:w-5 md:h-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 1 0 0 11 5.5 5.5 0 0 0 0-11ZM2 9a7 7 0 1 1 12.15 4.906l3.44 3.44a.75.75 0 1 1-1.06 1.06l-3.44-3.44A7 7 0 0 1 2 9Z" clip-rule="evenodd" /></svg>
                        </div>

                        <!-- Main Tool Categories at top -->
                        <details class="nav-category">
                            <summary><span>Text Tools</span><span class="arrow">â–¶</span></summary>
                            <div class="nav-links flex flex-col space-y-1 mt-2">
                                <details class="nav-subcategory"><summary><span>Manipulation</span><span class="arrow">â–¶</span></summary><div class="nav-links flex flex-col space-y-1 mt-2">
                                    <a href="#change-case" class="nav-link sub-nav-link">Change Case</a>
                                    <a href="#find-replace" class="nav-link sub-nav-link">Find & Replace</a>
                                    <a href="#reverse-text" class="nav-link sub-nav-link">Reverse Text</a>
                                    <a href="#split-text" class="nav-link sub-nav-link">Split Text</a>
                                    <a href="#join-text" class="nav-link sub-nav-link">Join Text</a>
                                    <a href="#repeat-text" class="nav-link sub-nav-link">Repeat Text</a>
                                    <a href="#sort-lines" class="nav-link sub-nav-link">Sort Lines (A-Z, Z-A, Random)</a>
                                    <a href="#shuffle-lines" class="nav-link sub-nav-link">Shuffle Lines</a>
                                    <a href="#remove-punctuation" class="nav-link sub-nav-link">Remove Punctuation</a>
                                    <a href="#text-indenter" class="nav-link sub-nav-link">Text Indenter/Unindenter</a>
                                    <a href="#text-dedenter" class="nav-link sub-nav-link">Text Dedenter</a>
                                    <a href="#text-justifier" class="nav-link sub-nav-link">Text Justifier (Full Justify)</a>
                                    <a href="#rot13" class="nav-link sub-nav-link">ROT13 Encoder/Decoder</a>
                                    <a href="#text-scrambler" class="nav-link sub-nav-link">Text Scrambler/Unscrambler</a>
                                </div></details>
                                <details class="nav-subcategory"><summary><span>Formatting</span><span class="arrow">â–¶</span></summary><div class="nav-links flex flex-col space-y-1 mt-2">
                                    <a href="#trim-whitespace" class="nav-link sub-nav-link">Trim Whitespace</a>
                                    <a href="#align-text" class="nav-link sub-nav-link">Align Text</a>
                                    <a href="#word-wrap" class="nav-link sub-nav-link">Word Wrap</a>
                                    <a href="#add-line-numbers" class="nav-link sub-nav-link">Add Line Numbers</a>
                                    <a href="#change-font" class="nav-link sub-nav-link">Change Font</a>
                                    <a href="#json-formatter-minifier" class="nav-link sub-nav-link">JSON Formatter/Minifier</a>
                                    <a href="#xml-formatter-minifier" class="nav-link sub-nav-link">XML Formatter/Minifier</a>
                                    <a href="#csv-json-converter" class="nav-link sub-nav-link">CSV â‡„ JSON Converter</a>
                                    <a href="#html-encode-decode" class="nav-link sub-nav-link">HTML Encode/Decode</a>
                                    <a href="#lorem-ipsum-generator" class="nav-link sub-nav-link">Lorem Ipsum Generator</a>
                                    <a href="#text-to-ascii-art" class="nav-link sub-nav-link">Text to ASCII Art</a>
                                </div></details>
                                <details class="nav-subcategory"><summary><span>Analysis</span><span class="arrow">â–¶</span></summary><div class="nav-links flex flex-col space-y-1 mt-2">
                                    <a href="#word-counter" class="nav-link sub-nav-link">Word Counter</a>
                                    <a href="#text-statistics" class="nav-link sub-nav-link">Text Statistics</a>
                                    <a href="#find-top-words" class="nav-link sub-nav-link">Find Top Words</a>
                                    <a href="#keyword-density" class="nav-link sub-nav-link">Keyword Density Analyzer</a>
                                    <a href="#unique-word-finder" class="nav-link sub-nav-link">Unique Word Finder</a>
                                    <a href="#readability-score" class="nav-link sub-nav-link">Readability Score</a>
                                </div></details>
                                <details class="nav-subcategory"><summary><span>Encoding/Other</span><span class="arrow">â–¶</span></summary><div class="nav-links flex flex-col space-y-1 mt-2">
                                    <a href="#zalgo-text" class="nav-link sub-nav-link">Zalgo Text</a>
                                    <a href="#image-from-text" class="nav-link sub-nav-link">Image from Text</a>
                                    <a href="#url-encode" class="nav-link sub-nav-link">URL Encode</a>
                                    <a href="#base64-encode" class="nav-link sub-nav-link">Base64 Encode</a>
                                    <a href="#remove-duplicate-lines" class="nav-link sub-nav-link">Remove Duplicate Lines</a>
                                    <a href="#morse-code" class="nav-link sub-nav-link">Morse Code</a>
                                    <a href="#text-diff-checker" class="nav-link sub-nav-link">Text Diff Checker</a>
                                    <a href="#unicode-converter" class="nav-link sub-nav-link">Unicode Converter</a>
                                    <a href="#binary-hex-octal-converter" class="nav-link sub-nav-link">Binary/Hex/Octal Converter</a>
                                    <a href="#upside-down-text" class="nav-link sub-nav-link">Upside Down Text</a>
                                    <a href="#mirror-text" class="nav-link sub-nav-link">Mirror Text</a>
                                    <a href="#bubble-text" class="nav-link sub-nav-link">Bubble Text</a>
                                    <a href="#fancy-unicode-text-generator" class="nav-link sub-nav-link">Fancy Unicode Text Generator</a>
                                    <a href="#emoji-replacer-inserter" class="nav-link sub-nav-link">Emoji Replacer/Inserter</a>
                                    <a href="#text-to-qr-code" class="nav-link sub-nav-link">Text to QR Code</a>
                                </div></details>
                            </div>
                        </details>

                        <details class="nav-category">
                            <summary><span>Math Calculators</span><span class="arrow">â–¶</span></summary>
                            <div class="nav-links flex flex-col space-y-1 mt-2">
                                <details class="nav-subcategory"><summary><span>Basic & Algebra</span><span class="arrow">â–¶</span></summary><div class="nav-links flex flex-col space-y-1 mt-2">
                                    <a href="#basic-calculator" class="nav-link sub-nav-link">Basic Calculator</a>
                                    <a href="#square-root-calculator" class="nav-link sub-nav-link">Square Root Calculator</a>
                                    <a href="#exponent-calculator" class="nav-link sub-nav-link">Exponent/Power Calculator</a>
                                    <a href="#fraction-calculator" class="nav-link sub-nav-link">Fraction Calculator</a>
                                    <a href="#percentage-calculator" class="nav-link sub-nav-link">Percentage Calculator</a>
                                    <a href="#discount-calculator" class="nav-link sub-nav-link">Discount Calculator</a>
                                    <a href="#tip-calculator" class="nav-link sub-nav-link">Tip Calculator</a>
                                    <a href="#simple-interest-calculator" class="nav-link sub-nav-link">Simple Interest Calculator</a>
                                    <a href="#unit-price-calculator" class="nav-link sub-nav-link">Unit Price Calculator</a>
                                    <a href="#scientific-notation-converter" class="nav-link sub-nav-link">Scientific Notation Converter</a>
                                </div></details>
                                <details class="nav-subcategory"><summary><span>Geometry</span><span class="arrow">â–¶</span></summary><div class="nav-links flex flex-col space-y-1 mt-2">
                                    <a href="#area-calculator" class="nav-link sub-nav-link">Area Calculator</a>
                                    <a href="#perimeter-calculator" class="nav-link sub-nav-link">Perimeter Calculator</a>
                                    <a href="#volume-calculator" class="nav-link sub-nav-link">Volume Calculator</a>
                                    <a href="#lateral-surface-area-calculator" class="nav-link sub-nav-link">Lateral Surface Area Calculator</a>
                                    <a href="#total-surface-area-calculator" class="nav-link sub-nav-link">Total Surface Area Calculator</a>
                                    <a href="#circle-calculator" class="nav-link sub-nav-link">Circle Calculator</a>
                                    <a href="#triangle-calculator" class="nav-link sub-nav-link">Triangle Calculator</a>
                                    <a href="#sphere-calculator" class="nav-link sub-nav-link">Sphere Calculator</a>
                                    <a href="#cylinder-calculator" class="nav-link sub-nav-link">Cylinder Calculator</a>
                                    <a href="#polygon-calculator" class="nav-link sub-nav-link">Polygon Calculator</a>
                                    <a href="#rectangle-calculator" class="nav-link sub-nav-link">Rectangle Calculator</a>
                                    <a href="#cuboid-calculator" class="nav-link sub-nav-link">Cuboid Calculator</a>
                                </div></details>
                                <details class="nav-subcategory"><summary><span>Statistics</span><span class="arrow">â–¶</span></summary><div class="nav-links flex flex-col space-y-1 mt-2">
                                    <a href="#standard-deviation-calculator" class="nav-link sub-nav-link">Standard Deviation Calculator</a>
                                    <a href="#number-sequence-calculator" class="nav-link sub-nav-link">Number Sequence Calculator</a>
                                    <a href="#sample-size-calculator" class="nav-link sub-nav-link">Sample Size Calculator</a>
                                    <a href="#probability-calculator" class="nav-link sub-nav-link">Probability Calculator</a>
                                    <a href="#statistics-calculator" class="nav-link sub-nav-link">Statistics Calculator</a>
                                    <a href="#mean-median-mode-range-calculator" class="nav-link sub-nav-link">Mean, Median, Mode, Range Calculator</a>
                                    <a href="#permutation-and-combination-calculator" class="nav-link sub-nav-link">Permutation and Combination Calculator</a>
                                    <a href="#z-score-calculator" class="nav-link sub-nav-link">Z-score Calculator</a>
                                    <a href="#confidence-interval-calculator" class="nav-link sub-nav-link">Confidence Interval Calculator</a>
                                </div></details>
                            </div>
                        </details>

                        <details class="nav-category">
                            <summary><span>Financial Calculators</span><span class="arrow">â–¶</span></summary>
                            <div class="nav-links flex flex-col space-y-1 mt-2">
                                <details class="nav-subcategory">
                                    <summary><span>Loans & Mortgages</span><span class="arrow">â–¶</span></summary>
                                    <div class="nav-links flex flex-col space-y-1 mt-2">
                                        <a href="#auto-loan-calculator" class="nav-link sub-nav-link">Auto Loan Calculator</a>
                                        <a href="#loan-calculator" class="nav-link sub-nav-link">Loan Calculator</a>
                                        <a href="#mortgage-calculator" class="nav-link sub-nav-link">Mortgage Calculator</a>
                                        <a href="#canadian-mortgage-calculator" class="nav-link sub-nav-link">Canadian Mortgage Calculator</a>
                                        <a href="#mortgage-payoff-calculator" class="nav-link sub-nav-link">Mortgage Payoff Calculator</a>
                                        <a href="#amortization-calculator" class="nav-link sub-nav-link">Amortization Calculator</a>
                                        <a href="#payment-calculator" class="nav-link sub-nav-link">Payment Calculator</a>
                                        <a href="#house-affordability-calculator" class="nav-link sub-nav-link">House Affordability Calculator</a>
                                        <a href="#rent-calculator" class="nav-link sub-nav-link">Rent Calculator</a>
                                    </div>
                                </details>
                                <details class="nav-subcategory">
                                    <summary><span>Investments & Interest</span><span class="arrow">â–¶</span></summary>
                                    <div class="nav-links flex flex-col space-y-1 mt-2">
                                        <a href="#compound-interest-calculator" class="nav-link sub-nav-link">Compound Interest Calculator</a>
                                        <a href="#interest-calculator" class="nav-link sub-nav-link">Interest Calculator</a>
                                        <a href="#interest-rate-calculator" class="nav-link sub-nav-link">Interest Rate Calculator</a>
                                        <a href="#investment-calculator" class="nav-link sub-nav-link">Investment Calculator</a>
                                        <a href="#savings-calculator" class="nav-link sub-nav-link">Savings Calculator</a>
                                        <a href="#annuity-calculator" class="nav-link sub-nav-link">Annuity Calculator</a>
                                        <a href="#inflation-calculator" class="nav-link sub-nav-link">Inflation Calculator</a>
                                    </div>
                                </details>
                                <details class="nav-subcategory">
                                    <summary><span>Retirement & Benefits</span><span class="arrow">â–¶</span></summary>
                                    <div class="nav-links flex flex-col space-y-1 mt-2">
                                        <a href="#401k-calculator" class="nav-link sub-nav-link">401K Calculator</a>
                                        <a href="#retirement-calculator" class="nav-link sub-nav-link">Retirement Calculator</a>
                                        <a href="#pension-calculator" class="nav-link sub-nav-link">Pension Calculator</a>
                                        <a href="#social-security-calculator" class="nav-link sub-nav-link">Social Security Calculator</a>
                                    </div>
                                </details>
                                <details class="nav-subcategory">
                                    <summary><span>Taxes & Income</span><span class="arrow">â–¶</span></summary>
                                    <div class="nav-links flex flex-col space-y-1 mt-2">
                                        <a href="#income-tax-calculator" class="nav-link sub-nav-link">Income Tax Calculator</a>
                                        <a href="#sales-tax-calculator" class="nav-link sub-nav-link">Sales Tax Calculator</a>
                                        <a href="#estate-tax-calculator" class="nav-link sub-nav-link">Estate Tax Calculator</a>
                                        <a href="#marriage-tax-calculator" class="nav-link sub-nav-link">Marriage Tax Calculator</a>
                                        <a href="#salary-calculator" class="nav-link sub-nav-link">Salary Calculator</a>
                                    </div>
                                </details>
                                <details class="nav-subcategory">
                                    <summary><span>General Finance</span><span class="arrow">â–¶</span></summary>
                                    <div class="nav-links flex flex-col space-y-1 mt-2">
                                        <a href="#finance-calculator" class="nav-link sub-nav-link">Finance Calculator</a>
                                        <a href="#currency-calculator" class="nav-link sub-nav-link">Currency Calculator</a>
                                    </div>
                                </details>
                            </div>
                        </details>

                        <details class="nav-category">
                            <summary><span>Health & Fitness</span><span class="arrow">â–¶</span></summary>
                            <div class="nav-links flex flex-col space-y-1 mt-2">
                                <details class="nav-subcategory">
                                    <summary><span>General Health Checkups</span><span class="arrow">â–¶</span></summary>
                                    <div class="nav-links flex flex-col space-y-1 mt-2">
                                        <a href="#bmi-calculator" class="nav-link sub-nav-link">BMI Calculator</a>
                                        <a href="#calorie-calculator" class="nav-link sub-nav-link">Calorie Calculator</a>
                                        <a href="#body-fat-calculator" class="nav-link sub-nav-link">Body Fat Calculator</a>
                                        <a href="#bmr-calculator" class="nav-link sub-nav-link">Metabolic Rate Estimator</a>
                                        <a href="#body-surface-area" class="nav-link sub-nav-link">Body Surface Estimator</a>
                                        <a href="#lean-body-mass" class="nav-link sub-nav-link">Lean Mass Checker</a>
                                        <a href="#ideal-weight" class="nav-link sub-nav-link">Ideal Body Weight Finder</a>
                                        <a href="#healthy-weight" class="nav-link sub-nav-link">Healthy Weight Range Checker</a>
                                        <a href="#body-type" class="nav-link sub-nav-link">Body Type Identifier</a>
                                        <a href="#body-water-percentage" class="nav-link sub-nav-link">Hydration Level Estimator</a>
                                        <a href="#waist-hip-ratio" class="nav-link sub-nav-link">Waist-to-Hip Ratio Tool</a>
                                        <a href="#waist-height-ratio" class="nav-link sub-nav-link">Waist-to-Height Analyzer</a>
                                    </div>
                                </details>
                                <details class="nav-subcategory">
                                    <summary><span>Nutrition & Daily Needs</span><span class="arrow">â–¶</span></summary>
                                    <div class="nav-links flex flex-col space-y-1 mt-2">
                                        <a href="#daily-calorie" class="nav-link sub-nav-link">Daily Calorie Needs Calculator</a>
                                        <a href="#macro-calculator" class="nav-link sub-nav-link">Macronutrient Split Planner</a>
                                        <a href="#protein-calculator" class="nav-link sub-nav-link">Protein Requirement Tool</a>
                                        <a href="#fat-intake" class="nav-link sub-nav-link">Fat Intake Estimator</a>
                                        <a href="#carbohydrate-calculator" class="nav-link sub-nav-link">Carb Intake Estimator</a>
                                        <a href="#tdee-calculator" class="nav-link sub-nav-link">TDEE Estimator</a>
                                        <a href="#calories-burned" class="nav-link sub-nav-link">Calories Burned Estimator</a>
                                        <a href="#weight-watcher-points" class="nav-link sub-nav-link">WW Points Calculator</a>
                                    </div>
                                </details>
                                <details class="nav-subcategory">
                                    <summary><span>Fitness & Exercise Tools</span><span class="arrow">â–¶</span></summary>
                                    <div class="nav-links flex flex-col space-y-1 mt-2">
                                        <a href="#one-rep-max" class="nav-link sub-nav-link">One Rep Max Estimator</a>
                                        <a href="#target-heart-rate" class="nav-link sub-nav-link">Target Heart Rate Finder</a>
                                        <a href="#max-heart-rate" class="nav-link sub-nav-link">Max Heart Rate Tool</a>
                                        <a href="#pace-calculator" class="nav-link sub-nav-link">Running Pace Calculator</a>
                                        <a href="#split-time" class="nav-link sub-nav-link">Split Time Tool</a>
                                        <a href="#vo2-max" class="nav-link sub-nav-link">VO2 Max Estimator</a>
                                        <a href="#mets-calculator" class="nav-link sub-nav-link">METs Activity Calculator</a>
                                        <a href="#activity-calories" class="nav-link sub-nav-link">Activity Calories Calculator</a>
                                    </div>
                                </details>
                                <details class="nav-subcategory">
                                    <summary><span>Women's Health & Pregnancy</span><span class="arrow">â–¶</span></summary>
                                    <div class="nav-links flex flex-col space-y-1 mt-2">
                                        <a href="#pregnancy-calculator" class="nav-link sub-nav-link">Pregnancy Tracker</a>
                                        <a href="#pregnancy-weight-gain" class="nav-link sub-nav-link">Weight Gain During Pregnancy</a>
                                        <a href="#pregnancy-conception" class="nav-link sub-nav-link">Conception Date Estimator</a>
                                        <a href="#due-date" class="nav-link sub-nav-link">Due Date Finder</a>
                                        <a href="#ovulation-calculator" class="nav-link sub-nav-link">Ovulation Calendar</a>
                                        <a href="#period-calculator" class="nav-link sub-nav-link">Menstrual Cycle Tracker</a>
                                    </div>
                                </details>
                                <details class="nav-subcategory">
                                    <summary><span>Clinical & Medical Tools</span><span class="arrow">â–¶</span></summary>
                                    <div class="nav-links flex flex-col space-y-1 mt-2">
                                        <a href="#gfr-calculator" class="nav-link sub-nav-link">Kidney Function (GFR) Calculator</a>
                                        <a href="#bac-calculator" class="nav-link sub-nav-link">Alcohol Level (BAC) Estimator</a>
                                        <a href="#medical-bsa" class="nav-link sub-nav-link">Medical BSA Calculator</a>
                                        <a href="#anorexic-bmi" class="nav-link sub-nav-link">Low BMI Risk Checker</a>
                                        <a href="#overweight-checker" class="nav-link sub-nav-link">Overweight Status Analyzer</a>
                                    </div>
                                </details>
                                <details class="nav-subcategory">
                                    <summary><span>Specialty & Miscellaneous</span><span class="arrow">â–¶</span></summary>
                                    <div class="nav-links flex flex-col space-y-1 mt-2">
                                        <a href="#army-body-fat" class="nav-link sub-nav-link">Army Body Fat Standard Tool</a>
                                        <a href="#bmi-for-age" class="nav-link sub-nav-link">BMI-for-Age (Teens/Kids)</a>
                                        <a href="#basal-insulin" class="nav-link sub-nav-link">Basal Insulin Estimator</a>
                                        <a href="#insulin-carb-ratio" class="nav-link sub-nav-link">Insulin-to-Carb Ratio Tool</a>
                                        <a href="#sleep-calculator" class="nav-link sub-nav-link">Optimal Sleep Time Calculator</a>
                                        <a href="#water-intake" class="nav-link sub-nav-link">Daily Water Intake Planner</a>
                                    </div>
                                </details>
                            </div>
                        </details>

                         <details class="nav-category">
                            <summary><span>Image & Media</span><span class="arrow">â–¶</span></summary>
                            <div class="nav-links flex flex-col space-y-1 mt-2">
                                <details class="nav-subcategory">
                                    <summary><span>Basic Editing</span><span class="arrow">â–¶</span></summary>
                                    <div class="nav-links flex flex-col space-y-1 mt-2">
                                        <a href="#black-white-image" class="nav-link sub-nav-link">Black & White Image</a>
                                        <a href="#grayscale-image" class="nav-link sub-nav-link">Grayscale Image</a>
                                        <a href="#flip-image" class="nav-link sub-nav-link">Flip Image</a>
                                        <a href="#rotate-image" class="nav-link sub-nav-link">Rotate Image</a>
                                        <a href="#pixelate-image" class="nav-link sub-nav-link">Pixelate Image</a>
                                        <a href="#picture-to-pixel-art" class="nav-link sub-nav-link">Picture to Pixel Art</a>
                                    </div>
                                </details>
                                <details class="nav-subcategory">
                                    <summary><span>Cropping & Shapes</span><span class="arrow">â–¶</span></summary>
                                    <div class="nav-links flex flex-col space-y-1 mt-2">
                                        <a href="#circle-crop" class="nav-link sub-nav-link">Circle Crop</a>
                                        <a href="#freehand-crop" class="nav-link sub-nav-link">Freehand Crop</a>
                                        <a href="#split-image" class="nav-link sub-nav-link">Split Image</a>
                                        <a href="#join-images-one" class="nav-link sub-nav-link">Join Images</a>
                                    </div>
                                </details>
                                <details class="nav-subcategory">
                                    <summary><span>Resizing & Format</span><span class="arrow">â–¶</span></summary>
                                    <div class="nav-links flex flex-col space-y-1 mt-2">
                                        <a href="#bulk-image-resizer" class="nav-link sub-nav-link">Bulk Image Resizer</a>
                                        <a href="#resize-image-2x2inch" class="nav-link sub-nav-link">Resize Image 2x2 inch</a>
                                        <a href="#resize-image-35mm-45mm" class="nav-link sub-nav-link">Resize Image 35mm x 45mm</a>
                                        <a href="#resize-image-3x4" class="nav-link sub-nav-link">Resize Image 3x4</a>
                                        <a href="#resize-image-3x5cm-4x5cm" class="nav-link sub-nav-link">Resize Image 3x5cm/4x5cm</a>
                                        <a href="#resize-image-4x6" class="nav-link sub-nav-link">Resize Image 4x6</a>
                                        <a href="#resize-image-600x600" class="nav-link sub-nav-link">Resize Image 600x600</a>
                                        <a href="#resize-image-6cm-2cm-300dpi" class="nav-link sub-nav-link">Resize Image 6cm x 2cm 300dpi</a>
                                        <a href="#resize-image-a4" class="nav-link sub-nav-link">Resize Image A4</a>
                                        <a href="#resize-image-cm" class="nav-link sub-nav-link">Resize Image (cm)</a>
                                        <a href="#resize-image-inches" class="nav-link sub-nav-link">Resize Image (inches)</a>
                                        <a href="#resize-image-mm" class="nav-link sub-nav-link">Resize Image (mm)</a>
                                        <a href="#resize-image-pixel" class="nav-link sub-nav-link">Resize Image (Pixels)</a>
                                        <a href="#image-converter" class="nav-link sub-nav-link">Image Converter</a>
                                    </div>
                                </details>
                                <details class="nav-subcategory">
                                    <summary><span>Compression & Quality</span><span class="arrow">â–¶</span></summary>
                                    <div class="nav-links flex flex-col space-y-1 mt-2">
                                        <a href="#image-compressor" class="nav-link sub-nav-link">Image Compressor</a>
                                        <a href="#increase-image-size-kb" class="nav-link sub-nav-link">Increase Image Size</a>
                                        <a href="#reduce-image-size-kb" class="nav-link sub-nav-link">Reduce Image Size</a>
                                        <a href="#check-image-dpi" class="nav-link sub-nav-link">Check Image DPI</a>
                                        <a href="#super-resolution" class="nav-link sub-nav-link">Super Resolution</a>
                                    </div>
                                </details>
                                <details class="nav-subcategory">
                                    <summary><span>Specialized Tools</span><span class="arrow">â–¶</span></summary>
                                    <div class="nav-links flex flex-col space-y-1 mt-2">
                                        <a href="#passport-photo-maker" class="nav-link sub-nav-link">Passport Photo Maker</a>
                                        <a href="#resize-image-pan-card" class="nav-link sub-nav-link">Resize Image PAN Card</a>
                                        <a href="#resize-image-ssc" class="nav-link sub-nav-link">Resize Image SSC</a>
                                        <a href="#resize-image-upsc" class="nav-link sub-nav-link">Resize Image UPSC</a>
                                        <a href="#add-name-dob-photo" class="nav-link sub-nav-link">Add Name & DOB to Photo</a>
                                        <a href="#generate-signature" class="nav-link sub-nav-link">Generate Signature</a>
                                        <a href="#resize-signature" class="nav-link sub-nav-link">Resize Signature</a>
                                        <a href="#resize-sign-50mm-20mm" class="nav-link sub-nav-link">Resize Sign 50mm x 20mm</a>
                                    </div>
                                </details>
                                <details class="nav-subcategory">
                                    <summary><span>Social Media & Web</span><span class="arrow">â–¶</span></summary>
                                    <div class="nav-links flex flex-col space-y-1 mt-2">
                                        <a href="#instagram-grid-maker" class="nav-link sub-nav-link">Instagram Grid Maker</a>
                                        <a href="#resize-instagram-nocrop" class="nav-link sub-nav-link">Resize Instagram No Crop</a>
                                        <a href="#resize-whatsapp-dp" class="nav-link sub-nav-link">Resize WhatsApp DP</a>
                                        <a href="#resize-image-youtube-banner" class="nav-link sub-nav-link">Resize Image YouTube Banner</a>
                                        <a href="#watermark-images" class="nav-link sub-nav-link">Watermark Images</a>
                                    </div>
                                </details>
                                <details class="nav-subcategory">
                                    <summary><span>Advanced & Utilities</span><span class="arrow">â–¶</span></summary>
                                    <div class="nav-links flex flex-col space-y-1 mt-2">
                                        <a href="#image-color-picker" class="nav-link sub-nav-link">Image Color Picker</a>
                                        <a href="#remove-image-background" class="nav-link sub-nav-link">Remove Image Background <span class="under-development">(Under Development)</span></a>
                                        <a href="#gif-tools" class="nav-link sub-nav-link">GIF Tools <span class="under-development">(Under Development)</span></a>
                                        <a href="#video-to-gif" class="nav-link sub-nav-link">Video to GIF</a>
                                    </div>
                                </details>
                            </div>
                        </details>

                        <details class="nav-category">
                            <summary><span>ðŸŽ“ Student Tools</span><span class="arrow">â–¶</span></summary>
                            <div class="nav-links flex flex-col space-y-1 mt-2">
                                <details class="nav-subcategory">
                                    <summary><span>ðŸ“‹ Career Prep</span><span class="arrow">â–¶</span></summary>
                                    <div class="nav-links flex flex-col space-y-1 mt-2">
                                        <a href="#resume-builder" class="nav-link sub-nav-link">Resume Builder</a>
                                        <a href="#cover-letter-generator" class="nav-link sub-nav-link">Cover Letter Generator</a>
                                        <a href="#interview-questions" class="nav-link sub-nav-link">Interview Questions Bank</a>
                                        <a href="#salary-calculator" class="nav-link sub-nav-link">Salary Calculator</a>
                                        <a href="#job-tracker" class="nav-link sub-nav-link">Job Application Tracker</a>
                                        <a href="#skills-gap-analyzer" class="nav-link sub-nav-link">Skills Gap Analyzer</a>
                                    </div>
                                </details>
                                <details class="nav-subcategory">
                                    <summary><span>ðŸ“š Academic Success</span><span class="arrow">â–¶</span></summary>
                                    <div class="nav-links flex flex-col space-y-1 mt-2">
                                        <a href="#gpa-calculator" class="nav-link sub-nav-link">GPA Calculator</a>
                                        <a href="#grade-calculator" class="nav-link sub-nav-link">Grade Needed Calculator</a>
                                        <a href="#study-planner" class="nav-link sub-nav-link">Study Schedule Planner</a>
                                        <a href="#pomodoro-timer" class="nav-link sub-nav-link">Pomodoro Timer</a>
                                        <a href="#assignment-tracker" class="nav-link sub-nav-link">Assignment Tracker</a>
                                        <a href="#citation-generator" class="nav-link sub-nav-link">Citation Generator</a>
                                        <a href="#research-outline" class="nav-link sub-nav-link">Research Paper Outline Creator</a>
                                        <a href="#flashcard-maker" class="nav-link sub-nav-link">Flash Card Maker</a>
                                        <a href="#note-templates" class="nav-link sub-nav-link">Note-taking Templates</a>
                                    </div>
                                </details>
                                <details class="nav-subcategory">
                                    <summary><span>ðŸ’° Money Matters</span><span class="arrow">â–¶</span></summary>
                                    <div class="nav-links flex flex-col space-y-1 mt-2">
                                        <a href="#student-budget" class="nav-link sub-nav-link">Student Budget Calculator</a>
                                        <a href="#student-loan-calculator" class="nav-link sub-nav-link">Student Loan Calculator</a>
                                        <a href="#textbook-cost" class="nav-link sub-nav-link">Textbook Cost Optimizer</a>
                                        <a href="#semester-cost" class="nav-link sub-nav-link">Semester Cost Estimator</a>
                                        <a href="#work-hour-calculator" class="nav-link sub-nav-link">Part-time Work Hour Calculator</a>
                                        <a href="#expense-splitter" class="nav-link sub-nav-link">Expense Splitter</a>
                                    </div>
                                </details>
                                <details class="nav-subcategory">
                                    <summary><span>ðŸ“Š Planning & Organization</span><span class="arrow">â–¶</span></summary>
                                    <div class="nav-links flex flex-col space-y-1 mt-2">
                                        <a href="#class-schedule-builder" class="nav-link sub-nav-link">Class Schedule Builder</a>
                                        <a href="#semester-planner" class="nav-link sub-nav-link">Semester Planner</a>
                                        <a href="#daily-schedule-optimizer" class="nav-link sub-nav-link">Daily Schedule Optimizer</a>
                                        <a href="#campus-walking-calculator" class="nav-link sub-nav-link">Campus Walking Time Calculator</a>
                                        <a href="#study-group-scheduler" class="nav-link sub-nav-link">Study Group Scheduler</a>
                                        <a href="#exam-schedule-organizer" class="nav-link sub-nav-link">Exam Schedule Organizer</a>
                                    </div>
                                </details>
                                <details class="nav-subcategory">
                                    <summary><span>ðŸ§  Productivity & Wellness</span><span class="arrow">â–¶</span></summary>
                                    <div class="nav-links flex flex-col space-y-1 mt-2">
                                        <a href="#habit-tracker" class="nav-link sub-nav-link">Habit Tracker</a>
                                        <a href="#time-tracker" class="nav-link sub-nav-link">Study Time Tracker</a>
                                        <a href="#goal-tracker" class="nav-link sub-nav-link">Goal Progress Tracker</a>
                                        <a href="#focus-timer" class="nav-link sub-nav-link">Focus Session Timer</a>
                                        <a href="#reflection-journal" class="nav-link sub-nav-link">Weekly Reflection Journal</a>
                                        <a href="#procrastination-breaker" class="nav-link sub-nav-link">Procrastination Breaker</a>
                                        <a href="#study-effectiveness-analyzer" class="nav-link sub-nav-link">Study Effectiveness Analyzer</a>
                                        <a href="#time-allocation-chart" class="nav-link sub-nav-link">Time Allocation Pie Chart</a>
                                        <a href="#academic-performance-dashboard" class="nav-link sub-nav-link">Academic Performance Dashboard</a>
                                        <a href="#assignment-priority-matrix" class="nav-link sub-nav-link">Assignment Priority Matrix</a>
                                        <a href="#stress-monitor" class="nav-link sub-nav-link">Stress Level Monitor</a>
                                        <a href="#sleep-calculator" class="nav-link sub-nav-link">Sleep Schedule Calculator</a>
                                    </div>
                                </details>
                                <details class="nav-subcategory">
                                    <summary><span>ðŸŒ Skill Building & Learning</span><span class="arrow">â–¶</span></summary>
                                    <div class="nav-links flex flex-col space-y-1 mt-2">
                                        <a href="#skill-checklist" class="nav-link sub-nav-link">Skill Checklist Builder</a>
                                        <a href="#project-idea-generator" class="nav-link sub-nav-link">Project Idea Generator</a>
                                        <a href="#learning-path-creator" class="nav-link sub-nav-link">Learning Path Creator</a>
                                        <a href="#code-snippet-organizer" class="nav-link sub-nav-link">Code Snippet Organizer</a>
                                        <a href="#technical-interview-prep" class="nav-link sub-nav-link">Technical Interview Prep</a>
                                    </div>
                                </details>
                                <details class="nav-subcategory">
                                    <summary><span>ðŸ“ Writing & Communication</span><span class="arrow">â–¶</span></summary>
                                    <div class="nav-links flex flex-col space-y-1 mt-2">
                                        <a href="#essay-builder" class="nav-link sub-nav-link">Essay Structure Builder</a>
                                        <a href="#email-template-generator" class="nav-link sub-nav-link">Email Template Generator</a>
                                        <a href="#presentation-outline-creator" class="nav-link sub-nav-link">Presentation Outline Creator</a>
                                        <a href="#elevator-pitch-builder" class="nav-link sub-nav-link">Elevator Pitch Builder</a>
                                    </div>
                                </details>
                            </div>
                        </details>
                        
                        <details class="nav-category">
                            <summary><span>General Utilities</span><span class="arrow">â–¶</span></summary>
                             <div class="nav-links flex flex-col space-y-1 mt-2">
                                <a href="#age-calculator" class="nav-link">Age Calculator</a>
                                <a href="#date-calculator" class="nav-link">Date Calculator</a>
                                <a href="#password-generator" class="nav-link">Password Generator</a>
                                <a href="#random-number-generator" class="nav-link">Random Number Gen</a>
                            </div>
                        </details>

                        <!-- Navigation links removed from sidebar -->
                    </nav>
                </aside>

                <!-- Dynamic Tool Content Area -->
                <main id="app-container" class="w-full bg-white p-1 md:p-6 rounded-lg shadow-md border border-gray-200 md:w-3/4 lg:w-4/5 mb-8">
                    <!-- Tool content will be loaded here by JavaScript -->
                </main>

            </div>
        </div>

        <!-- Footer -->
        <footer class="mt-auto border-t border-gray-200">
            <div class="container mx-auto px-4 py-4 text-center text-gray-500 text-sm">
                <div class="flex justify-center gap-6 mb-2">
                    <a href="#all-tools" class="text-gray-600 hover:text-black transition-colors font-semibold">Keymap</a>
                    <a href="#about" class="text-gray-600 hover:text-black transition-colors font-semibold">About</a>
                    <a href="#personal-notes" class="text-gray-600 hover:text-black transition-colors font-semibold">Personal Notes</a>
                    <a href="#feedback" class="text-gray-600 hover:text-black transition-colors font-semibold">Feedback</a>
                    <a href="#contact" class="text-gray-600 hover:text-black transition-colors font-semibold">Contact Us</a>
                </div>
                <p class="handwritten text-sm">Copyright created with â¤ï¸ by my Scribble team</p>
            </div>
        </footer>

        <!-- Trolling Privacy Notice -->
        <div id="privacy-notice" class="fixed bottom-4 right-4 md:bottom-6 md:right-6 z-50">
            <!-- Floating Genie Effect - Hidden on mobile -->
            <div class="absolute -top-16 -left-8 pointer-events-none hidden md:block">
                <div class="relative">
                    <!-- Magical aura -->
                    <div class="absolute inset-0 bg-gradient-to-r from-purple-400 to-pink-400 rounded-full opacity-20 animate-pulse"></div>
                    
                    <!-- Floating genie -->
                    <div class="text-4xl animate-float">ðŸ§žâ€â™‚ï¸</div>
                    
                    <!-- Continuous sparkles -->
                    <div class="sparkle-permanent absolute -top-2 -left-3 text-lg animate-sparkle-continuous">âœ¨</div>
                    <div class="sparkle-permanent absolute -bottom-1 left-6 text-sm animate-sparkle-continuous-delayed">â­</div>
                    <div class="sparkle-permanent absolute top-4 -right-2 text-lg animate-sparkle-continuous-slow">ðŸ’«</div>
                    
                    <!-- Magic dust trail -->
                    <div class="magic-trail absolute top-1 left-8 text-xs opacity-60 animate-float-trail">âœ¨âœ¨âœ¨</div>
                </div>
            </div>

            <!-- Privacy Button -->
            <button id="privacy-btn" class="bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white px-2 py-2 md:px-4 md:py-2 rounded-full shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300 relative group animate-bounce" title="Privacy Notice">
                <!-- Desktop Version -->
                <span class="hidden md:flex items-center gap-2">
                    <span id="lamp-icon" class="text-sm font-medium">ðŸª”</span>
                    <span id="btn-text" class="text-sm font-medium">Privacy Notice</span>
                </span>
                
                <!-- Mobile Version - Compact Round Button -->
                <span class="md:hidden flex items-center justify-center w-8 h-8">
                    <span class="text-lg">ðŸ”’</span>
                </span>
                
                <!-- Mobile Tooltip -->
                <div class="mobile-privacy-tooltip md:hidden">
                    Privacy ðŸ”’
                </div>
                
                <!-- Magical Genie Animation -->
                <div id="genie-smoke" class="absolute -top-8 left-1/2 transform -translate-x-1/2 hidden group-hover:block">
                    <div class="relative">
                        <!-- Smoke clouds -->
                        <div class="smoke-cloud absolute -top-4 -left-2 text-2xl opacity-70 animate-float-up">ðŸ’¨</div>
                        <div class="smoke-cloud absolute -top-6 left-2 text-lg opacity-50 animate-float-up-delayed">ðŸ’¨</div>
                        <div class="smoke-cloud absolute -top-8 -left-1 text-xl opacity-60 animate-float-up-slow">ðŸ’¨</div>
                        
                        <!-- Genie emerging -->
                        <div class="genie-emerge absolute -top-12 left-0 text-3xl animate-genie-appear">ðŸ§žâ€â™‚ï¸</div>
                        
                        <!-- Sparkles -->
                        <div class="sparkle absolute -top-10 -left-4 text-lg animate-sparkle">âœ¨</div>
                        <div class="sparkle absolute -top-14 left-4 text-sm animate-sparkle-delayed">â­</div>
                        <div class="sparkle absolute -top-8 left-6 text-lg animate-sparkle-slow">ðŸ’«</div>
                        <div class="sparkle absolute -top-16 -left-2 text-sm animate-sparkle-fast">ðŸŒŸ</div>
                    </div>
                </div>
                
                <!-- Hover tooltip with genie message -->
                <div class="absolute bottom-full right-0 mb-2 hidden group-hover:block z-10">
                    <div class="bg-gradient-to-r from-purple-800 to-blue-800 text-white text-xs px-3 py-2 rounded-lg whitespace-nowrap animate-magic-appear shadow-xl">
                        <span class="mr-1">ðŸ§žâ€â™‚ï¸</span>Your privacy wishes are granted!<span class="ml-1">âœ¨</span>
                    </div>
                    <div class="w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-purple-800 absolute top-full right-4"></div>
                </div>
            </button>

            <!-- Privacy Modal -->
            <div id="privacy-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-60 flex items-center justify-center p-2 md:p-4">
                <div class="bg-white rounded-2xl shadow-2xl max-w-sm md:max-w-md w-full p-4 md:p-6 relative animate-bounce mx-2">
                    <!-- Close button -->
                    <button id="close-privacy" title="Close Privacy Notice" class="absolute top-2 right-2 md:top-4 md:right-4 text-gray-400 hover:text-gray-600 transition-colors p-1">
                        <svg class="w-5 h-5 md:w-6 md:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>

                    <!-- Magical Genie Header -->
                    <div class="text-center mb-3 md:mb-4">
                        <div class="text-4xl md:text-6xl mb-2">ðŸ§žâ€â™‚ï¸</div>
                        <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-2">Privacy Notice</h3>
                        <p class="text-xs md:text-sm text-gray-600">Your privacy wishes are granted! âœ¨</p>
                    </div>

                    <!-- Trolling Content -->
                    <div class="space-y-2 md:space-y-3 text-center">
                        <div class="bg-green-100 border border-green-300 rounded-lg p-2 md:p-3">
                            <div class="flex items-center justify-center gap-2 mb-1 md:mb-2">
                                <span class="text-green-600 text-base md:text-lg">ðŸš«ðŸª</span>
                                <span class="font-semibold text-green-800 text-sm md:text-base">No Cookies Captured!</span>
                            </div>
                            <p class="text-xs md:text-sm text-green-700">We don&#39;t track you, stalk you, or sell your data!</p>
                        </div>

                        <div class="bg-blue-100 border border-blue-300 rounded-lg p-2 md:p-3">
                            <div class="flex items-center justify-center gap-2 mb-1 md:mb-2">
                                <span class="text-blue-600 text-base md:text-lg">ðŸ‘»</span>
                                <span class="font-semibold text-blue-800 text-sm md:text-base">No Trace Mode</span>
                            </div>
                            <p class="text-xs md:text-sm text-blue-700">What you do here, stays here. We're like Vegas, but for tools!</p>
                        </div>

                        <div class="bg-purple-100 border border-purple-300 rounded-lg p-2 md:p-3">
                            <div class="flex items-center justify-center gap-2 mb-1 md:mb-2">
                                <span class="text-purple-600 text-base md:text-lg">ðŸ”’</span>
                                <span class="font-semibold text-purple-800 text-sm md:text-base">Ultra Private</span>
                            </div>
                            <p class="text-xs md:text-sm text-purple-700">So private, even we don&#39;t know you&#39;re here! ðŸ¤«</p>
                        </div>

                        <div class="bg-yellow-100 border border-yellow-300 rounded-lg p-2 md:p-3">
                            <div class="flex items-center justify-center gap-2 mb-1 md:mb-2">
                                <span class="text-yellow-600 text-base md:text-lg">ðŸ˜Ž</span>
                                <span class="font-semibold text-yellow-800 text-sm md:text-base">Just Pure Tools</span>
                            </div>
                            <p class="text-xs md:text-sm text-yellow-700">No ads, no tracking, no nonsense. Just awesome tools!</p>
                        </div>
                    </div>

                    <div class="mt-4 md:mt-6 text-center">
                        <button id="got-it-btn" class="bg-gradient-to-r from-green-400 to-blue-500 hover:from-green-500 hover:to-blue-600 text-white px-4 md:px-6 py-2 rounded-full font-medium transition-all duration-300 transform hover:scale-105 shadow-lg text-sm md:text-base">
                            Got it! ðŸ‘
                        </button>
                    </div>

                    <div class="mt-3 md:mt-4 text-center text-xs text-gray-500">
                        <p>Seriously though, your privacy matters to us! ðŸ’œ</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Popup Styles -->
    <style>
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.1);
                opacity: 0.8;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* Privacy Notice Animations */
        @keyframes spin-slow {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .animate-spin-slow {
            animation: spin-slow 3s linear infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .animate-float {
            animation: float 3s ease-in-out infinite;
        }

        /* Magical Genie Animations */
        @keyframes float-up {
            0% { transform: translateY(0px) scale(0.5); opacity: 0; }
            50% { transform: translateY(-10px) scale(1); opacity: 1; }
            100% { transform: translateY(-20px) scale(1.2); opacity: 0; }
        }

        @keyframes float-up-delayed {
            0% { transform: translateY(0px) scale(0.3); opacity: 0; }
            30% { transform: translateY(0px) scale(0.3); opacity: 0; }
            80% { transform: translateY(-15px) scale(0.8); opacity: 1; }
            100% { transform: translateY(-25px) scale(1); opacity: 0; }
        }

        @keyframes float-up-slow {
            0% { transform: translateY(0px) scale(0.4); opacity: 0; }
            60% { transform: translateY(-8px) scale(0.9); opacity: 1; }
            100% { transform: translateY(-18px) scale(1.1); opacity: 0; }
        }

        @keyframes genie-appear {
            0% { transform: translateY(20px) scale(0); opacity: 0; }
            25% { transform: translateY(10px) scale(0.5); opacity: 0.5; }
            50% { transform: translateY(-5px) scale(1.2); opacity: 1; }
            75% { transform: translateY(-10px) scale(1); opacity: 1; }
            100% { transform: translateY(-15px) scale(1.1); opacity: 1; }
        }

        @keyframes sparkle {
            0% { transform: scale(0) rotate(0deg); opacity: 0; }
            50% { transform: scale(1) rotate(180deg); opacity: 1; }
            100% { transform: scale(0) rotate(360deg); opacity: 0; }
        }

        @keyframes sparkle-delayed {
            0% { transform: scale(0) rotate(0deg); opacity: 0; }
            25% { transform: scale(0) rotate(0deg); opacity: 0; }
            75% { transform: scale(1.2) rotate(270deg); opacity: 1; }
            100% { transform: scale(0) rotate(360deg); opacity: 0; }
        }

        @keyframes sparkle-slow {
            0% { transform: scale(0) rotate(0deg); opacity: 0; }
            40% { transform: scale(0.8) rotate(120deg); opacity: 0.8; }
            100% { transform: scale(0) rotate(360deg); opacity: 0; }
        }

        @keyframes sparkle-fast {
            0% { transform: scale(0) rotate(0deg); opacity: 0; }
            30% { transform: scale(1.5) rotate(150deg); opacity: 1; }
            100% { transform: scale(0) rotate(360deg); opacity: 0; }
        }

        @keyframes magic-appear {
            0% { transform: scale(0.5) translateY(10px); opacity: 0; }
            100% { transform: scale(1) translateY(0px); opacity: 1; }
        }

        @keyframes lamp-rub {
            0% { transform: rotate(0deg) scale(1); }
            25% { transform: rotate(-5deg) scale(1.1); }
            50% { transform: rotate(5deg) scale(1.2); }
            75% { transform: rotate(-3deg) scale(1.1); }
            100% { transform: rotate(0deg) scale(1); }
        }

        /* Continuous Genie Effects */
        @keyframes sparkle-continuous {
            0% { transform: scale(0.8) rotate(0deg); opacity: 0.6; }
            25% { transform: scale(1.2) rotate(90deg); opacity: 1; }
            50% { transform: scale(0.9) rotate(180deg); opacity: 0.8; }
            75% { transform: scale(1.1) rotate(270deg); opacity: 1; }
            100% { transform: scale(0.8) rotate(360deg); opacity: 0.6; }
        }

        @keyframes sparkle-continuous-delayed {
            0% { transform: scale(0.5) rotate(0deg); opacity: 0.4; }
            20% { transform: scale(0.5) rotate(20deg); opacity: 0.4; }
            60% { transform: scale(1.3) rotate(200deg); opacity: 1; }
            100% { transform: scale(0.5) rotate(360deg); opacity: 0.4; }
        }

        @keyframes sparkle-continuous-slow {
            0% { transform: scale(0.7) rotate(0deg); opacity: 0.5; }
            30% { transform: scale(1.0) rotate(60deg); opacity: 0.8; }
            70% { transform: scale(1.2) rotate(240deg); opacity: 1; }
            100% { transform: scale(0.7) rotate(360deg); opacity: 0.5; }
        }

        @keyframes float-trail {
            0% { transform: translateX(0px) translateY(0px); opacity: 0.3; }
            25% { transform: translateX(5px) translateY(-2px); opacity: 0.6; }
            50% { transform: translateX(10px) translateY(-4px); opacity: 0.8; }
            75% { transform: translateX(15px) translateY(-2px); opacity: 0.4; }
            100% { transform: translateX(20px) translateY(0px); opacity: 0.1; }
        }

        .animate-sparkle-continuous { animation: sparkle-continuous 3s ease-in-out infinite; }
        .animate-sparkle-continuous-delayed { animation: sparkle-continuous-delayed 4s ease-in-out infinite; }
        .animate-sparkle-continuous-slow { animation: sparkle-continuous-slow 5s ease-in-out infinite; }
        .animate-float-trail { animation: float-trail 2s ease-in-out infinite; }

        .animate-float-up { animation: float-up 2s ease-out infinite; }
        .animate-float-up-delayed { animation: float-up-delayed 2.5s ease-out infinite; }
        .animate-float-up-slow { animation: float-up-slow 3s ease-out infinite; }
        .animate-genie-appear { animation: genie-appear 1.5s ease-out infinite; }
        .animate-sparkle { animation: sparkle 1.8s ease-in-out infinite; }
        .animate-sparkle-delayed { animation: sparkle-delayed 2.2s ease-in-out infinite; }
        .animate-sparkle-slow { animation: sparkle-slow 2.8s ease-in-out infinite; }
        .animate-sparkle-fast { animation: sparkle-fast 1.2s ease-in-out infinite; }
        .animate-magic-appear { animation: magic-appear 0.5s ease-out forwards; }

        /* Privacy button hover effects */
        #privacy-btn:hover {
            animation: none;
        }

        #privacy-btn:hover #lamp-icon {
            animation: lamp-rub 0.8s ease-in-out infinite;
        }

        #privacy-btn.jeene-mode {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #f9ca24, #f0932b, #eb4d4b, #6c5ce7, #a29bfe, #fd79a8);
            background-size: 400% 400%;
            animation: rainbow 2s ease infinite;
            box-shadow: 0 0 20px rgba(255, 107, 107, 0.5), 0 0 40px rgba(78, 205, 196, 0.3);
        }

        @keyframes rainbow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Modal entrance animation */
        .modal-enter {
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            0% {
                opacity: 0;
                transform: scale(0.8) translateY(20px);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0px);
            }
        }
    </style>

    <!-- Error Monitoring and Analytics -->
    <script>
        // Error monitoring and reporting
        window.addEventListener('error', function(e) {
            console.error('Global Error:', e.error);
            
            // Send error to analytics if available
            if (typeof gtag !== 'undefined') {
                gtag('event', 'exception', {
                    'description': e.error ? e.error.toString() : 'Unknown error',
                    'fatal': false,
                    'page_url': window.location.href,
                    'page_title': document.title
                });
            }
            
            // Optional: Send to your own error logging service
            try {
                fetch('/api/log-error', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        error: e.error ? e.error.toString() : 'Unknown error',
                        stack: e.error ? e.error.stack : '',
                        url: window.location.href,
                        timestamp: new Date().toISOString(),
                        userAgent: navigator.userAgent
                    })
                }).catch(() => {}); // Silently fail if endpoint doesn't exist
            } catch (err) {
                console.warn('Error reporting failed:', err);
            }
        });

        // Unhandled promise rejection monitoring
        window.addEventListener('unhandledrejection', function(e) {
            console.error('Unhandled Promise Rejection:', e.reason);
            
            if (typeof gtag !== 'undefined') {
                gtag('event', 'exception', {
                    'description': 'Unhandled Promise: ' + (e.reason ? e.reason.toString() : 'Unknown'),
                    'fatal': false,
                    'page_url': window.location.href
                });
            }
        });

        // Performance monitoring
        window.addEventListener('load', function() {
            if ('performance' in window) {
                const perfData = performance.getEntriesByType('navigation')[0];
                if (perfData && typeof gtag !== 'undefined') {
                    gtag('event', 'timing_complete', {
                        'name': 'page_load',
                        'value': Math.round(perfData.loadEventEnd - perfData.fetchStart)
                    });
                }
            }
        });

        // Track calculator usage
        function trackCalculatorUsage(calculatorName, action = 'calculate') {
            if (typeof gtag !== 'undefined') {
                gtag('event', action, {
                    'event_category': 'Calculator',
                    'event_label': calculatorName,
                    'page_url': window.location.href
                });
            }
        }

        // Track tool navigation
        function trackToolNavigation(toolName) {
            if (typeof gtag !== 'undefined') {
                gtag('event', 'tool_navigation', {
                    'event_category': 'Navigation',
                    'event_label': toolName,
                    'page_url': window.location.href
                });
            }
        }

        // Database Click Tracking System
        async function trackToolClick(toolName, toolPath, toolCategory) {
            try {
                // Environment detection for local vs production
                const isLocal = window.location.hostname === 'localhost' || 
                                window.location.hostname === '127.0.0.1' ||
                                window.location.hostname === '192.168.1.1' ||
                                window.location.hostname.startsWith('192.168.') ||
                                window.location.hostname.startsWith('10.0.') ||
                                window.location.hostname.startsWith('172.');
                
                const API_URL = isLocal 
                    ? '/allinone-tools/api/track-click-local.php'
                    : '/api/track-click.php';
                
                console.log(`ðŸŒ Environment: ${isLocal ? 'Local Development' : 'Production'}`);
                console.log(`ðŸ“¡ API URL: ${API_URL}`);
                
                const trackingData = {
                    tool_name: toolName,
                    tool_path: toolPath,
                    tool_category: toolCategory,
                    timestamp: new Date().toISOString(),
                    user_agent: navigator.userAgent,
                    referrer: document.referrer || window.location.origin
                };

                // Send to database
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(trackingData)
                });

                if (response.ok) {
                    const result = await response.json();
                    if (result.success) {
                        console.log(`âœ… Click tracked: ${toolName} (${result.click_count} total clicks)`);
                        
                        // Store click count in localStorage for potential display
                        localStorage.setItem(`clicks_${toolName}`, result.click_count);
                        
                        // Trigger custom event for any listeners
                        window.dispatchEvent(new CustomEvent('toolClickTracked', {
                            detail: {
                                toolName,
                                toolPath,
                                toolCategory,
                                clickCount: result.click_count
                            }
                        }));
                    }
                } else {
                    console.warn('Click tracking response not OK:', response.status);
                }
            } catch (error) {
                console.warn('Click tracking failed:', error);
                // Fallback to localStorage tracking if server is unavailable
                const localKey = `local_clicks_${toolName}`;
                const localClicks = parseInt(localStorage.getItem(localKey) || '0') + 1;
                localStorage.setItem(localKey, localClicks.toString());
            }
        }

        // Helper function to extract tool info from path/hash
        function getToolInfo(path) {
            const toolName = path.replace('#', '').replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
            
            // Determine category based on path
            let category = 'Other';
            if (path.includes('text/')) category = 'Text Tools';
            else if (path.includes('math/')) category = 'Math Tools';
            else if (path.includes('financial/')) category = 'Financial Tools';
            else if (path.includes('health/')) category = 'Health Tools';
            else if (path.includes('image/')) category = 'Image Tools';
            else if (path.includes('student/')) category = 'Student Tools';
            
            return { toolName, category };
        }
    </script>

    <!-- Global JavaScript -->
    <script>
        const appContainer = document.getElementById('app-container');
        const toolNav = document.getElementById('tool-nav');
        const searchInput = document.getElementById('tool-search');

        // --- The Key Map of All Tools ---
        const routes = {
            // Text Tools
            '#change-case': 'client/tools/text/change-case.html', '#find-replace': 'client/tools/text/find-replace.html', '#reverse-text': 'client/tools/text/reverse-text.html', '#split-text': 'client/tools/text/split-text.html', '#join-text': 'client/tools/text/join-text.html', '#repeat-text': 'client/tools/text/repeat-text.html', '#sort-lines': 'client/tools/text/sort-lines.html', '#shuffle-lines': 'client/tools/text/shuffle-lines.html', '#remove-punctuation': 'client/tools/text/remove-punctuation.html', '#text-indenter': 'client/tools/text/text-indenter.html', '#text-dedenter': 'client/tools/text/text-dedenter.html', '#text-justifier': 'client/tools/text/text-justifier.html', '#rot13': 'client/tools/text/rot13.html', '#text-scrambler': 'client/tools/text/text-scrambler.html', '#keyword-density': 'client/tools/text/keyword-density.html', '#unique-word-finder': 'client/tools/text/unique-word-finder.html', '#readability-score': 'client/tools/text/readability-score.html', '#trim-whitespace': 'client/tools/text/trim-whitespace.html', '#align-text': 'client/tools/text/align-text.html', '#word-wrap': 'client/tools/text/word-wrap.html', '#add-line-numbers': 'client/tools/text/add-line-numbers.html', '#word-counter': 'client/tools/text/word-counter.html', '#text-statistics': 'client/tools/text/text-statistics.html', '#find-top-words': 'client/tools/text/find-top-words.html', '#change-font': 'client/tools/text/change-font.html', '#zalgo-text': 'client/tools/text/zalgo-text.html', '#image-from-text': 'client/tools/text/image-from-text.html', '#url-encode': 'client/tools/text/url-encode.html', '#base64-encode': 'client/tools/text/base64-encode.html', '#remove-duplicate-lines': 'client/tools/text/remove-duplicate-lines.html', '#morse-code': 'client/tools/text/morse-code-converter.html',
            '#json-formatter-minifier': 'client/tools/text/json-formatter-minifier.html', '#xml-formatter-minifier': 'client/tools/text/xml-formatter-minifier.html', '#csv-json-converter': 'client/tools/text/csv-json-converter.html', '#html-encode-decode': 'client/tools/text/html-encode-decode.html', '#lorem-ipsum-generator': 'client/tools/text/lorem-ipsum-generator.html', '#text-to-ascii-art': 'client/tools/text/text-to-ascii-art.html', '#text-diff-checker': 'client/tools/text/text-diff-checker.html', '#unicode-converter': 'client/tools/text/unicode-converter.html', '#binary-hex-octal-converter': 'client/tools/text/binary-hex-octal-converter.html', '#upside-down-text': 'client/tools/text/upside-down-text.html', '#mirror-text': 'client/tools/text/mirror-text.html', '#bubble-text': 'client/tools/text/bubble-text.html', '#fancy-unicode-text-generator': 'client/tools/text/fancy-unicode-text-generator.html', '#emoji-replacer-inserter': 'client/tools/text/emoji-replacer-inserter.html', '#text-to-qr-code': 'client/tools/text/text-to-qr-code.html',

            // Image Tools
            '#resize-image-3x5cm-4x5cm': 'client/tools/image/resize-image-3x5cm-4x5cm.html',
            '#resize-image-4x6': 'client/tools/image/resize-image-4x6inch.html',
            '#resize-image-600x600': 'client/tools/image/resize-image-600x600.html',
            '#resize-image-6cm-2cm-300dpi': 'client/tools/image/resize-image-6cm-2cm-300dpi.html',
            '#resize-image-a4': 'client/tools/image/resize-image-a4.html',
            '#resize-image-cm': 'client/tools/image/resize-image-cm.html',
            '#resize-image-inches': 'client/tools/image/resize-image-inches.html',
            '#resize-image-mm': 'client/tools/image/resize-image-mm.html',
            '#resize-image-pan-card': 'client/tools/image/resize-image-pan-card.html',
            '#resize-image-pixel': 'client/tools/image/resize-image-pixel.html',
            '#resize-image-ssc': 'client/tools/image/resize-image-ssc.html',
            '#resize-image-upsc': 'client/tools/image/resize-image-upsc.html',
            '#resize-image-youtube-banner': 'client/tools/image/resize-image-youtube-banner.html',
            '#resize-instagram-nocrop': 'client/tools/image/resize-instagram-nocrop.html',
            '#resize-sign-50mm-20mm': 'client/tools/image/resize-sign-50mm-20mm.html',

            // Math Calculators
            '#basic-calculator': 'client/tools/math/basic-calculator.html',
            '#square-root-calculator': 'client/tools/math/square-root-calculator.html',
            '#exponent-calculator': 'client/tools/math/exponent-calculator.html',
            '#average-calculator': 'client/tools/math/average-calculator.html',
            '#fraction-calculator': 'client/tools/math/fraction-calculator.html',
            '#percentage-calculator': 'client/tools/math/percentage-calculator.html',
            '#discount-calculator': 'client/tools/math/discount-calculator.html',
            '#tip-calculator': 'client/tools/math/tip-calculator.html',
            '#simple-interest-calculator': 'client/tools/math/simple-interest-calculator.html',
            '#unit-price-calculator': 'client/tools/math/unit-price-calculator.html',
            '#scientific-notation-converter': 'client/tools/math/scientific-notation-converter.html',
            '#quadratic-formula': 'client/tools/math/quadratic-formula.html',
            '#area-calculator': 'client/tools/math/area-calculator.html',
            '#perimeter-calculator': 'client/tools/math/perimeter-calculator.html',
            '#volume-calculator': 'client/tools/math/volume-calculator.html',
            '#lateral-surface-area-calculator': 'client/tools/math/lateral-surface-area-calculator.html',
            '#total-surface-area-calculator': 'client/tools/math/total-surface-area-calculator.html',
            '#circle-calculator': 'client/tools/math/shapes/circle-calculator.html',
            '#triangle-calculator': 'client/tools/math/shapes/triangle-calculator.html',
            '#sphere-calculator': 'client/tools/math/shapes/sphere-calculator.html',
            '#cylinder-calculator': 'client/tools/math/shapes/cylinder-calculator.html',
            '#polygon-calculator': 'client/tools/math/shapes/polygon-calculator.html',
            '#rectangle-calculator': 'client/tools/math/shapes/rectangle-calculator.html',
            '#cuboid-calculator': 'client/tools/math/shapes/cuboid-calculator.html',
            '#standard-deviation-calculator': 'client/tools/math/standard-deviation-calculator.html',
            '#number-sequence-calculator': 'client/tools/math/number-sequence-calculator.html',
            '#sample-size-calculator': 'client/tools/math/sample-size-calculator.html',
            '#probability-calculator': 'client/tools/math/probability-calculator.html',
            '#statistics-calculator': 'client/tools/math/statistics-calculator.html',
            '#mean-median-mode-range-calculator': 'client/tools/math/mean-median-mode-range-calculator.html',
            '#permutation-and-combination-calculator': 'client/tools/math/permutation-and-combination-calculator.html',
            '#z-score-calculator': 'client/tools/math/z-score-calculator.html',
            '#confidence-interval-calculator': 'client/tools/math/confidence-interval-calculator.html',
            '#random-number-generator': 'client/tools/math/random-number-generator.html',

            // Financial Calculators
            '#401k-calculator': 'client/tools/financial/401k-calculator.html',
            '#amortization-calculator': 'client/tools/financial/amortization-calculator.html',
            '#annuity-calculator': 'client/tools/financial/annuity-calculator.html',
            '#auto-loan-calculator': 'client/tools/financial/auto-loan-calculator.html',
            '#compound-interest-calculator': 'client/tools/financial/compound-interest-calculator.html',
            '#currency-calculator': 'client/tools/financial/currency-calculator.html',
            '#estate-tax-calculator': 'client/tools/financial/estate-tax-calculator.html',
            '#finance-calculator': 'client/tools/financial/finance-calculator.html',
            '#house-affordability-calculator': 'client/tools/financial/house-affordability-calculator.html',
            '#income-tax-calculator': 'client/tools/financial/income-tax-calculator.html',
            '#inflation-calculator': 'client/tools/financial/inflation-calculator.html',
            '#interest-calculator': 'client/tools/financial/interest-calculator.html',
            '#interest-rate-calculator': 'client/tools/financial/interest-rate-calculator.html',
            '#investment-calculator': 'client/tools/financial/investment-calculator.html',
            '#loan-calculator': 'client/tools/financial/loan-calculator.html',
            '#marriage-tax-calculator': 'client/tools/financial/marriage-tax-calculator.html',
            '#mortgage-calculator': 'client/tools/financial/mortgage-calculator.html',
            '#mortgage-payoff-calculator': 'client/tools/financial/mortgage-payoff-calculator.html',
            '#payment-calculator': 'client/tools/financial/payment-calculator.html',
            '#pension-calculator': 'client/tools/financial/pension-calculator.html',
            '#rent-calculator': 'client/tools/financial/rent-calculator.html',
            '#retirement-calculator': 'client/tools/financial/retirement-calculator.html',
            '#salary-calculator': 'client/tools/financial/salary-calculator.html',
            '#sales-tax-calculator': 'client/tools/financial/sales-tax-calculator.html',
            '#savings-calculator': 'client/tools/financial/savings-calculator.html',
            '#social-security-calculator': 'client/tools/financial/social-security-calculator.html',
            '#canadian-mortgage-calculator': 'client/tools/financial/Canadian-Mortgage-Calculator.html',
            '#percent-off-calculator': 'client/tools/financial/Percent-Off-Calculator.html',
            '#mortgage-amortization-calculator': 'client/tools/financial/Mortgage-Amortization-Calculator.html',
            '#mortgage-calculator-uk': 'client/tools/financial/Mortgage-Calculator-UK.html',

            // Health & Fitness
            '#all-tools': 'all-tools.html',
            '#bmi-calculator': 'client/tools/health/bmi-calculator.html',
            '#calorie-calculator': 'client/tools/health/calorie-calculator.html',
            '#body-fat-calculator': 'client/tools/health/body-fat-calculator.html',
            '#bmr-calculator': 'client/tools/health/bmr-calculator.html',
            '#body-surface-area': 'client/tools/health/body-surface-area.html',
            '#lean-body-mass': 'client/tools/health/lean-body-mass.html',
            '#ideal-weight': 'client/tools/health/ideal-weight.html',
            '#healthy-weight': 'client/tools/health/healthy-weight.html',
            '#body-type': 'client/tools/health/body-type.html',
            '#body-water-percentage': 'client/tools/health/body-water-percentage.html',
            '#waist-hip-ratio': 'client/tools/health/waist-hip-ratio.html',
            '#waist-height-ratio': 'client/tools/health/waist-height-ratio.html',
            '#daily-calorie': 'client/tools/health/daily-calorie.html',
            '#macro-calculator': 'client/tools/health/macro-calculator.html',
            '#protein-calculator': 'client/tools/health/protein-calculator.html',
            '#fat-intake': 'client/tools/health/fat-intake.html',
            '#carbohydrate-calculator': 'client/tools/health/carbohydrate-calculator.html',
            '#tdee-calculator': 'client/tools/health/tdee-calculator.html',
            '#calories-burned': 'client/tools/health/calories-burned.html',
            '#weight-watcher-points': 'client/tools/health/weight-watcher-points.html',
            '#one-rep-max': 'client/tools/health/one-rep-max.html',
            '#target-heart-rate': 'client/tools/health/target-heart-rate.html',
            '#max-heart-rate': 'client/tools/health/max-heart-rate.html',
            '#pace-calculator': 'client/tools/health/pace-calculator.html',
            '#split-time': 'client/tools/health/split-time.html',
            '#vo2-max': 'client/tools/health/vo2-max.html',
            '#mets-calculator': 'client/tools/health/mets-calculator.html',
            '#activity-calories': 'client/tools/health/activity-calories.html',
            '#pregnancy-calculator': 'client/tools/health/pregnancy-calculator.html',
            '#pregnancy-weight-gain': 'client/tools/health/pregnancy-weight-gain.html',
            '#pregnancy-conception': 'client/tools/health/pregnancy-conception.html',
            '#due-date': 'client/tools/health/due-date.html',
            '#ovulation-calculator': 'client/tools/health/ovulation-calculator.html',
            '#period-calculator': 'client/tools/health/period-calculator.html',
            '#gfr-calculator': 'client/tools/health/gfr-calculator.html',
            '#bac-calculator': 'client/tools/health/bac-calculator.html',
            '#medical-bsa': 'client/tools/health/medical-bsa.html',
            '#anorexic-bmi': 'client/tools/health/anorexic-bmi.html',
            '#overweight-checker': 'client/tools/health/overweight-checker.html',
            '#army-body-fat': 'client/tools/health/army-body-fat.html',
            '#bmi-for-age': 'client/tools/health/bmi-for-age.html',
            '#basal-insulin': 'client/tools/health/basal-insulin.html',
            '#insulin-carb-ratio': 'client/tools/health/insulin-carb-ratio.html',
            '#sleep-calculator': 'client/tools/health/sleep-calculator.html',
            '#water-intake': 'client/tools/health/water-intake.html',
            '#ideal-weight-calculator': 'client/tools/health/ideal-weight-calculator.html', '#pace-calculator': 'client/tools/health/pace-calculator.html',

            // Image & Media
            '#add-name-dob-photo': 'client/tools/image/add-name-dob-photo.html',
            '#black-white-image': 'client/tools/image/black-white-image.html',
            '#bulk-image-resizer': 'client/tools/image/bulk-image-resizer.html',
            '#check-image-dpi': 'client/tools/image/check-image-dpi.html',
            '#circle-crop': 'client/tools/image/circle-crop.html',
            '#flip-image': 'client/tools/image/flip-image.html',
            '#freehand-crop': 'client/tools/image/freehand-crop.html',
            '#grayscale-image': 'client/tools/image/grayscale-image.html',
            '#image-color-picker': 'client/tools/image/image-color-picker.html',
            '#remove-image-background': 'client/tools/image/remove-image-background.html',
            '#picture-to-pixel-art': 'client/tools/image/picture-to-pixel-art.html',
            '#instagram-grid-maker': 'client/tools/image/instagram-grid-maker.html',
            '#split-image': 'client/tools/image/split-image.html',
            '#join-images-one': 'client/tools/image/join-images-one.html',
            '#pixelate-image': 'client/tools/image/pixelate-image.html',
            '#image-converter': 'client/tools/image/image-converter.html', '#image-compressor': 'client/tools/image/image-compressor.html', '#gif-tools': 'client/tools/image/gif-tools.html', '#video-to-gif': 'client/tools/image/video-to-gif.html', '#passport-photo-maker': 'client/tools/image/passport-photo-maker.html', '#reduce-image-size-kb': 'client/tools/image/reduce-image-size-kb.html', '#resize-image-pixel': 'client/tools/image/resize-image-pixel.html', '#resize-image-ssc': 'client/tools/image/resize-image-ssc.html', '#resize-image-upsc': 'client/tools/image/resize-image-upsc.html', '#generate-signature': 'client/tools/image/generate-signature.html', '#increase-image-size-kb': 'client/tools/image/increase-image-size-kb.html', '#watermark-images': 'client/tools/image/watermark-images.html', '#rotate-image': 'client/tools/image/rotate-image.html', '#super-resolution': 'client/tools/image/super-resolution.html', '#resize-image-2x2inch': 'client/tools/image/resize-image-2x2inch.html', '#resize-image-3x4': 'client/tools/image/resize-image-3x4.html', '#resize-image-35mm-45mm': 'client/tools/image/resize-image-35mm-45mm.html', '#resize-image-youtube-banner': 'client/tools/image/resize-image-youtube-banner.html', '#resize-instagram-nocrop': 'client/tools/image/resize-instagram-nocrop.html', '#resize-sign-50mm-20mm': 'client/tools/image/resize-sign-50mm-20mm.html', '#resize-signature': 'client/tools/image/resize-signature.html', '#resize-whatsapp-dp': 'client/tools/image/resize-whatsapp-dp.html',

            // General Utilities
            '#personal-notes': 'client/tools/other/personal-notes.html', '#age-calculator': 'client/tools/other/age-calculator.html', '#date-calculator': 'client/tools/other/date-calculator.html', '#password-generator': 'client/tools/other/password-generator.html', '#dice-roller': 'client/tools/other/dice-roller.html',
            
            // Student Tools
            // Student Tools - Career & Placement
            '#resume-builder': 'client/tools/student/career/resume-builder.html', 
            '#cover-letter-generator': 'client/tools/student/career/cover-letter-generator.html', 
            '#interview-questions': 'client/tools/student/career/interview-questions.html', 
            '#salary-calculator': 'client/tools/student/career/salary-calculator.html', 
            '#job-tracker': 'client/tools/student/career/job-tracker.html', 
            '#skills-gap-analyzer': 'client/tools/student/career/skills-gap-analyzer.html',
            
            // Student Tools - Academic & Study
            '#gpa-calculator': 'client/tools/student/academic/gpa-calculator.html', 
            '#grade-calculator': 'client/tools/student/academic/grade-calculator.html', 
            '#study-planner': 'client/tools/student/academic/study-planner.html', 
            '#pomodoro-timer': 'client/tools/student/academic/pomodoro-timer.html', 
            '#assignment-tracker': 'client/tools/student/academic/assignment-tracker.html', 
            '#citation-generator': 'client/tools/student/academic/citation-generator.html', 
            '#research-outline': 'client/tools/student/academic/research-outline.html', 
            '#flashcard-maker': 'client/tools/student/academic/flashcard-maker.html', 
            '#note-templates': 'client/tools/student/academic/note-templates.html',
            
            // Student Tools - Financial & Budget
            '#student-budget': 'client/tools/student/finance/student-budget.html', 
            '#student-loan-calculator': 'client/tools/student/finance/student-loan-calculator.html', 
            '#textbook-cost': 'client/tools/student/finance/textbook-cost.html', 
            '#semester-cost': 'client/tools/student/finance/semester-cost.html', 
            '#work-hour-calculator': 'client/tools/student/finance/work-hour-calculator.html', 
            '#expense-splitter': 'client/tools/student/finance/expense-splitter.html',
            
            // Student Tools - Planning & Organization
            '#class-schedule-builder': 'client/tools/student/planning/class-schedule-builder.html', 
            '#semester-planner': 'client/tools/student/planning/semester-planner.html',
            '#daily-schedule-optimizer': 'client/tools/student/planning/daily-schedule-optimizer.html',
            '#campus-walking-calculator': 'client/tools/student/planning/campus-walking-calculator.html',
            '#study-group-scheduler': 'client/tools/student/planning/study-group-scheduler.html',
            '#exam-schedule-organizer': 'client/tools/student/planning/exam-schedule-organizer.html',
            
            // Student Tools - Productivity & Wellness
            '#habit-tracker': 'client/tools/student/productivity/habit-tracker.html', 
            '#time-tracker': 'client/tools/student/productivity/time-tracker.html', 
            '#goal-tracker': 'client/tools/student/productivity/goal-tracker.html', 
            '#focus-timer': 'client/tools/student/productivity/focus-timer.html', 
            '#reflection-journal': 'client/tools/student/productivity/reflection-journal.html', 
            '#procrastination-breaker': 'client/tools/student/productivity/procrastination-breaker.html',
            '#study-effectiveness-analyzer': 'client/tools/student/productivity/study-effectiveness-analyzer.html',
            '#time-allocation-chart': 'client/tools/student/productivity/time-allocation-chart.html',
            '#academic-performance-dashboard': 'client/tools/student/productivity/academic-performance-dashboard.html',
            '#assignment-priority-matrix': 'client/tools/student/productivity/assignment-priority-matrix.html',
            '#stress-monitor': 'client/tools/student/wellness/stress-monitor.html', 
            '#sleep-calculator': 'client/tools/student/wellness/sleep-calculator.html',
            
            // Student Tools - Skill Building & Learning
            '#skill-checklist': 'client/tools/student/skills/skill-checklist.html',
            '#project-idea-generator': 'client/tools/student/skills/project-idea-generator.html',
            '#learning-path-creator': 'client/tools/student/skills/learning-path-creator.html',
            '#code-snippet-organizer': 'client/tools/student/skills/code-snippet-organizer.html',
            '#technical-interview-prep': 'client/tools/student/skills/technical-interview-prep.html',
            
            // Student Tools - Writing & Communication
            '#essay-builder': 'client/tools/student/writing/essay-builder.html',
            '#email-template-generator': 'client/tools/student/writing/email-template-generator.html',
            '#presentation-outline-creator': 'client/tools/student/writing/presentation-outline-creator.html',
            '#elevator-pitch-builder': 'client/tools/student/writing/elevator-pitch-builder.html',
            
            // Special Pages
            '#blogs': 'blog-listing',
            '#blog-welcome': 'blog-welcome',
            '#blog-text-tools': 'blog-text-tools',
            '#blog-financial-planning': 'blog-financial-planning',
            '#blog-tech-stack': 'blog-tech-stack',
            '#blog-fitness-tracking': 'blog-fitness-tracking',
            '#blog-image-tools': 'blog-image-tools',
            '#blog-community': 'blog-community',
        };

        const homeContent = `
            <div class="p-8 space-y-12 max-w-7xl mx-auto">
                <!-- Hero Section -->
                <div class="text-center p-10">
                    <h1 class="handwritten text-6xl font-extrabold text-[#D9534F] mb-6 drop-shadow-lg">ScribbleTools</h1>
                    <p class="text-2xl font-bold text-gray-800 mb-6 max-w-4xl mx-auto leading-relaxed">
                        The Ultimate, Ad-Free, All-in-One Toolbox for Everyone.<br>
                        <span class="block mt-4 text-3xl font-extrabold text-[#D9534F]">No ads. No clutter. Just tools.</span>
                    </p>
                    <p class="text-xl text-gray-700 mb-6 max-w-3xl mx-auto">
                        200+ professional calculators and utilities for finance, math, health, text processing, and more. 
                        All free, all private, all client-side processing.
                    </p>
                    <p class="text-lg font-semibold text-[#D9534F]">
                        Select a tool from the menu to get started, or use the search bar to find exactly what you need.
                    </p>
                </div>

                <!-- What We Provide Section -->
                <section class="bg-gradient-to-r from-blue-50 to-purple-50 p-8 rounded-2xl border border-blue-200 shadow-lg">
                    <h2 class="handwritten text-4xl text-gray-800 mb-6 text-center">ðŸ› ï¸ What We Provide</h2>
                    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                            <h3 class="text-xl font-bold text-blue-600 mb-3">ðŸ’° Financial Tools</h3>
                            <p class="text-gray-700 text-sm mb-3">Professional calculators for personal finance, business planning, and investment decisions.</p>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>â€¢ Mortgage & loan calculators</li>
                                <li>â€¢ Investment & retirement planning</li>
                                <li>â€¢ Tax calculators (income, sales, estate)</li>
                                <li>â€¢ Currency converters</li>
                                <li>â€¢ Compound interest calculators</li>
                            </ul>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                            <h3 class="text-xl font-bold text-green-600 mb-3">ðŸ”¢ Math & Science</h3>
                            <p class="text-gray-700 text-sm mb-3">Advanced mathematical calculators for students, engineers, and professionals.</p>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>â€¢ Area, volume, perimeter calculators</li>
                                <li>â€¢ Statistical analysis tools</li>
                                <li>â€¢ Unit converters (length, weight, temperature)</li>
                                <li>â€¢ Geometry calculators</li>
                                <li>â€¢ Scientific calculators</li>
                            </ul>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                            <h3 class="text-xl font-bold text-red-600 mb-3">ðŸ’ª Health & Fitness</h3>
                            <p class="text-gray-700 text-sm mb-3">Comprehensive health tracking and fitness planning tools.</p>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>â€¢ BMI & body fat calculators</li>
                                <li>â€¢ Calorie & nutrition trackers</li>
                                <li>â€¢ Fitness goal calculators</li>
                                <li>â€¢ Medical calculators (BMR, heart rate)</li>
                                <li>â€¢ Pregnancy & health trackers</li>
                            </ul>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                            <h3 class="text-xl font-bold text-purple-600 mb-3">ðŸ“ Text & Content</h3>
                            <p class="text-gray-700 text-sm mb-3">Powerful text processing and content creation utilities.</p>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>â€¢ Text formatters & converters</li>
                                <li>â€¢ Word & character counters</li>
                                <li>â€¢ Case converters & text cleaners</li>
                                <li>â€¢ Regular expression tools</li>
                                <li>â€¢ Content analyzers</li>
                            </ul>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                            <h3 class="text-xl font-bold text-orange-600 mb-3">ðŸ–¼ï¸ Image Tools</h3>
                            <p class="text-gray-700 text-sm mb-3">Professional image editing and processing tools.</p>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>â€¢ Image resizers & compressors</li>
                                <li>â€¢ Format converters</li>
                                <li>â€¢ Photo editors & filters</li>
                                <li>â€¢ Background removers</li>
                                <li>â€¢ Batch image processors</li>
                            </ul>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                            <h3 class="text-xl font-bold text-indigo-600 mb-3">ðŸŽ“ Student Resources</h3>
                            <p class="text-gray-700 text-sm mb-3">Educational tools for academic success and career development.</p>
                            <ul class="text-sm text-gray-600 space-y-1">
                                <li>â€¢ GPA & grade calculators</li>
                                <li>â€¢ Study planners & timers</li>
                                <li>â€¢ Resume builders</li>
                                <li>â€¢ Citation generators</li>
                                <li>â€¢ Career planning tools</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <!-- Privacy & Transparency Section -->
                <section class="bg-gradient-to-r from-yellow-50 to-orange-50 p-8 rounded-2xl border border-yellow-200 shadow-lg">
                    <h2 class="handwritten text-4xl text-gray-800 mb-6 text-center">ðŸ”’ Our Commitment to Transparency</h2>
                    <div class="space-y-6">
                        <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                            <h3 class="text-xl font-bold text-yellow-600 mb-3">ðŸš« What We DON&#39;T Do</h3>
                            <ul class="grid md:grid-cols-2 gap-2 text-gray-700">
                                <li>âœ— We don&#39;t store your personal data</li>
                                <li>âœ— We don&#39;t track your browsing habits</li>
                                <li>âœ— We don&#39;t show advertisements</li>
                                <li>âœ— We don&#39;t sell your information</li>
                                <li>âœ— We don&#39;t require registration or login</li>
                                <li>âœ— We don&#39;t collect cookies for tracking</li>
                                <li>âœ— We don&#39;t share data with third parties</li>
                                <li>âœ— We don&#39;t have hidden costs or premium features</li>
                            </ul>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                            <h3 class="text-xl font-bold text-green-600 mb-3">âœ… What We DO Promise</h3>
                            <ul class="grid md:grid-cols-2 gap-2 text-gray-700">
                                <li>âœ“ All calculations happen in your browser</li>
                                <li>âœ“ Your data never leaves your device</li>
                                <li>âœ“ Completely free forever</li>
                                <li>âœ“ No registration required</li>
                                <li>âœ“ Open to feedback and suggestions</li>
                                <li>âœ“ Constantly improving based on user needs</li>
                                <li>âœ“ Fast, lightweight, and accessible</li>
                                <li>âœ“ Regular updates and new tools</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <!-- Transparency & Continuous Improvement -->
                <section class="bg-gradient-to-r from-gray-50 to-slate-50 p-8 rounded-2xl border border-gray-200 shadow-lg">
                    <h2 class="handwritten text-4xl text-gray-800 mb-6 text-center">ðŸ”„ Our Development Philosophy</h2>
                    <div class="space-y-6 text-gray-700">
                        <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                            <h3 class="text-xl font-bold text-blue-600 mb-3">ðŸš€ Continuous Improvement</h3>
                            <p class="mb-3">We believe in transparency and continuous improvement. Here's how we operate:</p>
                            <ul class="space-y-2">
                                <li><strong>We Accept Our Limitations:</strong> Our tools are constantly evolving. If you encounter bugs, calculation errors, or missing features, please let us know. We&#39;re not perfect, but we&#39;re committed to improvement.</li>
                                <li><strong>User-Driven Development:</strong> Every suggestion matters. We prioritize new tools and features based on user feedback and real-world needs.</li>
                                <li><strong>Open Communication:</strong> We maintain transparent communication about updates, fixes, and planned features through our feedback system.</li>
                                <li><strong>Quality Over Quantity:</strong> While we offer many tools, we ensure each one is functional, accurate, and user-friendly.</li>
                            </ul>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                            <h3 class="text-xl font-bold text-green-600 mb-3">ðŸ’¡ How You Can Help</h3>
                            <ul class="space-y-2">
                                <li><strong>Report Issues:</strong> Found a bug or error? We want to know! Your reports help us improve.</li>
                                <li><strong>Suggest Features:</strong> Need a tool we don&#39;t have? Tell us what you&#39;d like to see added.</li>
                                <li><strong>Share Feedback:</strong> Love a tool or think it could be better? Your insights guide our development.</li>
                                <li><strong>Spread the Word:</strong> If ScribbleTools helps you, share it with others who might benefit.</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <!-- SEO-Rich Tool Categories -->
                <section class="bg-gradient-to-r from-indigo-50 to-purple-50 p-8 rounded-2xl border border-indigo-200 shadow-lg">
                    <h2 class="handwritten text-4xl text-gray-800 mb-6 text-center">ðŸ” Popular Calculator Categories</h2>
                    <div class="grid md:grid-cols-3 gap-4 text-sm">
                        <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                            <h4 class="font-bold text-blue-600 mb-2">Financial Calculators</h4>
                            <p class="text-gray-600">mortgage calculator, loan calculator, compound interest, 401k calculator, retirement planning, tax calculator, currency converter, investment calculator, savings calculator, amortization calculator</p>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                            <h4 class="font-bold text-green-600 mb-2">Math & Geometry</h4>
                            <p class="text-gray-600">area calculator, volume calculator, perimeter calculator, triangle calculator, circle calculator, percentage calculator, fraction calculator, algebra solver, statistics calculator, unit converter</p>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                            <h4 class="font-bold text-red-600 mb-2">Health & Fitness</h4>
                            <p class="text-gray-600">BMI calculator, calorie calculator, body fat calculator, BMR calculator, ideal weight calculator, pregnancy calculator, heart rate calculator, macro calculator, fitness tracker, nutrition calculator</p>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                            <h4 class="font-bold text-purple-600 mb-2">Text Processing</h4>
                            <p class="text-gray-600">word counter, character counter, text formatter, case converter, text analyzer, regex tester, markdown converter, HTML encoder, text cleaner, duplicate remover</p>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                            <h4 class="font-bold text-orange-600 mb-2">Image Tools</h4>
                            <p class="text-gray-600">image resizer, photo compressor, format converter, background remover, image cropper, photo editor, batch processor, thumbnail generator, image optimizer, photo filter</p>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                            <h4 class="font-bold text-indigo-600 mb-2">Student Tools</h4>
                            <p class="text-gray-600">GPA calculator, grade calculator, study planner, citation generator, resume builder, essay planner, assignment tracker, flashcard maker, research tools, academic calendar</p>
                        </div>
                    </div>
                </section>

                <!-- Call to Action -->
                <section class="text-center bg-gradient-to-r from-red-50 to-pink-50 p-8 rounded-2xl border border-red-200 shadow-lg">
                    <h2 class="handwritten text-4xl text-[#D9534F] mb-4">Ready to Get Started?</h2>
                    <p class="text-xl text-gray-700 mb-6 max-w-3xl mx-auto">
                        Join millions of users who trust ScribbleTools for their daily calculations and conversions. Select any tool from our comprehensive menu, use our search feature, or browse by category.
                    </p>
                    <div class="flex flex-wrap justify-center gap-4 mt-6">
                        <div class="bg-white px-6 py-3 rounded-lg shadow-sm border border-gray-200">
                            <strong class="text-[#D9534F]">200+</strong> Free Tools
                        </div>
                        <div class="bg-white px-6 py-3 rounded-lg shadow-sm border border-gray-200">
                            <strong class="text-[#D9534F]">0</strong> Ads Forever
                        </div>
                        <div class="bg-white px-6 py-3 rounded-lg shadow-sm border border-gray-200">
                            <strong class="text-[#D9534F]">100%</strong> Privacy Focused
                        </div>
                        <div class="bg-white px-6 py-3 rounded-lg shadow-sm border border-gray-200">
                            <strong class="text-[#D9534F]">24/7</strong> Available
                        </div>
                    </div>
                    <p class="text-lg text-gray-600 mt-6 italic">
                        "ScribbleTools - Where productivity meets privacy, and calculations meet convenience."
                    </p>
                </section>
            </div>
        `;        
        const aboutContent = `
             <div class="p-8 space-y-8">
                <div>
                    <h2 class="handwritten text-5xl text-[#D9534F] mb-4 text-center">About ScribbleTools</h2>
                    <p class="text-gray-600 leading-relaxed max-w-3xl mx-auto text-center">
                        ScribbleTools is your all-in-one, distraction-free toolbox for text, math, finance, health, and more. Born from the frustration of ad-filled, clunky utility sites, we set out to build a collection of beautiful, fast, and genuinely useful online tools that people actually enjoy using.<br><br>
                        <strong>What makes us different?</strong> We focus on speed, clarity, and a delightful hand-drawn aesthetic. Every tool is crafted to be intuitive, lightweight, and free of unnecessary clutter. Whether youâ€™re a student, developer, teacher, or just someone who needs to get things done, ScribbleTools is designed to help you work smarter, not harder.
                    </p>
                </div>

                <div class="grid md:grid-cols-2 gap-8 items-center">
                    <div>
                        <h3 class="handwritten text-4xl text-gray-800 mb-3">Our Philosophy</h3>
                        <p class="text-gray-600 leading-relaxed">
                            <strong>Simplicity is Key:</strong> Every tool is designed to be intuitive and straightforward. No confusing interfaces, no unnecessary steps. Just the functionality you need, presented clearly.<br><br>
                            <strong>Speed Matters:</strong> Your time is valuable. Our tools are built with modern, lightweight web technologies to ensure they load instantly and perform calculations in a flash.<br><br>
                            <strong>A Joy to Use:</strong> Utility doesnâ€™t have to be boring. With a unique, hand-drawn aesthetic, we aim to make your daily tasks a little more delightful.<br><br>
                            <strong>Privacy First:</strong> We donâ€™t track you, store your data, or show you ads. Everything runs in your browser for maximum privacy and speed.
                        </p>
                    </div>
                    <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExbXN0eXNqZzZpZ2ZkN2Q0cGJmZzF3b2l1bTdzc2U5N2N6eXFtdnNqZSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/3o7btNa0RUYa5E7iiQ/giphy.gif" class="rounded-lg shadow-md w-full h-auto object-cover" alt="Creative Process GIF">
                </div>

                 <div class="grid md:grid-cols-2 gap-8 items-center">
                    <img src="https://media.tenor.com/o6HowXvQwW8AAAAM/think-big-think.gif" class="rounded-lg shadow-md w-full h-auto object-cover" alt="Community GIF">
                    <div>
                        <h3 class="handwritten text-4xl text-gray-800 mb-3">Why So Many Tools?</h3>
                        <p class="text-gray-600 leading-relaxed">
                           We believe in thinking big. Why create one tool when you can build a comprehensive library? Our goal is to be the single destination for any quick calculation, conversion, or text manipulation you might need. By building this extensive collection, we aim to create a truly indispensable resource for a wide audience.<br><br>
                           <strong>Always Growing:</strong> This project is a labor of love, and weâ€™re constantly scribbling down new ideas for utilities to add. If you have a suggestion, let us know!
                        </p>
                    </div>
                </div>
                <div class="mt-8 p-6 bg-amber-50/50 rounded-lg border border-amber-200 max-w-3xl mx-auto">
                    <h3 class="font-semibold text-lg text-amber-800 mb-3">What can you do here?</h3>
                    <ul class="list-disc list-inside text-gray-700">
                        <li>Manipulate, analyze, and format text in dozens of ways</li>
                        <li>Calculate loans, mortgages, investments, and more</li>
                        <li>Crunch numbers with math and science calculators</li>
                        <li>Track your health, fitness, and nutrition</li>
                        <li>Convert, encode, and decode data</li>
                        <li>And much moreâ€”no ads, no tracking, just tools</li>
                    </ul>
                </div>
            </div>
        `;
        
        const blogContent = `
            <div class="p-8 space-y-8">
                <div class="text-center mb-12">
                    <h2 class="handwritten text-5xl text-[#D9534F] mb-4">ScribbleTools Blog</h2>
                    <p class="text-gray-600 leading-relaxed max-w-3xl mx-auto">
                        Welcome to our blog! Here we share insights about productivity, web development, useful tips for our tools, and the journey of building ScribbleTools. Stay tuned for updates, tutorials, and behind-the-scenes content.
                    </p>
                </div>

                <!-- Featured Article -->
                <div class="bg-gradient-to-r from-purple-50 to-pink-50 p-8 rounded-2xl border border-purple-200 shadow-lg cursor-pointer hover:shadow-xl transition-shadow" onclick="navigateToBlog('blog-welcome')">
                    <div class="flex items-start gap-4 mb-4">
                        <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-semibold">Featured</span>
                        <span class="text-gray-500 text-sm">December 10, 2024</span>
                    </div>
                    <h3 class="handwritten text-3xl text-gray-800 mb-4">ðŸš€ Welcome to ScribbleTools: Your New Favorite Productivity Hub</h3>
                    <p class="text-gray-700 leading-relaxed mb-6">
                        We're excited to introduce ScribbleTools - a comprehensive, ad-free collection of online utilities designed to make your digital life easier. From text manipulation to financial calculations, health tracking to image editing, we've built something truly special.
                    </p>
                    <div class="space-y-4">
                        <h4 class="font-semibold text-lg text-gray-800">ðŸŽ¯ What Makes ScribbleTools Different?</h4>
                        <ul class="list-disc list-inside text-gray-700 space-y-2 ml-4">
                            <li><strong>No Ads, Ever:</strong> We're committed to keeping ScribbleTools completely ad-free</li>
                            <li><strong>Privacy First:</strong> All processing happens in your browser - we never see your data</li>
                            <li><strong>Lightning Fast:</strong> Modern, optimized tools that load instantly</li>
                            <li><strong>Beautiful Design:</strong> Hand-drawn aesthetic that makes work feel delightful</li>
                            <li><strong>Always Growing:</strong> New tools added regularly based on community feedback</li>
                        </ul>
                    </div>
                    <div class="mt-6 p-4 bg-white/50 rounded-lg border border-purple-100">
                        <p class="text-gray-600 text-sm">
                            <strong>ðŸ§žâ€â™‚ï¸ Fun Fact:</strong> Our magical privacy genie isn't just for show - it represents our commitment to protecting your data and providing a delightful, distraction-free experience!
                        </p>
                    </div>
                </div>

                <!-- Blog Posts Grid -->
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Post 1 -->
                    <article class="bg-white p-6 rounded-xl shadow-md border border-gray-200 hover:shadow-lg transition-shadow cursor-pointer" onclick="navigateToBlog('blog-text-tools')">
                        <div class="flex items-center gap-2 mb-3">
                            <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-semibold">Tutorial</span>
                            <span class="text-gray-500 text-sm">Dec 8, 2024</span>
                        </div>
                        <h3 class="handwritten text-xl text-gray-800 mb-3">ðŸ“ Mastering Text Tools: 10 Hidden Gems</h3>
                        <p class="text-gray-600 text-sm leading-relaxed mb-4">
                            Discover powerful text manipulation features you might have missed. From advanced case conversion to bulk text processing tips.
                        </p>
                        <div class="flex items-center justify-between">
                            <span class="text-xs text-gray-400">5 min read</span>
                            <span class="text-[#D9534F] text-sm font-semibold">Read More â†’</span>
                        </div>
                    </article>

                    <!-- Post 2 -->
                    <article class="bg-white p-6 rounded-xl shadow-md border border-gray-200 hover:shadow-lg transition-shadow cursor-pointer" onclick="navigateToBlog('blog-financial-planning')">
                        <div class="flex items-center gap-2 mb-3">
                            <span class="bg-green-100 text-green-800 px-2 py-1 rounded text-xs font-semibold">Tips</span>
                            <span class="text-gray-500 text-sm">Dec 5, 2024</span>
                        </div>
                        <h3 class="handwritten text-xl text-gray-800 mb-3">ðŸ’° Financial Planning Made Easy</h3>
                        <p class="text-gray-600 text-sm leading-relaxed mb-4">
                            Learn how to use our financial calculators effectively for budgeting, loan planning, and investment calculations.
                        </p>
                        <div class="flex items-center justify-between">
                            <span class="text-xs text-gray-400">7 min read</span>
                            <span class="text-[#D9534F] text-sm font-semibold">Read More â†’</span>
                        </div>
                    </article>

                    <!-- Post 3 -->
                    <article class="bg-white p-6 rounded-xl shadow-md border border-gray-200 hover:shadow-lg transition-shadow cursor-pointer" onclick="navigateToBlog('blog-tech-stack')">
                        <div class="flex items-center gap-2 mb-3">
                            <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded text-xs font-semibold">Dev Blog</span>
                            <span class="text-gray-500 text-sm">Dec 1, 2024</span>
                        </div>
                        <h3 class="handwritten text-xl text-gray-800 mb-3">ðŸ› ï¸ Building ScribbleTools: Tech Stack</h3>
                        <p class="text-gray-600 text-sm leading-relaxed mb-4">
                            A behind-the-scenes look at how we built ScribbleTools using modern web technologies for maximum performance.
                        </p>
                        <div class="flex items-center justify-between">
                            <span class="text-xs text-gray-400">10 min read</span>
                            <span class="text-[#D9534F] text-sm font-semibold">Read More â†’</span>
                        </div>
                    </article>

                    <!-- Post 4 -->
                    <article class="bg-white p-6 rounded-xl shadow-md border border-gray-200 hover:shadow-lg transition-shadow cursor-pointer" onclick="navigateToBlog('blog-fitness-tracking')">
                        <div class="flex items-center gap-2 mb-3">
                            <span class="bg-orange-100 text-orange-800 px-2 py-1 rounded text-xs font-semibold">Health</span>
                            <span class="text-gray-500 text-sm">Nov 28, 2024</span>
                        </div>
                        <h3 class="handwritten text-xl text-gray-800 mb-3">ðŸƒâ€â™€ï¸ Fitness Tracking Simplified</h3>
                        <p class="text-gray-600 text-sm leading-relaxed mb-4">
                            Make the most of our health and fitness calculators. Track your progress and achieve your wellness goals.
                        </p>
                        <div class="flex items-center justify-between">
                            <span class="text-xs text-gray-400">6 min read</span>
                            <span class="text-[#D9534F] text-sm font-semibold">Read More â†’</span>
                        </div>
                    </article>

                    <!-- Post 5 -->
                    <article class="bg-white p-6 rounded-xl shadow-md border border-gray-200 hover:shadow-lg transition-shadow cursor-pointer" onclick="navigateToBlog('blog-image-tools')">
                        <div class="flex items-center gap-2 mb-3">
                            <span class="bg-red-100 text-red-800 px-2 py-1 rounded text-xs font-semibold">Updates</span>
                            <span class="text-gray-500 text-sm">Nov 25, 2024</span>
                        </div>
                        <h3 class="handwritten text-xl text-gray-800 mb-3">ðŸŽ¨ New Image Tools Released!</h3>
                        <p class="text-gray-600 text-sm leading-relaxed mb-4">
                            Announcing our latest batch of image editing and processing tools. Perfect for social media and professional use.
                        </p>
                        <div class="flex items-center justify-between">
                            <span class="text-xs text-gray-400">4 min read</span>
                            <span class="text-[#D9534F] text-sm font-semibold">Read More â†’</span>
                        </div>
                    </article>

                    <!-- Post 6 -->
                    <article class="bg-white p-6 rounded-xl shadow-md border border-gray-200 hover:shadow-lg transition-shadow cursor-pointer" onclick="navigateToBlog('blog-community')">
                        <div class="flex items-center gap-2 mb-3">
                            <span class="bg-teal-100 text-teal-800 px-2 py-1 rounded text-xs font-semibold">Community</span>
                            <span class="text-gray-500 text-sm">Nov 20, 2024</span>
                        </div>
                        <h3 class="handwritten text-xl text-gray-800 mb-3">ðŸ’¬ Community Spotlight & Feedback</h3>
                        <p class="text-gray-600 text-sm leading-relaxed mb-4">
                            Celebrating our amazing community and the incredible feedback that helps us improve ScribbleTools every day.
                        </p>
                        <div class="flex items-center justify-between">
                            <span class="text-xs text-gray-400">3 min read</span>
                            <span class="text-[#D9534F] text-sm font-semibold">Read More â†’</span>
                        </div>
                    </article>
                </div>

                <!-- Newsletter Signup -->
                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-8 rounded-2xl border border-blue-200 text-center">
                    <h3 class="handwritten text-3xl text-gray-800 mb-4">ðŸ“¬ Stay Updated</h3>
                    <p class="text-gray-600 mb-6 max-w-2xl mx-auto">
                        Want to be the first to know about new tools, features, and blog posts? Join our newsletter for updates delivered straight to your inbox.
                    </p>
                    <div class="flex max-w-md mx-auto gap-3">
                        <input type="email" placeholder="Enter your email" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <button class="bg-[#D9534F] text-white px-6 py-2 rounded-lg font-semibold hover:bg-[#c44347] transition-colors">Subscribe</button>
                    </div>
                    <p class="text-xs text-gray-500 mt-3">No spam, ever. Unsubscribe anytime.</p>
                </div>

                <!-- Coming Soon -->
                <div class="text-center py-8">
                    <h3 class="handwritten text-3xl text-gray-800 mb-4">ðŸš€ Coming Soon</h3>
                    <p class="text-gray-600 max-w-2xl mx-auto leading-relaxed">
                        We're working on exciting new content including video tutorials, in-depth tool guides, productivity tips, and guest posts from our community. Stay tuned!
                    </p>
                </div>
            </div>
        `;
        
        // Individual Blog Post Contents
        const blogWelcomeContent = `
            <div class="p-8 max-w-4xl mx-auto">
                <div class="mb-8">
                    <button onclick="window.location.hash = '#blogs'" class="text-[#D9534F] hover:underline mb-4 flex items-center gap-2">
                        â† Back to Blog
                    </button>
                    <div class="flex items-center gap-4 mb-4">
                        <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-semibold">Featured</span>
                        <span class="text-gray-500">December 10, 2024</span>
                        <span class="text-gray-400">â€¢</span>
                        <span class="text-gray-500">8 min read</span>
                    </div>
                    <h1 class="handwritten text-4xl text-gray-800 mb-6">ðŸš€ Welcome to ScribbleTools: Your New Favorite Productivity Hub</h1>
                </div>
                <div class="prose prose-lg max-w-none">
                    <p class="text-lg text-gray-700 leading-relaxed">Coming soon...</p>
                </div>
            </div>
        `;

        const blogTextToolsContent = `
            <div class="p-8 max-w-4xl mx-auto">
                <div class="mb-8">
                    <button onclick="window.location.hash = '#blogs'" class="text-[#D9534F] hover:underline mb-4 flex items-center gap-2">
                        â† Back to Blog
                    </button>
                    <div class="flex items-center gap-4 mb-4">
                        <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-semibold">Tutorial</span>
                        <span class="text-gray-500">December 8, 2024</span>
                        <span class="text-gray-400">â€¢</span>
                        <span class="text-gray-500">5 min read</span>
                    </div>
                    <h1 class="handwritten text-4xl text-gray-800 mb-6">ðŸ“ Mastering Text Tools: 10 Hidden Gems</h1>
                </div>
                <div class="prose prose-lg max-w-none">
                    <p class="text-lg text-gray-700 leading-relaxed">Coming soon...</p>
                </div>
            </div>
        `;

        const blogFinancialPlanningContent = `
            <div class="p-8 max-w-4xl mx-auto">
                <div class="mb-8">
                    <button onclick="window.location.hash = '#blogs'" class="text-[#D9534F] hover:underline mb-4 flex items-center gap-2">
                        â† Back to Blog
                    </button>
                    <div class="flex items-center gap-4 mb-4">
                        <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-semibold">Tips</span>
                        <span class="text-gray-500">December 5, 2024</span>
                        <span class="text-gray-400">â€¢</span>
                        <span class="text-gray-500">7 min read</span>
                    </div>
                    <h1 class="handwritten text-4xl text-gray-800 mb-6">ðŸ’° Financial Planning Made Easy</h1>
                </div>
                <div class="prose prose-lg max-w-none">
                    <p class="text-lg text-gray-700 leading-relaxed">Coming soon...</p>
                </div>
            </div>
        `;

        const blogTechStackContent = `
            <div class="p-8 max-w-4xl mx-auto">
                <div class="mb-8">
                    <button onclick="window.location.hash = '#blogs'" class="text-[#D9534F] hover:underline mb-4 flex items-center gap-2">
                        â† Back to Blog
                    </button>
                    <div class="flex items-center gap-4 mb-4">
                        <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-semibold">Dev Blog</span>
                        <span class="text-gray-500">December 1, 2024</span>
                        <span class="text-gray-400">â€¢</span>
                        <span class="text-gray-500">10 min read</span>
                    </div>
                    <h1 class="handwritten text-4xl text-gray-800 mb-6">ðŸ› ï¸ Building ScribbleTools: Tech Stack</h1>
                </div>
                <div class="prose prose-lg max-w-none">
                    <p class="text-lg text-gray-700 leading-relaxed">Coming soon...</p>
                </div>
            </div>
        `;

        const blogFitnessTrackingContent = `
            <div class="p-8 max-w-4xl mx-auto">
                <div class="mb-8">
                    <button onclick="window.location.hash = '#blogs'" class="text-[#D9534F] hover:underline mb-4 flex items-center gap-2">
                        â† Back to Blog
                    </button>
                    <div class="flex items-center gap-4 mb-4">
                        <span class="bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm font-semibold">Health</span>
                        <span class="text-gray-500">November 28, 2024</span>
                        <span class="text-gray-400">â€¢</span>
                        <span class="text-gray-500">6 min read</span>
                    </div>
                    <h1 class="handwritten text-4xl text-gray-800 mb-6">ðŸƒâ€â™€ï¸ Fitness Tracking Simplified</h1>
                </div>
                <div class="prose prose-lg max-w-none">
                    <p class="text-lg text-gray-700 leading-relaxed">Coming soon...</p>
                </div>
            </div>
        `;

        const blogImageToolsContent = `
            <div class="p-8 max-w-4xl mx-auto">
                <div class="mb-8">
                    <button onclick="window.location.hash = '#blogs'" class="text-[#D9534F] hover:underline mb-4 flex items-center gap-2">
                        â† Back to Blog
                    </button>
                    <div class="flex items-center gap-4 mb-4">
                        <span class="bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-semibold">Updates</span>
                        <span class="text-gray-500">November 25, 2024</span>
                        <span class="text-gray-400">â€¢</span>
                        <span class="text-gray-500">4 min read</span>
                    </div>
                    <h1 class="handwritten text-4xl text-gray-800 mb-6">ðŸŽ¨ New Image Tools Released!</h1>
                </div>
                <div class="prose prose-lg max-w-none">
                    <p class="text-lg text-gray-700 leading-relaxed">Coming soon...</p>
                </div>
            </div>
        `;

        const blogCommunityContent = `
            <div class="p-8 max-w-4xl mx-auto">
                <div class="mb-8">
                    <button onclick="window.location.hash = '#blogs'" class="text-[#D9534F] hover:underline mb-4 flex items-center gap-2">
                        â† Back to Blog
                    </button>
                    <div class="flex items-center gap-4 mb-4">
                        <span class="bg-teal-100 text-teal-800 px-3 py-1 rounded-full text-sm font-semibold">Community</span>
                        <span class="text-gray-500">November 20, 2024</span>
                        <span class="text-gray-400">â€¢</span>
                        <span class="text-gray-500">3 min read</span>
                    </div>
                    <h1 class="handwritten text-4xl text-gray-800 mb-6">ðŸ’¬ Community Spotlight & Feedback</h1>
                </div>
                <div class="prose prose-lg max-w-none">
                    <p class="text-lg text-gray-700 leading-relaxed">Coming soon...</p>
                </div>
            </div>
        `;
        
        const contactContent = `
             <div class="p-8">
                <h2 class="handwritten text-5xl text-[#D9534F] mb-4">Contact Us</h2>
                <p class="text-gray-600 leading-relaxed">Have a suggestion for a new tool or feedback on an existing one? We'd love to hear from you. Please feel free to reach out to our team.</p>
                <div class="mt-6">
                    <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSdbzEwaABUSLTN16DSDToWJXYJtUISp7pfGcZHijvJ1zkPKZA/viewform?embedded=true" width="100%" height="600" frameborder="0" marginheight="0" marginwidth="0">Loadingâ€¦</iframe>
                </div>
            </div>
        `;

        const feedbackContent = `
             <div class="p-8">
                <h2 class="handwritten text-5xl text-[#D9534F] mb-4">Submit Feedback</h2>
                <p class="text-gray-600 leading-relaxed">Your feedback is valuable to us! Please let us know if you've found a bug, have a suggestion for a new tool, or have any other comments.</p>
                <div class="mt-6">
                    <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSeoySeGnd8OJUzDjcz5fnLnICpxdt6DmQBI50lkHSKsYfSe0Q/viewform?embedded=true" width="100%" height="700" frameborder="0" marginheight="0" marginwidth="0">Loadingâ€¦</iframe>
                </div>
            </div>
        `;

        const requestToolContent = `
            <div class="p-8 max-w-4xl mx-auto">
                <h2 class="handwritten text-5xl text-[#D9534F] mb-4 text-center">ðŸ“ Request a Tool</h2>
               
                <p class="text-gray-700 text-lg mb-6 text-center">Need a comprehensive tool with specific features? Tell us exactly what you need, why you need it, and how it should work. We love building detailed solutions!</p>
                <div class="bg-white rounded-lg shadow-md border border-gray-200 p-6">
                    <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSfIUv3Y4n7n2Iab39GssPzzA3gnQyTNaXuThzuUM22TxwYalw/viewform?embedded=true" width="100%" height="800" frameborder="0" marginheight="0" marginwidth="0">Loadingâ€¦</iframe>
                </div>
                <p class="text-sm text-gray-500 text-center mt-4">ðŸ’¡ For quick, simple ideas, try our chat widget in the bottom-right corner!</p>
            </div>
        `;

        // Blog navigation function
        function navigateToBlog(blogId) {
            window.location.hash = '#' + blogId;
        }

        // Function to hide/show tool navigation based on current page
        function toggleToolNavigation(show) {
            const toolNav = document.getElementById('tool-nav');
            const mobileToggle = document.getElementById('mobile-nav-toggle');
            
            if (toolNav) {
                if (show) {
                    // Show navigation - respect mobile state
                    toolNav.style.display = '';
                    if (mobileToggle) {
                        mobileToggle.style.display = '';
                    }
                    
                    // On desktop, always show. On mobile, keep current state
                    if (window.innerWidth >= 768) {
                        toolNav.classList.remove('hidden');
                        toolNav.classList.add('flex');
                    }
                } else {
                    // Hide navigation completely
                    toolNav.style.display = 'none';
                    if (mobileToggle) {
                        mobileToggle.style.display = 'none';
                    }
                }
            }
        }

        async function loadContent(path, query) {
            console.log('loadContent called with path:', path);
            console.log('Current location:', window.location.href);
            
            // Clear any existing intervals or timeouts to prevent memory leaks
            for (let i = 1; i < 99999; i++) {
                window.clearInterval(i);
                window.clearTimeout(i);
            }
            
            appContainer.innerHTML = '<div class="flex justify-center items-center h-full"><div class="spinner"></div></div>';
            try {
                console.log('Fetching:', path);
                const response = await fetch(path);
                console.log('Fetch response:', response.status, response.ok, response.statusText);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status} - ${response.statusText}`);
                }
                
                const html = await response.text();
                console.log('HTML received, length:', html.length);
                console.log('HTML starts with:', html.substring(0, 100));

                // Create a temporary container to parse the HTML
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = html;

                // Remove all <script> tags from the tempDiv and collect them
                const scripts = Array.from(tempDiv.querySelectorAll('script'));
                scripts.forEach(script => script.parentNode.removeChild(script));

                // Inject the rest of the HTML into the app container
                appContainer.innerHTML = '';
                while (tempDiv.firstChild) {
                    appContainer.appendChild(tempDiv.firstChild);
                }

                // Clean up existing tool scripts to prevent conflicts
                const existingToolScripts = document.querySelectorAll('script[data-tool-script]');
                existingToolScripts.forEach(script => script.remove());

                // Run scripts with proper cleanup and initialization
                const scriptPromises = scripts.map(oldScript => {
                    return new Promise((resolve, reject) => {
                        const newScript = document.createElement('script');
                        newScript.setAttribute('data-tool-script', 'true');

                        Array.from(oldScript.attributes).forEach(attr => {
                            if (attr.name !== 'data-tool-script') {
                                newScript.setAttribute(attr.name, attr.value);
                            }
                        });

                        if (oldScript.src) {
                            const originalSrc = oldScript.getAttribute('src');
                            if (originalSrc) {
                                // Handle relative paths from the loaded tool file
                                if (originalSrc.startsWith('http') || originalSrc.startsWith('/') || originalSrc.startsWith('client/')) {
                                    newScript.src = originalSrc;
                                } else {
                                    const basePath = path.substring(0, path.lastIndexOf('/') + 1);
                                    newScript.src = basePath + originalSrc;
                                }
                            }
                            newScript.onload = () => resolve();
                            newScript.onerror = () => reject(new Error(`Script load error: ${newScript.src}`));
                        } else {
                            newScript.textContent = oldScript.textContent;
                            resolve(); // Inline scripts are executed synchronously when appended
                        }
                        document.body.appendChild(newScript);
                    });
                });

                // After all scripts are loaded, call the initializer once.
                Promise.all(scriptPromises)
                    .then(() => {
                        console.log(`âœ… All scripts for ${path} have been loaded. Initializing tool...`);
                        checkAndInitializeTool(path);
                    })
                    .catch(error => {
                        console.error('An error occurred while loading tool scripts:', error);
                    });

                // This function is now a placeholder, but we'll keep the structure
                function runScriptsWithQRCodeCheck(scripts) {
                    if (typeof QRCode !== 'undefined') {
                        // Scripts are already running via Promises
                    } else {
                        // Wait for QRCode to be available
                        const interval = setInterval(() => {
                            if (typeof QRCode !== 'undefined') {
                                clearInterval(interval);
                                // Scripts are already running
                            }
                        }, 50);
                    }
                }

                // Centralized tool initialization function
                function checkAndInitializeTool(path) {
                    // Wait a bit more for DOM and scripts to be fully ready
                    setTimeout(() => {
                        // Image tools
                        if (path.includes('image-compressor') && window.initializeImageCompressor) {
                            window.initializeImageCompressor();
                        } else if (path.includes('image-converter') && window.initializeImageConverter) {
                            window.initializeImageConverter();
                        } else if (path.includes('passport-photo-maker') && window.initializePassportPhotoMaker) {
                            window.initializePassportPhotoMaker();
                        } else if (path.includes('reduce-image-size-kb') && window.initializeReduceImageSize) {
                            window.initializeReduceImageSize();
                        } else if (path.includes('resize-image-pixel') && window.initializeResizeImagePixel) {
                            window.initializeResizeImagePixel();
                        } else if (path.includes('generate-signature') && window.initializeGenerateSignature) {
                            window.initializeGenerateSignature();
                        } else if (path.includes('increase-image-size-kb') && window.initializeIncreaseImageSize) {
                            window.initializeIncreaseImageSize();
                        } else if (path.includes('watermark-images') && window.initializeWatermarkImages) {
                            window.initializeWatermarkImages();
                        } else if (path.includes('rotate-image') && window.initializeRotateImage) {
                            window.initializeRotateImage();
                        } else if (path.includes('gif-tools') && window.initializeGIFTools) {
                            window.initializeGIFTools();
                        } else if (path.includes('grayscale-image') && window.initializeGrayscaleImageTool) {
                            window.initializeGrayscaleImageTool();
                        } else if (path.includes('image-color-picker') && window.initializeImageColorPickerTool) {
                            window.initializeImageColorPickerTool();
                        } else if (path.includes('remove-image-background') && window.initializeRemoveImageBackgroundTool) {
                            window.initializeRemoveImageBackgroundTool();
                        } else if (path.includes('picture-to-pixel-art') && window.initializePictureToPixelArtTool) {
                            window.initializePictureToPixelArtTool();
                        } else if (path.includes('black-white-image') && window.initializeBlackWhiteImageTool) {
                            window.initializeBlackWhiteImageTool();
                        } else if (path.includes('circle-crop') && window.initializeCircleCropTool) {
                            window.initializeCircleCropTool();
                        } else if (path.includes('flip-image') && window.initializeFlipImageTool) {
                            window.initializeFlipImageTool();
                        } else if (path.includes('resize-sign-50mm-20mm') && window.initializeResizeSign50x20Tool) {
                            console.log('ðŸ“ Initializing Resize Sign 50mm x 20mm Tool...');
                            window.initializeResizeSign50x20Tool();
                            console.log('âœ… Resize Sign 50mm x 20mm Tool initialized');
                        } else if (path.includes('add-name-dob-photo') && window.initializeAddNameDobTool) {
                            console.log('ðŸ·ï¸ Initializing Add Name & DOB Tool...');
                            window.initializeAddNameDobTool();
                            console.log('âœ… Add Name & DOB Tool initialized');
                                                } else if (path.includes('gif-tools') && window.initializeGifTools) {
                            window.initializeGifTools();
                        }
                        // Other tools
                        else if (path.includes('personal-notes')) {
                            console.log('ðŸ“ Initializing Personal Notes...');
                            // Try multiple initialization methods
                            if (window.initializePersonalNotes) {
                                window.initializePersonalNotes();
                            } else if (window.loadNotes) {
                                window.loadNotes();
                            } else {
                                // Fallback: wait a bit and try again
                                setTimeout(() => {
                                    if (window.initializePersonalNotes) {
                                        window.initializePersonalNotes();
                                    } else if (window.loadNotes) {
                                        window.loadNotes();
                                    }
                                }, 500);
                            }
                            console.log('âœ… Personal Notes initialization attempted');
                        }
                        // Student Tools
                        else if (path.includes('resume-builder')) {
                            console.log('ðŸ“‹ Initializing Resume Builder...');
                            try {
                                if (window.initializeResumeBuilder) {
                                    const result = window.initializeResumeBuilder();
                                    if (result) {
                                        console.log('âœ… Resume Builder initialized successfully');
                                    }
                                } else {
                                    console.warn('âš ï¸ Resume Builder initialization function not found, retrying...');
                                    // Retry after a short delay
                                    setTimeout(() => {
                                        if (window.initializeResumeBuilder) {
                                            window.initializeResumeBuilder();
                                            console.log('âœ… Resume Builder initialized on retry');
                                        }
                                    }, 500);
                                }
                            } catch (error) {
                                console.error('âŒ Error initializing Resume Builder:', error);
                            }
                        } else if (path.includes('cover-letter-generator') && window.initializeCoverLetterGenerator) {
                            console.log('ðŸ“„ Initializing Cover Letter Generator...');
                            window.initializeCoverLetterGenerator();
                        } else if (path.includes('interview-questions') && window.initializeInterviewQuestions) {
                            console.log('â“ Initializing Interview Questions...');
                            window.initializeInterviewQuestions();
                        } else if (path.includes('job-tracker') && window.initializeJobTracker) {
                            console.log('ðŸ“Š Initializing Job Application Tracker...');
                            window.initializeJobTracker();
                        } else if (path.includes('gpa-calculator') && window.initializeGpaCalculator) {
                            console.log('ðŸ“š Initializing GPA Calculator...');
                            window.initializeGpaCalculator();
                        } else if (path.includes('grade-calculator') && window.initializeGradeCalculator) {
                            console.log('ðŸ“ˆ Initializing Grade Calculator...');
                            window.initializeGradeCalculator();
                        } else if (path.includes('study-planner') && window.initializeStudyPlanner) {
                            console.log('ðŸ“… Initializing Study Planner...');
                            window.initializeStudyPlanner();
                        } else if (path.includes('pomodoro-timer') && window.initializePomodoroTimer) {
                            console.log('â° Initializing Pomodoro Timer...');
                            window.initializePomodoroTimer();
                        } else if (path.includes('assignment-tracker') && window.initializeAssignmentTracker) {
                            console.log('ðŸ“ Initializing Assignment Tracker...');
                            window.initializeAssignmentTracker();
                        } else if (path.includes('student-budget') && window.initializeStudentBudget) {
                            console.log('ðŸ’° Initializing Student Budget Calculator...');
                            window.initializeStudentBudget();
                        } else if (path.includes('student-loan-calculator') && window.initializeStudentLoanCalculator) {
                            console.log('ðŸŽ“ Initializing Student Loan Calculator...');
                            window.initializeStudentLoanCalculator();
                        } else if (path.includes('textbook-cost') && window.initializeTextbookCost) {
                            console.log('ðŸ“– Initializing Textbook Cost Optimizer...');
                            window.initializeTextbookCost();
                        } else if (path.includes('semester-cost') && window.initializeSemesterCost) {
                            console.log('ðŸ« Initializing Semester Cost Estimator...');
                            window.initializeSemesterCost();
                        } else if (path.includes('expense-splitter') && window.initializeExpenseSplitter) {
                            console.log('ðŸ’¸ Initializing Expense Splitter...');
                            window.initializeExpenseSplitter();
                        } else if (path.includes('habit-tracker') && window.initializeHabitTracker) {
                            console.log('ðŸŽ¯ Initializing Habit Tracker...');
                            window.initializeHabitTracker();
                        } else if (path.includes('time-tracker') && window.initializeTimeTracker) {
                            console.log('â±ï¸ Initializing Study Time Tracker...');
                            window.initializeTimeTracker();
                        } else if (path.includes('goal-tracker') && window.initializeGoalTracker) {
                            console.log('ðŸŽ¯ Initializing Goal Progress Tracker...');
                            window.initializeGoalTracker();
                        } else if (path.includes('focus-timer') && window.initializeFocusTimer) {
                            console.log('ðŸ§  Initializing Focus Session Timer...');
                            window.initializeFocusTimer();
                        } else if (path.includes('reflection-journal') && window.initializeReflectionJournal) {
                            console.log('ðŸ“” Initializing Weekly Reflection Journal...');
                            window.initializeReflectionJournal();
                        }
                        // Financial tools
                        else if (path.includes('Canadian-Mortgage-Calculator') && window.initializeCanadianMortgageCalculator) {
                            window.initializeCanadianMortgageCalculator();
                        } else if (path.includes('sales-tax-calculator') && window.initializeSalesTaxCalculator) {
                            window.initializeSalesTaxCalculator();
                        } else if (path.includes('salary-calculator') && window.initializeSalaryCalculator) {
                            window.initializeSalaryCalculator();
                        }
                        // Health tools
                        else if (path.includes('ideal-weight-calculator') && window.initializeIdealWeightCalculator) {
                            window.initializeIdealWeightCalculator();
                        }
                        // New tools
                        else if (path.includes('password-generator') && window.initializePasswordGenerator) {
                            console.log('ðŸ” Initializing Password Generator...');
                            window.initializePasswordGenerator();
                            console.log('âœ… Password Generator initialized');
                        } else if (path.includes('random-number-generator') && window.initializeRandomNumberGenerator) {
                            console.log('ðŸŽ² Initializing Random Number Generator...');
                            window.initializeRandomNumberGenerator();
                            console.log('âœ… Random Number Generator initialized');
                        } else if (path.includes('basic-calculator') && window.initializeBasicCalculator) {
                            console.log('ðŸ§® Initializing Basic Calculator...');
                            setTimeout(() => {
                                // Force initialization even if DOMContentLoaded already fired
                                window.initializeBasicCalculator();
                                
                                // Double-check that keypad events are working
                                const keypad = document.querySelector('.basic-calc-keypad');
                                if (keypad && !keypad.dataset.initialized) {
                                    console.log('Rebinding basic calculator keypad events...');
                                    keypad.addEventListener('click', function(e) {
                                        if (e.target.matches('[data-val]')) {
                                            console.log('Calculator button clicked:', e.target.dataset.val);
                                        }
                                    });
                                    keypad.dataset.initialized = 'true';
                                }
                                
                                // Ensure keyboard events work
                                document.addEventListener('keydown', function(e) {
                                    if (document.querySelector('.basic-calc-container')) {
                                        console.log('Calculator keyboard event:', e.key);
                                    }
                                });
                            }, 200);
                            console.log('âœ… Basic Calculator initialized');
                        } else if (path.includes('percentage-calculator')) {
                            console.log('ðŸ“Š Initializing Percentage Calculator...');
                            // Percentage calculator is ready by default, ensure DOM is loaded
                            setTimeout(() => {
                                const calcBtn = document.getElementById('perc-calc-calc');
                                const inputField = document.getElementById('perc-input');
                                
                                if (calcBtn && inputField) {
                                    console.log('Percentage calculator elements found, ensuring event listeners...');
                                    
                                    // Remove existing listeners to prevent duplicates
                                    const newCalcBtn = calcBtn.cloneNode(true);
                                    const newInputField = inputField.cloneNode(true);
                                    
                                    calcBtn.parentNode.replaceChild(newCalcBtn, calcBtn);
                                    inputField.parentNode.replaceChild(newInputField, inputField);
                                    
                                    // Re-add event listeners
                                    newCalcBtn.addEventListener('click', function() {
                                        let expr = newInputField.value;
                                        if (!expr.trim()) return showResult('Enter a percentage expression.');
                                        evaluatePercentExpr(expr);
                                    });
                                    
                                    newInputField.addEventListener('keydown', function(e) {
                                        if (e.key === 'Enter') {
                                            let expr = newInputField.value;
                                            if (!expr.trim()) return showResult('Enter a percentage expression.');
                                            evaluatePercentExpr(expr);
                                        }
                                    });
                                    
                                    console.log('Percentage calculator event listeners rebound successfully');
                                }
                            }, 200);
                            console.log('âœ… Percentage Calculator initialized');
                        } else if (path.includes('square-root-calculator')) {
                            console.log('âˆš Initializing Square Root Calculator...');
                            setTimeout(() => {
                                // Ensure all form elements and buttons have proper event listeners
                                const allButtons = document.querySelectorAll('button');
                                const allInputs = document.querySelectorAll('input[type="number"], input[type="text"]');
                                
                                allButtons.forEach(btn => {
                                    if (btn.textContent.includes('Calculate') || btn.id.includes('calc')) {
                                        console.log('Found calculate button, ensuring it works:', btn.id);
                                    }
                                });
                                
                                allInputs.forEach(input => {
                                    input.addEventListener('keydown', function(e) {
                                        if (e.key === 'Enter') {
                                            const calcBtn = input.closest('div, form').querySelector('button');
                                            if (calcBtn) calcBtn.click();
                                        }
                                    });
                                });
                            }, 200);
                            console.log('âœ… Square Root Calculator initialized');
                        } else if (path.includes('exponent-calculator')) {
                            console.log('^ Initializing Exponent Calculator...');
                            console.log('âœ… Exponent Calculator initialized');
                        } else if (path.includes('average-calculator')) {
                            console.log('ðŸ“Š Initializing Average Calculator...');
                            console.log('âœ… Average Calculator initialized');
                        } else if (path.includes('fraction-calculator')) {
                            console.log('â…“ Initializing Fraction Calculator...');
                            console.log('âœ… Fraction Calculator initialized');
                        } else if (path.includes('discount-calculator')) {
                            console.log('ðŸ’° Initializing Discount Calculator...');
                            console.log('âœ… Discount Calculator initialized');
                        } else if (path.includes('tip-calculator')) {
                            console.log('ðŸ’¡ Initializing Tip Calculator...');
                            console.log('âœ… Tip Calculator initialized');
                        } else if (path.includes('simple-interest-calculator')) {
                            console.log('ðŸ’µ Initializing Simple Interest Calculator...');
                            console.log('âœ… Simple Interest Calculator initialized');
                        } else if (path.includes('unit-price-calculator')) {
                            console.log('ðŸª Initializing Unit Price Calculator...');
                            console.log('âœ… Unit Price Calculator initialized');
                        } else if (path.includes('age-calculator') && window.initializeAgeCalculator) {
                            console.log('ðŸ“… Initializing Age Calculator...');
                            window.initializeAgeCalculator();
                            console.log('âœ… Age Calculator initialized');
                        }
                        // Math/Geometry tool initializations
                        else if (path.includes('area-calculator')) {
                            console.log('ðŸ“ Initializing Area Calculator...');
                            // For geometry tools, trigger the default initialization if available
                            if (window.updateInputs && typeof window.updateInputs === 'function') {
                                window.updateInputs();
                            }
                            console.log('âœ… Area Calculator initialized');
                        } else if (path.includes('perimeter-calculator')) {
                            console.log('ðŸ“ Initializing Perimeter Calculator...');
                            if (window.updateInputs && typeof window.updateInputs === 'function') {
                                window.updateInputs();
                            }
                            console.log('âœ… Perimeter Calculator initialized');
                        } else if (path.includes('volume-calculator')) {
                            console.log('ðŸ§Š Initializing Volume Calculator...');
                            if (window.updateInputs && typeof window.updateInputs === 'function') {
                                window.updateInputs();
                            }
                            console.log('âœ… Volume Calculator initialized');
                        } else if (path.includes('surface-area-calculator')) {
                            console.log('ðŸ“¦ Initializing Surface Area Calculator...');
                            if (window.updateInputs && typeof window.updateInputs === 'function') {
                                window.updateInputs();
                            }
                            console.log('âœ… Surface Area Calculator initialized');
                        }
                        // Statistics tool initializations  
                        else if (path.includes('statistics-calculator')) {
                            console.log('ðŸ“Š Initializing Statistics Calculator...');
                            // Statistics tools are ready by default
                            console.log('âœ… Statistics Calculator initialized');
                        } else if (path.includes('standard-deviation-calculator')) {
                            console.log('ðŸ“ˆ Initializing Standard Deviation Calculator...');
                            console.log('âœ… Standard Deviation Calculator initialized');
                        } else if (path.includes('mean-median-mode-range-calculator')) {
                            console.log('ðŸ“Š Initializing Mean/Median/Mode Calculator...');
                            console.log('âœ… Mean/Median/Mode Calculator initialized');
                        } else if (path.includes('z-score-calculator')) {
                            console.log('ðŸ“‰ Initializing Z-Score Calculator...');
                            console.log('âœ… Z-Score Calculator initialized');
                        } else if (path.includes('probability-calculator')) {
                            console.log('ðŸŽ² Initializing Probability Calculator...');
                            console.log('âœ… Probability Calculator initialized');
                        } else if (path.includes('permutation-and-combination-calculator')) {
                            console.log('ðŸ”¢ Initializing Permutation & Combination Calculator...');
                            console.log('âœ… Permutation & Combination Calculator initialized');
                        } else if (path.includes('confidence-interval-calculator')) {
                            console.log('ðŸ“Š Initializing Confidence Interval Calculator...');
                            console.log('âœ… Confidence Interval Calculator initialized');
                        } else if (path.includes('sample-size-calculator')) {
                            console.log('ðŸ‘¥ Initializing Sample Size Calculator...');
                            console.log('âœ… Sample Size Calculator initialized');
                        }
                        // Shapes tool initializations
                        else if (path.includes('circle-calculator')) {
                            console.log('â­• Initializing Circle Calculator...');
                            if (window.updateInputs && typeof window.updateInputs === 'function') {
                                window.updateInputs();
                            }
                            console.log('âœ… Circle Calculator initialized');
                        } else if (path.includes('triangle-calculator')) {
                            console.log('ðŸ”º Initializing Triangle Calculator...');
                            if (window.updateInputs && typeof window.updateInputs === 'function') {
                                window.updateInputs();
                            }
                            console.log('âœ… Triangle Calculator initialized');
                        } else if (path.includes('rectangle-calculator')) {
                            console.log('â¬› Initializing Rectangle Calculator...');
                            if (window.updateInputs && typeof window.updateInputs === 'function') {
                                window.updateInputs();
                            }
                            console.log('âœ… Rectangle Calculator initialized');
                        } else if (path.includes('sphere-calculator')) {
                            console.log('ðŸŒ• Initializing Sphere Calculator...');
                            if (window.updateInputs && typeof window.updateInputs === 'function') {
                                window.updateInputs();
                            }
                            console.log('âœ… Sphere Calculator initialized');
                        } else if (path.includes('cylinder-calculator')) {
                            console.log('ðŸ¥¤ Initializing Cylinder Calculator...');
                            if (window.updateInputs && typeof window.updateInputs === 'function') {
                                window.updateInputs();
                            }
                            console.log('âœ… Cylinder Calculator initialized');
                        } else if (path.includes('cuboid-calculator')) {
                            console.log('ðŸ“¦ Initializing Cuboid Calculator...');
                            if (window.updateInputs && typeof window.updateInputs === 'function') {
                                window.updateInputs();
                            }
                            console.log('âœ… Cuboid Calculator initialized');
                        } else if (path.includes('polygon-calculator')) {
                            console.log('ðŸ”· Initializing Polygon Calculator...');
                            if (window.updateInputs && typeof window.updateInputs === 'function') {
                                window.updateInputs();
                            }
                            console.log('âœ… Polygon Calculator initialized');
                        }
                        // Add emoji tool initialization
                        else if (path.includes('emoji-replacer-inserter') && window.initializeEmojiTool) {
                            console.log('ðŸ˜€ Initializing Emoji Replacer/Inserter...');
                            window.initializeEmojiTool();
                            console.log('âœ… Emoji Replacer/Inserter initialized');
                        }
                        
                        // General math tool fix for input/button issues
                        setTimeout(() => {
                            if (path.includes('math/')) {
                                console.log('ðŸ”§ Applying general math tool fixes...');
                                
                                // Find all input fields and ensure they can accept values
                                const inputs = document.querySelectorAll('input[type="number"], input[type="text"], textarea');
                                inputs.forEach(input => {
                                    // Remove any potential restrictions that might prevent input
                                    input.removeAttribute('readonly');
                                    input.removeAttribute('disabled');
                                    
                                    // Ensure the input can receive focus and input
                                    input.addEventListener('focus', function() {
                                        this.style.pointerEvents = 'auto';
                                        this.style.userSelect = 'auto';
                                    });
                                    
                                    // Add Enter key support
                                    input.addEventListener('keydown', function(e) {
                                        if (e.key === 'Enter') {
                                            const container = this.closest('div, form, .container');
                                            const calcBtn = container?.querySelector('button, .calc-btn, [id*="calc"], [class*="calc"]');
                                            if (calcBtn) {
                                                console.log('Triggering calculation via Enter key');
                                                calcBtn.click();
                                            }
                                        }
                                    });
                                });
                                
                                // Find all calculation buttons and ensure they work
                                const calcButtons = document.querySelectorAll('button, .calc-btn, [id*="calc"], [class*="calc"]');
                                calcButtons.forEach(btn => {
                                    if (btn.textContent.toLowerCase().includes('calculate') || 
                                        btn.id.toLowerCase().includes('calc') ||
                                        btn.className.toLowerCase().includes('calc')) {
                                        
                                        console.log('Ensuring math button works:', btn.id || btn.textContent);
                                        
                                        // Remove potential CSS that might block interaction
                                        btn.style.pointerEvents = 'auto';
                                        btn.style.userSelect = 'auto';
                                        btn.removeAttribute('disabled');
                                        
                                        // Ensure click events work
                                        btn.addEventListener('click', function(e) {
                                            console.log('Math tool button clicked:', this.id || this.textContent);
                                        });
                                    }
                                });
                                
                                console.log('âœ… General math tool fixes applied');
                            }
                        }, 100);
                        
                        // Add more tool initializations as needed
                        
                        // For tools without specific initialization functions, try generic initialization
                        if (typeof initializeTool === 'function') {
                            initializeTool();
                        }
                        
                        // For tools that do not have specific initialization, ensure basic event listeners are working
                        // Re-trigger any click event handlers that might have been added in the scripts
                        const buttons = appContainer.querySelectorAll('button, input[type="button"], .calc-btn');
                        buttons.forEach(button => {
                            // Check if button already has event listeners by trying to trigger events
                            const event = new Event('initCheck');
                            button.dispatchEvent(event);
                        });
                        
                        // Trigger a custom event to notify tools they can initialize
                        const toolLoadedEvent = new CustomEvent('toolLoaded', { detail: { path: path } });
                        document.dispatchEvent(toolLoadedEvent);
                    }, 200);
                }
                runScriptsWithQRCodeCheck(scripts);
                
                // Fallback initialization for tools that might need extra time
                setTimeout(() => checkAndInitializeTool(path), 500);
            } catch (error) {
                console.error("Failed to load content:", error);
                console.error("Path was:", path);
                console.error("Error details:", error.message, error.stack);
                appContainer.innerHTML = `<p class="text-red-500 text-center">Sorry, we couldn't load this tool. Error: ${error.message}</p>`;
            }
        }

        function router() {
            console.log('Router called with hash:', window.location.hash);
            let hash = window.location.hash || '#home'; // Default to #home
            let query = '';
            if (hash.includes('?')) {
                [hash, query] = hash.split('?');
            }
            const path = routes[hash];
            console.log('Looking for path:', path, 'for hash:', hash);
            
            // Track tool navigation
            if (hash !== '#home') {
                try {
                    trackToolNavigation(hash.replace('#', ''));
                } catch (e) {
                    console.warn('Tool tracking error:', e);
                }
            }
            
            // Update navigation active states
            try {
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.toggle('active', link.getAttribute('href') === hash);
                });
            } catch (e) {
                console.warn('Navigation update error:', e);
            }

            // Handle individual blog posts and blog listing
            if (hash.startsWith('#blog-')) {
                console.log('Handling blog route:', hash);
                try {
                    toggleToolNavigation(false); // Hide tool navigation for blog posts
                    
                    if (hash === '#blog-welcome') {
                        appContainer.innerHTML = blogWelcomeContent;
                    } else if (hash === '#blog-text-tools') {
                        appContainer.innerHTML = blogTextToolsContent;
                    } else if (hash === '#blog-financial-planning') {
                        appContainer.innerHTML = blogFinancialPlanningContent;
                    } else if (hash === '#blog-tech-stack') {
                        appContainer.innerHTML = blogTechStackContent;
                    } else if (hash === '#blog-fitness-tracking') {
                        appContainer.innerHTML = blogFitnessTrackingContent;
                    } else if (hash === '#blog-image-tools') {
                        appContainer.innerHTML = blogImageToolsContent;
                    } else if (hash === '#blog-community') {
                        appContainer.innerHTML = blogCommunityContent;
                    } else {
                        console.warn('Unknown blog route:', hash);
                        appContainer.innerHTML = '<div class="p-8"><h2 class="text-2xl">Blog post not found</h2><a href="#blogs" class="text-blue-500">â† Back to Blog</a></div>';
                    }
                    console.log('Blog content loaded for:', hash);
                    return;
                } catch (e) {
                    console.error('Blog routing error:', e);
                    appContainer.innerHTML = '<div class="p-8"><h2 class="text-2xl text-red-500">Error loading blog post</h2><a href="#blogs" class="text-blue-500">â† Back to Blog</a></div>';
                    return;
                }
            } else {
                toggleToolNavigation(true); // Show tool navigation for other pages
            }

            // Handle regular routes
            try {
                if (path && path !== 'blog-listing') {
                    console.log('Loading content from path:', path);
                    loadContent(path);
                } else if (hash === '#about') {
                    appContainer.innerHTML = aboutContent;
                } else if (hash === '#blogs') {
                    console.log('Loading blog listing');
                    toggleToolNavigation(true); // Show tool navigation for blog listing
                    appContainer.innerHTML = blogContent;
                } else if (hash === '#contact') {
                    appContainer.innerHTML = contactContent;
                } else if (hash === '#feedback') {
                    appContainer.innerHTML = feedbackContent;
                } else if (hash === '#request-tool') {
                    appContainer.innerHTML = requestToolContent;
                } else {
                    console.log('Loading home content');
                    appContainer.innerHTML = homeContent;
                }
            } catch (e) {
                console.error('Router error:', e);
                appContainer.innerHTML = '<div class="p-8"><h2 class="text-2xl text-red-500">Error loading page</h2></div>';
            }
        }
        
        // --- Search Functionality ---
        searchInput.addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            const allLinks = document.querySelectorAll('.nav-link');
            
            allLinks.forEach(link => {
                const linkText = link.textContent.toLowerCase();
                const parentDetails = link.closest('details');
                const subCategory = link.closest('.nav-subcategory');

                if (linkText.includes(searchTerm)) {
                    link.style.display = 'block';
                    if (parentDetails) parentDetails.open = true;
                    if (subCategory) subCategory.open = true;
                } else {
                    link.style.display = 'none';
                }
            });

            // Hide categories if all links within are hidden
            document.querySelectorAll('.nav-category').forEach(category => {
                const visibleLinks = category.querySelectorAll('.nav-link[style*="display: block"]');
                if (visibleLinks.length === 0) {
                    category.style.display = 'none';
                } else {
                    category.style.display = 'block';
                }
            });
        });

        // Chat system variables
        let chatOpen = false;
        let chatWindow = null;
        let chatInput = null;
        let chatSend = null;
        let chatMessages = null;
        let chatAutocomplete = null;
        let allChatMessages = [];
        let selectedAutocompleteIndex = -1;
        
        // Ground rules for the platform
        const groundRules = {
            chat: {
                maxMessageLength: 500,
                cooldownPeriod: 2000, // 2 seconds between messages
                bannedWords: ['spam', 'abuse', 'inappropriate'],
                maxMessagesPerHour: 50
            },
            tools: {
                maxFileSize: 50 * 1024 * 1024, // 50MB
                allowedFileTypes: ['image/jpeg', 'image/png', 'image/gif', 'image/webp', 'text/plain', 'text/csv'],
                rateLimit: 100 // requests per hour
            },
            admin: {
                canModerateChat: true,
                canDeleteMessages: true,
                canBanUsers: true,
                canAccessAnalytics: true,
                canManageTools: true
            }
        };

        // Create tool suggestions from routes
        const toolSuggestions = Object.keys(routes).map(route => {
            const toolName = route.replace('#', '').replace(/-/g, ' ');
            const category = getToolCategory(route);
            return {
                name: toolName,
                route: route,
                category: category,
                icon: getToolIcon(category)
            };
        });

        // Additional autocomplete suggestions (200+ total)
        const extraSuggestions = [
            // Popular tools and requests
            { name: 'tool', icon: 'ðŸ”§', category: 'General' },
            { name: 'calculator', icon: 'ðŸ”¢', category: 'Math' },
            { name: 'converter', icon: 'ðŸ”„', category: 'Utility' },
            { name: 'generator', icon: 'âš¡', category: 'Utility' },
            { name: 'checker', icon: 'âœ…', category: 'Utility' },
            { name: 'analyzer', icon: 'ðŸ“Š', category: 'Utility' },
            { name: 'formatter', icon: 'ðŸ“', category: 'Text' },
            { name: 'compressor', icon: 'ðŸ“¦', category: 'Image' },
            { name: 'resizer', icon: 'ðŸ“', category: 'Image' },
            { name: 'editor', icon: 'âœï¸', category: 'Text' },
            
            // Common tool requests
            { name: 'password generator', icon: 'ðŸ”', category: 'Security' },
            { name: 'qr code generator', icon: 'ðŸ“±', category: 'Utility' },
            { name: 'color picker', icon: 'ðŸŽ¨', category: 'Image' },
            { name: 'unit converter', icon: 'ðŸ“', category: 'Math' },
            { name: 'currency converter', icon: 'ðŸ’±', category: 'Finance' },
            { name: 'json formatter', icon: 'ðŸ“„', category: 'Text' },
            { name: 'base64 encoder', icon: 'ðŸ”¤', category: 'Text' },
            { name: 'url shortener', icon: 'ðŸ”—', category: 'Utility' },
            { name: 'hash generator', icon: 'ðŸ”¢', category: 'Security' },
            { name: 'timestamp converter', icon: 'â°', category: 'Utility' },
            
            // Health tools
            { name: 'calorie counter', icon: 'ðŸŽ', category: 'Health' },
            { name: 'water intake calculator', icon: 'ðŸ’§', category: 'Health' },
            { name: 'sleep calculator', icon: 'ðŸ˜´', category: 'Health' },
            { name: 'bmi tracker', icon: 'âš–ï¸', category: 'Health' },
            { name: 'workout planner', icon: 'ðŸ’ª', category: 'Health' },
            { name: 'heart rate monitor', icon: 'â¤ï¸', category: 'Health' },
            { name: 'nutrition tracker', icon: 'ðŸ¥—', category: 'Health' },
            { name: 'fitness calculator', icon: 'ðŸƒ', category: 'Health' },
            
            // Finance tools
            { name: 'budget calculator', icon: 'ðŸ’°', category: 'Finance' },
            { name: 'loan calculator', icon: 'ðŸ¦', category: 'Finance' },
            { name: 'tax calculator', icon: 'ðŸ“Š', category: 'Finance' },
            { name: 'investment tracker', icon: 'ðŸ“ˆ', category: 'Finance' },
            { name: 'savings calculator', icon: 'ðŸ¦', category: 'Finance' },
            { name: 'expense tracker', icon: 'ðŸ’³', category: 'Finance' },
            { name: 'mortgage calculator', icon: 'ðŸ ', category: 'Finance' },
            { name: 'retirement planner', icon: 'ðŸ–ï¸', category: 'Finance' },
            
            // Text tools
            { name: 'word counter', icon: 'ðŸ“', category: 'Text' },
            { name: 'text analyzer', icon: 'ðŸ”', category: 'Text' },
            { name: 'plagiarism checker', icon: 'ðŸ“‹', category: 'Text' },
            { name: 'grammar checker', icon: 'âœï¸', category: 'Text' },
            { name: 'spell checker', icon: 'ðŸ“–', category: 'Text' },
            { name: 'text translator', icon: 'ðŸŒ', category: 'Text' },
            { name: 'markdown editor', icon: 'ðŸ“„', category: 'Text' },
            { name: 'regex tester', icon: 'ðŸ”§', category: 'Text' },
            
            // Image tools
            { name: 'photo editor', icon: 'ðŸ–¼ï¸', category: 'Image' },
            { name: 'background remover', icon: 'ðŸ–¼ï¸', category: 'Image' },
            { name: 'image optimizer', icon: 'âš¡', category: 'Image' },
            { name: 'photo filters', icon: 'ðŸŽ¨', category: 'Image' },
            { name: 'image cropper', icon: 'âœ‚ï¸', category: 'Image' },
            { name: 'watermark tool', icon: 'ðŸ’§', category: 'Image' },
            { name: 'gif maker', icon: 'ðŸŽ¬', category: 'Image' },
            { name: 'meme generator', icon: 'ðŸ˜‚', category: 'Image' },
            
            // Developer tools
            { name: 'code formatter', icon: 'ðŸ’»', category: 'Developer' },
            { name: 'api tester', icon: 'ðŸ”Œ', category: 'Developer' },
            { name: 'css generator', icon: 'ðŸŽ¨', category: 'Developer' },
            { name: 'html validator', icon: 'âœ…', category: 'Developer' },
            { name: 'minifier', icon: 'ðŸ“¦', category: 'Developer' },
            { name: 'beautifier', icon: 'âœ¨', category: 'Developer' },
            { name: 'sql formatter', icon: 'ðŸ—„ï¸', category: 'Developer' },
            { name: 'xml parser', icon: 'ðŸ“„', category: 'Developer' },
            
            // Utility tools
            { name: 'habit tracker', icon: 'ðŸ“…', category: 'Utility' },
            { name: 'todo list', icon: 'âœ…', category: 'Utility' },
            { name: 'timer', icon: 'â±ï¸', category: 'Utility' },
            { name: 'stopwatch', icon: 'â°', category: 'Utility' },
            { name: 'pomodoro timer', icon: 'ðŸ…', category: 'Utility' },
            { name: 'reminder app', icon: 'ðŸ””', category: 'Utility' },
            { name: 'note taker', icon: 'ðŸ““', category: 'Utility' },
            { name: 'voice recorder', icon: 'ðŸŽ¤', category: 'Utility' },
            
            // Educational tools
            { name: 'flashcards', icon: 'ðŸ“š', category: 'Education' },
            { name: 'quiz maker', icon: 'â“', category: 'Education' },
            { name: 'study planner', icon: 'ðŸ“…', category: 'Education' },
            { name: 'grade calculator', icon: 'ðŸ“Š', category: 'Education' },
            { name: 'citation generator', icon: 'ðŸ“–', category: 'Education' },
            { name: 'research helper', icon: 'ðŸ”', category: 'Education' },
            { name: 'learning tracker', icon: 'ðŸ“ˆ', category: 'Education' },
            { name: 'presentation maker', icon: 'ðŸ“½ï¸', category: 'Education' },
            
            // Popular requests
            { name: 'dark mode', icon: 'ðŸŒ™', category: 'Feature' },
            { name: 'mobile app', icon: 'ðŸ“±', category: 'Feature' },
            { name: 'offline mode', icon: 'ðŸ“±', category: 'Feature' },
            { name: 'export feature', icon: 'ðŸ“¤', category: 'Feature' },
            { name: 'import feature', icon: 'ðŸ“¥', category: 'Feature' },
            { name: 'save to cloud', icon: 'â˜ï¸', category: 'Feature' },
            { name: 'keyboard shortcuts', icon: 'âŒ¨ï¸', category: 'Feature' },
            { name: 'user accounts', icon: 'ðŸ‘¤', category: 'Feature' },
            
            // More specific tools
            { name: 'isbn checker', icon: 'ðŸ“š', category: 'Utility' },
            { name: 'credit card validator', icon: 'ðŸ’³', category: 'Utility' },
            { name: 'email validator', icon: 'ðŸ“§', category: 'Utility' },
            { name: 'phone number formatter', icon: 'ðŸ“ž', category: 'Utility' },
            { name: 'zip code lookup', icon: 'ðŸ“®', category: 'Utility' },
            { name: 'weather widget', icon: 'ðŸŒ¤ï¸', category: 'Utility' },
            { name: 'world clock', icon: 'ðŸŒ', category: 'Utility' },
            { name: 'timezone converter', icon: 'ðŸ•', category: 'Utility' },
            
            // Common chat words and greetings
            { name: 'hello', icon: 'ðŸ‘‹', category: 'Chat' },
            { name: 'hi', icon: 'ðŸ‘‹', category: 'Chat' },
            { name: 'hey', icon: 'ðŸ‘‹', category: 'Chat' },
            { name: 'good morning', icon: 'ðŸŒ…', category: 'Chat' },
            { name: 'good afternoon', icon: 'â˜€ï¸', category: 'Chat' },
            { name: 'good evening', icon: 'ðŸŒ†', category: 'Chat' },
            { name: 'good night', icon: 'ðŸŒ™', category: 'Chat' },
            { name: 'thanks', icon: 'ðŸ™', category: 'Chat' },
            { name: 'thank you', icon: 'ðŸ™', category: 'Chat' },
            { name: 'please', icon: 'ðŸ™', category: 'Chat' },
            { name: 'welcome', icon: 'ðŸ¤—', category: 'Chat' },
            { name: 'awesome', icon: 'ðŸŒŸ', category: 'Chat' },
            { name: 'amazing', icon: 'ðŸ¤©', category: 'Chat' },
            { name: 'great', icon: 'ðŸ‘', category: 'Chat' },
            { name: 'cool', icon: 'ðŸ˜Ž', category: 'Chat' },
            { name: 'nice', icon: 'ðŸ‘Œ', category: 'Chat' },
            { name: 'perfect', icon: 'âœ¨', category: 'Chat' },
            { name: 'excellent', icon: 'ðŸ’¯', category: 'Chat' },
            { name: 'love it', icon: 'â¤ï¸', category: 'Chat' },
            { name: 'help', icon: 'ðŸ†˜', category: 'Chat' },
            { name: 'question', icon: 'â“', category: 'Chat' },
            { name: 'idea', icon: 'ðŸ’¡', category: 'Chat' },
            { name: 'suggestion', icon: 'ðŸŽ¯', category: 'Chat' },
            { name: 'feedback', icon: 'ðŸ“', category: 'Chat' },
            { name: 'bug report', icon: 'ðŸ›', category: 'Chat' },
            { name: 'feature request', icon: 'â­', category: 'Chat' },
            { name: 'how to', icon: 'ðŸ¤”', category: 'Chat' },
            { name: 'tutorial', icon: 'ðŸ“š', category: 'Chat' },
            { name: 'guide', icon: 'ðŸ—ºï¸', category: 'Chat' },
            { name: 'documentation', icon: 'ðŸ“–', category: 'Chat' },
            { name: 'examples', icon: 'ðŸ“‹', category: 'Chat' },
            { name: 'demo', icon: 'ðŸŽ¬', category: 'Chat' },
            { name: 'test', icon: 'ðŸ§ª', category: 'Chat' },
            { name: 'working', icon: 'âœ…', category: 'Chat' },
            { name: 'not working', icon: 'âŒ', category: 'Chat' },
            { name: 'broken', icon: 'ðŸ’”', category: 'Chat' },
            { name: 'fixed', icon: 'ðŸ”§', category: 'Chat' },
            { name: 'updated', icon: 'ðŸ”„', category: 'Chat' },
            { name: 'new', icon: 'ðŸ†•', category: 'Chat' },
            { name: 'old', icon: 'ðŸ“œ', category: 'Chat' },
            { name: 'fast', icon: 'âš¡', category: 'Chat' },
            { name: 'slow', icon: 'ðŸŒ', category: 'Chat' },
            { name: 'easy', icon: 'ðŸ˜Š', category: 'Chat' },
            { name: 'difficult', icon: 'ðŸ˜…', category: 'Chat' },
            { name: 'simple', icon: 'ðŸŽ¯', category: 'Chat' },
            { name: 'complex', icon: 'ðŸ§©', category: 'Chat' },
            { name: 'useful', icon: 'ðŸ‘', category: 'Chat' },
            { name: 'useless', icon: 'ðŸ‘Ž', category: 'Chat' },
            { name: 'important', icon: 'âš ï¸', category: 'Chat' },
            { name: 'urgent', icon: 'ðŸš¨', category: 'Chat' },
            { name: 'priority', icon: 'ðŸ”¥', category: 'Chat' },
            { name: 'later', icon: 'â°', category: 'Chat' },
            { name: 'now', icon: 'âš¡', category: 'Chat' },
            { name: 'today', icon: 'ðŸ“…', category: 'Chat' },
            { name: 'tomorrow', icon: 'ðŸ“†', category: 'Chat' },
            { name: 'yesterday', icon: 'ðŸ“‹', category: 'Chat' },
            { name: 'soon', icon: 'ðŸ”œ', category: 'Chat' },
            { name: 'maybe', icon: 'ðŸ¤·', category: 'Chat' },
            { name: 'definitely', icon: 'ðŸ’¯', category: 'Chat' },
            { name: 'probably', icon: 'ðŸ¤”', category: 'Chat' },
            { name: 'yes', icon: 'âœ…', category: 'Chat' },
            { name: 'no', icon: 'âŒ', category: 'Chat' },
            { name: 'okay', icon: 'ðŸ‘Œ', category: 'Chat' },
            { name: 'alright', icon: 'ðŸ‘', category: 'Chat' },
            { name: 'sure', icon: 'âœ¨', category: 'Chat' },
            { name: 'absolutely', icon: 'ðŸ’¯', category: 'Chat' },
            { name: 'exactly', icon: 'ðŸŽ¯', category: 'Chat' },
            { name: 'totally', icon: 'ðŸ’¯', category: 'Chat' },
            { name: 'completely', icon: 'âœ…', category: 'Chat' },
            { name: 'really', icon: 'ðŸ˜®', category: 'Chat' },
            { name: 'seriously', icon: 'ðŸ˜¤', category: 'Chat' },
            { name: 'actually', icon: 'ðŸ¤“', category: 'Chat' },
            { name: 'honestly', icon: 'ðŸ˜‡', category: 'Chat' },
            { name: 'basically', icon: 'ðŸ“', category: 'Chat' },
            { name: 'generally', icon: 'ðŸŒ', category: 'Chat' },
            { name: 'specifically', icon: 'ðŸŽ¯', category: 'Chat' },
            { name: 'especially', icon: 'â­', category: 'Chat' },
            { name: 'particularly', icon: 'ðŸ”', category: 'Chat' },
            { name: 'mainly', icon: 'ðŸŽ¯', category: 'Chat' },
            { name: 'mostly', icon: 'ðŸ“Š', category: 'Chat' },
            { name: 'sometimes', icon: 'ðŸ”„', category: 'Chat' },
            { name: 'always', icon: 'â™¾ï¸', category: 'Chat' },
            { name: 'never', icon: 'ðŸš«', category: 'Chat' },
            { name: 'often', icon: 'ðŸ”', category: 'Chat' },
            { name: 'rarely', icon: 'ðŸ”¸', category: 'Chat' },
            { name: 'frequently', icon: 'ðŸ“ˆ', category: 'Chat' },
            { name: 'occasionally', icon: 'ðŸŽ²', category: 'Chat' }
        ];

        // Combine all suggestions
        const allSuggestions = [...toolSuggestions, ...extraSuggestions];

        // Auto-response messages for community engagement
        const autoResponses = [
            "That's a great idea! ðŸ‘",
            "I've been looking for something like that too!",
            "Would love to see this implemented ðŸš€",
            "This could be really useful for students!",
            "Perfect for productivity! âš¡",
            "Great suggestion! Hope the devs see this ðŸ‘€",
            "I use tools like this daily, would be awesome here!",
            "This would save me so much time! â°",
            "Brilliant idea! ðŸ’¡",
            "Yes please! This is exactly what I need ðŸ™",
            "Amazing suggestion! Can't wait to try it",
            "This would be a game changer! ðŸŽ®",
            "Such a practical tool idea! ðŸ› ï¸",
            "I'd use this every day! ðŸ“…",
            "Great thinking! Very useful ðŸ§ ",
            "Love this concept! â¤ï¸",
            "This would help so many people! ðŸ‘¥",
            "Fantastic idea! Keep them coming! ðŸŒŸ",
            "So needed! Hope it gets built soon ðŸ¤ž",
            "This is why I love this community! ðŸ¤"
        ];

        function getToolCategory(route) {
            if (route.includes('text')) return 'Text';
            if (route.includes('math')) return 'Math';
            if (route.includes('financial')) return 'Finance';
            if (route.includes('health')) return 'Health';
            if (route.includes('image')) return 'Image';
            return 'Utility';
        }

        function getToolIcon(category) {
            const icons = {
                'Text': 'ðŸ“',
                'Math': 'ðŸ”¢',
                'Finance': 'ðŸ’°',
                'Health': 'ðŸ¥',
                'Image': 'ðŸ–¼ï¸',
                'Utility': 'ðŸ› ï¸',
                'Security': 'ðŸ”',
                'Developer': 'ðŸ’»',
                'Education': 'ðŸ“š',
                'Feature': 'âš¡',
                'General': 'ðŸ”§',
                'Chat': 'ðŸ’¬'
            };
            return icons[category] || 'ðŸ”§';
        }

        // Initialize with some sample public messages
        const sampleMessages = [
            { user: "Alex", message: "Just tried the @bmi-calculator.html - works perfectly! ðŸ’ª", timestamp: new Date(Date.now() - 3600000) },
            { user: "Sarah", message: "@tool need a habit tracker for daily routines", timestamp: new Date(Date.now() - 1800000) },
            { user: "Mike", message: "The @gif-tools.html is getting better! When will it be fully ready?", timestamp: new Date(Date.now() - 900000) },
            { user: "DevTeam", message: "Working on @gif-tools.html improvements! Thanks for the feedback ðŸ› ï¸", timestamp: new Date(Date.now() - 600000), isAdmin: true }
        ];

        function toggleChat() {
            // Simplified chat toggle without authentication
            if (!chatWindow) {
                console.log('Chat window not found');
                return;
            }
            
            chatOpen = !chatOpen;
            chatWindow.style.display = chatOpen ? 'flex' : 'none';
            if (chatOpen) {
                loadChatHistory();
                if (chatInput) chatInput.focus();
            }
        }

        // Simplified notification function

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 left-1/2 transform -translate-x-1/2 z-50 px-4 py-2 rounded-lg text-white font-medium ${
                type === 'success' ? 'bg-green-500' : 
                type === 'error' ? 'bg-red-500' : 
                type === 'warning' ? 'bg-yellow-500' : 'bg-blue-500'
            }`;
            notification.textContent = message; // Removed sanitizeInput dependency
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Chat functions without authentication requirements
        let lastMessageTime = 0;
        let messagesThisHour = 0;
        let hourStartTime = Date.now();

        function addMessage(message, isUser = false, username = null, isAdmin = false, skipStorage = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${isUser ? 'user' : 'bot'}`;
            
            // Store message for persistence and download (only if not loading from storage)
            if (!skipStorage) {
                const messageData = {
                    message: message,
                    isUser: isUser,
                    username: username,
                    isAdmin: isAdmin,
                    timestamp: new Date().toISOString(),
                    hasMention: message.includes('@')
                };
                allChatMessages.push(messageData);
                saveChatToStorage();
            }
            
            if (isUser && username) {
                // Format user messages with username - brighter colors for better visibility
                const userColor = isAdmin ? '#ff4500' : '#ffffff'; // Bright orange for admin, white for regular users
                const userBadge = isAdmin ? 'ðŸ‘¨â€ðŸ’»' : 'ðŸ‘¤';
                messageDiv.innerHTML = `<strong style="color: ${userColor}; text-shadow: 0 1px 2px rgba(0,0,0,0.5); font-weight: 700;">${userBadge} ${username}:</strong><br>${highlightMentions(message)}`;
            } else if (!isUser) {
                // Bot/system messages
                messageDiv.innerHTML = message;
            } else {
                // Simple user message without username
                messageDiv.innerHTML = highlightMentions(message);
            }
            
            // Only append to DOM if chatMessages element exists
            if (chatMessages) {
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
        }

        function highlightMentions(text) {
            // Highlight @tool mentions
            text = text.replace(/@tool\b/gi, '<span style="background: #fef3c7; color: #92400e; padding: 2px 4px; border-radius: 4px; font-weight: bold;">@tool</span>');
            
            // Highlight @filename.html mentions
            text = text.replace(/@([a-zA-Z0-9-_]+\.html)\b/gi, '<span style="background: #dbeafe; color: #1d4ed8; padding: 2px 4px; border-radius: 4px; font-weight: bold;">@$1</span>');
            
            // Highlight other @mentions
            text = text.replace(/@([a-zA-Z0-9-_]+)\b/gi, '<span style="background: #f3e8ff; color: #7c3aed; padding: 2px 4px; border-radius: 4px; font-weight: bold;">@$1</span>');
            
            return text;
        }

        async function loadChatHistory() {
            // Only load chat history if chat elements exist
            if (!chatMessages) {
                console.log('Chat elements not available, skipping chat history load');
                return;
            }
            
            try {
                // Load from localStorage only (no backend authentication)
                const savedChat = localStorage.getItem('scribbletools_chat');
                if (savedChat) {
                    allChatMessages = JSON.parse(savedChat);
                } else {
                    // Initialize with sample messages if no saved chat
                    allChatMessages = sampleMessages.map(msg => ({
                        message: msg.message,
                        isUser: true,
                        username: msg.user,
                        isAdmin: msg.isAdmin || false,
                        timestamp: msg.timestamp.toISOString(),
                        hasMention: msg.message.includes('@')
                    }));
                    saveChatToStorage();
                }
                
                // Clear current messages except welcome message
                const welcomeMessage = chatMessages.querySelector('.chat-message.bot');
                chatMessages.innerHTML = '';
                if (welcomeMessage) {
                    chatMessages.appendChild(welcomeMessage);
                }
                
                // Load all saved messages
                allChatMessages.forEach(msg => {
                    addMessageToDisplay(msg.message, msg.isUser, msg.username, msg.isAdmin);
                });
                
            } catch (error) {
                console.error('Error loading chat history:', error);
            }
        }

        function addMessageToDisplay(message, isUser = false, username = null, isAdmin = false) {
            // Use addMessage with skipStorage=true to avoid duplicating in storage
            addMessage(message, isUser, username, isAdmin, true);
        }

        function saveChatToStorage() {
            localStorage.setItem('scribbletools_chat', JSON.stringify(allChatMessages));
        }

        function downloadMentionChats() {
            // Filter messages that contain @ mentions
            const mentionMessages = allChatMessages.filter(msg => msg.hasMention);
            
            if (mentionMessages.length === 0) {
                alert('No messages with @ mentions found!');
                return;
            }

            // Prepare data for Excel
            const excelData = [];
            
            // Add header row
            excelData.push(['Timestamp', 'Username', 'Message', 'Type', 'Has Mention', 'Response 1', 'Response 2']);
            
            // Process each mention message and find the next 2 responses
            mentionMessages.forEach((mentionMsg, index) => {
                const mentionIndex = allChatMessages.findIndex(msg => 
                    msg.timestamp === mentionMsg.timestamp && msg.username === mentionMsg.username
                );
                
                // Get the next 2 messages as responses
                const response1 = allChatMessages[mentionIndex + 1] || null;
                const response2 = allChatMessages[mentionIndex + 2] || null;
                
                // Format the row data
                const row = [
                    new Date(mentionMsg.timestamp).toLocaleString(),
                    mentionMsg.username || 'System',
                    mentionMsg.message.replace(/<[^>]*>/g, ''), // Remove HTML tags
                    mentionMsg.isAdmin ? 'Admin' : (mentionMsg.isUser ? 'User' : 'System'),
                    'Yes',
                    response1 ? `${response1.username || 'System'}: ${response1.message.replace(/<[^>]*>/g, '')}` : '',
                    response2 ? `${response2.username || 'System'}: ${response2.message.replace(/<[^>]*>/g, '')}` : ''
                ];
                
                excelData.push(row);
            });

            // Convert to CSV format
            const csvContent = excelData.map(row => 
                row.map(cell => `"${String(cell).replace(/"/g, '""')}"`).join(',')
            ).join('\n');

            // Create and download the file
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `scribbletools_mention_chats_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function clearChatHistory() {
            if (confirm('Are you sure you want to clear all chat history? This cannot be undone.')) {
                allChatMessages = [];
                localStorage.removeItem('scribbletools_chat');
                loadChatHistory();
            }
        }

        function generateRandomUsername() {
            const adjectives = ['Cool', 'Smart', 'Quick', 'Bright', 'Happy', 'Swift', 'Sharp', 'Clever'];
            const nouns = ['User', 'Coder', 'Helper', 'Builder', 'Maker', 'Thinker', 'Creator'];
            const adj = adjectives[Math.floor(Math.random() * adjectives.length)];
            const noun = nouns[Math.floor(Math.random() * nouns.length)];
            return `${adj}${noun}${Math.floor(Math.random() * 99)}`;
        }

        function detectMentionType(message) {
            if (message.toLowerCase().includes('@tool')) {
                return 'tool';
            } else if (message.match(/@[a-zA-Z0-9-_]+\.html/i)) {
                return 'file';
            } else if (message.match(/@[a-zA-Z0-9-_]+/i)) {
                return 'general';
            }
            return 'chat';
        }

        function handleCommunityMessage(message) {
            const username = generateRandomUsername();
            const mentionType = detectMentionType(message);
            
            // Add user message
            addMessage(message, true, username);
            
            // Check for greeting messages and auto-respond
            const lowerMessage = message.toLowerCase().trim();
            const greetings = ['hi', 'hello', 'hey', 'good morning', 'good afternoon', 'good evening', 'good night'];
            const isGreeting = greetings.some(greeting => 
                lowerMessage === greeting || 
                lowerMessage.startsWith(greeting + ' ') || 
                lowerMessage.startsWith(greeting + '!')
            );
            
            if (isGreeting) {
                const greetingResponses = [
                    "Hi there! ðŸ‘‹ Welcome to ScribbleTools!",
                    "Hello! ðŸ˜Š Great to see you here! Feel free to explore our tools.",
                    "Hey! ðŸŒŸ Hope you're having a great day! What brings you to our tools collection?",
                    "Hi! ðŸ‘‹ Welcome! Check out our amazing tools or suggest new ones.",
                    "Hello and welcome! ðŸŽ‰ We love feedback and suggestions!",
                    "Hey there! ðŸ˜„ Nice to meet you! Don't hesitate to suggest new tools.",
                    "Hi! ðŸš€ Welcome to the ScribbleTools family! What's your favorite type of tool?",
                    "Hello! â­ Great to have you here! We're always improving with new ideas!"
                ];
                
                setTimeout(() => {
                    const randomGreeting = greetingResponses[Math.floor(Math.random() * greetingResponses.length)];
                    addMessage(randomGreeting, false);
                }, 500 + Math.random() * 300);
                
                // Add a second community member response for greetings
                setTimeout(() => {
                    const communityUser = generateRandomUsername();
                    const communityGreetings = [
                        "Welcome to the community! ðŸ¤—",
                        "Hi! Hope you find some useful tools here! ðŸ‘",
                        "Hey! This community has the best tool suggestions! ðŸŒŸ",
                        "Welcome! Feel free to ask if you need help finding anything! ðŸ˜Š",
                        "Hi there! The tools here have saved me so much time! â°",
                        "Hey! Great to see new faces in our community! ðŸŽ‰"
                    ];
                    const communityResponse = communityGreetings[Math.floor(Math.random() * communityGreetings.length)];
                    addMessage(communityResponse, true, communityUser);
                }, 1200 + Math.random() * 800);
                
                return; // Skip the default response system for greetings
            }
            
            // Generate appropriate response based on mention type
            setTimeout(() => {
                let response = '';
                
                switch (mentionType) {
                    case 'tool':
                        const toolIdea = message.replace(/@tool\s*/i, '').trim();
                        response = `ðŸ’¡ Great tool idea "${toolIdea}"! Added to our community suggestions. Other users can vote on this in our development board! ðŸ—³ï¸`;
                        break;
                        
                    case 'file':
                        const fileName = message.match(/@([a-zA-Z0-9-_]+\.html)/i)?.[1];
                        response = `ðŸ“ Thanks for the feedback on <strong>${fileName}</strong>! Our dev team monitors these mentions for improvements. Keep the suggestions coming! ðŸ”§`;
                        break;
                        
                    case 'general':
                        response = `ðŸ‘‹ Thanks for joining the community discussion! Feel free to share ideas, feedback, or chat with other ScribbleTools users!`;
                        break;
                        
                    default:
                        response = `ðŸŒ Message shared with the community! Other users can see and respond to your message.`;
                }
                
                addMessage(response, false);
            }, 800 + Math.random() * 400);

            // Enhanced auto-response system - more frequent responses
            if (Math.random() < 0.6) { // 60% chance of user response
                setTimeout(() => {
                    const otherUser = generateRandomUsername();
                    const randomResponse = autoResponses[Math.floor(Math.random() * autoResponses.length)];
                    addMessage(randomResponse, true, otherUser);
                }, 1500 + Math.random() * 2500);
            }

            // Additional responses for tool mentions (more engagement)
            if (mentionType === 'tool' && Math.random() < 0.4) {
                setTimeout(() => {
                    const supportiveUser = generateRandomUsername();
                    const supportResponses = [
                        "Upvoted! This would be so useful! ðŸ‘",
                        "Yes! I was just thinking about this yesterday!",
                        "The devs should definitely prioritize this! ðŸŽ¯",
                        "I'd use this feature daily! Great idea! ðŸ“…",
                        "This community has the best suggestions! ðŸŒŸ",
                        "Hope this gets built soon! ðŸš€"
                    ];
                    const supportResponse = supportResponses[Math.floor(Math.random() * supportResponses.length)];
                    addMessage(supportResponse, true, supportiveUser);
                }, 3000 + Math.random() * 3000);
            }

            // Occasional admin/developer responses
            if ((mentionType === 'tool' || mentionType === 'file') && Math.random() < 0.15) {
                setTimeout(() => {
                    const devResponses = [
                        "We're looking into this! Thanks for the suggestion ðŸ› ï¸",
                        "Added to our roadmap! Stay tuned for updates ðŸ“‹",
                        "Great feedback! We'll discuss this in our next dev meeting ðŸ‘¨â€ðŸ’»",
                        "This aligns with our plans! Thanks for confirming the need ðŸŽ¯",
                        "Love seeing community engagement like this! Keep it coming! ðŸ’ª"
                    ];
                    const devResponse = devResponses[Math.floor(Math.random() * devResponses.length)];
                    addMessage(devResponse, true, "DevTeam", true); // true for admin
                }, 4000 + Math.random() * 4000);
            }
        }

        async function sendMessage() {
            // Check if chat input exists (may not exist on main page)
            if (!chatInput) {
                console.warn('sendMessage called but chatInput not found');
                return;
            }
            
            const message = chatInput.value.trim();
            if (!message) return;

            // Simple message validation (no authentication needed)
            if (message.length > 500) {
                showNotification('Message too long! Maximum 500 characters.', 'warning');
                return;
            }

            hideAutocomplete();
            
            // Use a generated username since no authentication
            const username = generateRandomUsername();
            const mentionType = detectMentionType(message);
            
            // Add user message
            addMessage(message, true, username, false);
            
            // Clear input
            chatInput.value = '';
            
            // Check for greeting messages and auto-respond
            const lowerMessage = message.toLowerCase().trim();
            const greetings = ['hi', 'hello', 'hey', 'good morning', 'good afternoon', 'good evening', 'good night'];
            const isGreeting = greetings.some(greeting => 
                lowerMessage === greeting || 
                lowerMessage.startsWith(greeting + ' ') || 
                lowerMessage.startsWith(greeting + '!')
            );
            
            if (isGreeting) {
                const greetingResponses = [
                    `Hi ${username}! ðŸ‘‹ Welcome to ScribbleTools!`,
                    `Hello ${username}! ðŸ˜Š Great to see you here! Feel free to explore our tools.`,
                    `Hey ${username}! ðŸŒŸ Hope you\\'re having a great day! What brings you to our tools collection?`,
                    `Hi ${username}! ðŸ‘‹ Welcome! Check out our amazing tools or suggest new ones.`,
                    `Hello and welcome ${username}! ðŸŽ‰ We love feedback and suggestions!`,
                    `Hey there ${username}! ðŸ˜„ Nice to meet you! Don't hesitate to suggest new tools.`,
                    `Hi ${username}! ðŸš€ Welcome to the ScribbleTools family! What's your favorite type of tool?`,
                    `Hello ${username}! â­ Great to have you here! We're always improving with new ideas!`
                ];
                
                setTimeout(() => {
                    const randomGreeting = greetingResponses[Math.floor(Math.random() * greetingResponses.length)];
                    addMessage(randomGreeting, false);
                }, 500 + Math.random() * 300);
                
                // Add a second community member response for greetings
                setTimeout(() => {
                    const communityUser = generateRandomUsername();
                    const communityGreetings = [
                        `Welcome to the community ${username}! ðŸ¤—`,
                        `Hi ${username}! Hope you find some useful tools here! ðŸ‘`,
                        `Hey ${username}! This community has the best tool suggestions! ðŸŒŸ`,
                        `Welcome ${username}! Feel free to ask if you need help finding anything! ðŸ˜Š`,
                        `Hi there ${username}! The tools here have saved me so much time! â°`,
                        `Hey ${username}! Great to see new faces in our community! ðŸŽ‰`
                    ];
                    const communityResponse = communityGreetings[Math.floor(Math.random() * communityGreetings.length)];
                    addMessage(communityResponse, true, communityUser);
                }, 1200 + Math.random() * 800);
                
                chatInput.value = '';
                chatInput.style.height = 'auto';
                return; // Skip the default response system for greetings
            }
            
            // Generate appropriate response based on mention type
            setTimeout(() => {
                let response = '';
                
                switch (mentionType) {
                    case 'tool':
                        const toolIdea = message.replace(/@tool\s*/i, '').trim();
                        response = `ðŸ’¡ Great tool idea "${toolIdea}" from ${username}! Added to our community suggestions. Other users can vote on this in our development board! ðŸ—³ï¸`;
                        break;
                        
                    case 'file':
                        const fileName = message.match(/@([a-zA-Z0-9-_]+\.html)/i)?.[1];
                        response = `ðŸ“ Thanks for the feedback on <strong>${fileName}</strong>, ${username}! Our dev team monitors these mentions for improvements. Keep the suggestions coming! ðŸ”§`;
                        break;
                        
                    case 'general':
                        response = `ðŸ‘‹ Thanks for joining the community discussion, ${username}! Feel free to share ideas, feedback, or chat with other ScribbleTools users!`;
                        break;
                        
                    default:
                        response = `ðŸŒ Message from ${username} shared with the community! Other users can see and respond to your message.`;
                }
                
                addMessage(response, false);
            }, 800 + Math.random() * 400);

            // Enhanced auto-response system - more frequent responses for authenticated users
            if (Math.random() < 0.7) { // 70% chance of user response for authenticated users
                setTimeout(() => {
                    const otherUser = generateRandomUsername();
                    const randomResponse = autoResponses[Math.floor(Math.random() * autoResponses.length)];
                    addMessage(`@${username} ${randomResponse}`, true, otherUser);
                }, 1500 + Math.random() * 2500);
            }

            // Additional responses for tool mentions (more engagement)
            if (mentionType === 'tool' && Math.random() < 0.5) {
                setTimeout(() => {
                    const supportiveUser = generateRandomUsername();
                    const supportResponses = [
                        `@${username} Upvoted! This would be so useful! ðŸ‘`,
                        `@${username} Yes! I was just thinking about this yesterday!`,
                        `@${username} The devs should definitely prioritize this! ðŸŽ¯`,
                        `@${username} I'd use this feature daily! Great idea! ðŸ“…`,
                        `@${username} This community has the best suggestions! ðŸŒŸ`,
                        `@${username} Hope this gets built soon! ðŸš€`
                    ];
                    const supportResponse = supportResponses[Math.floor(Math.random() * supportResponses.length)];
                    addMessage(supportResponse, true, supportiveUser);
                }, 3000 + Math.random() * 3000);
            }

            // Occasional admin/developer responses
            if ((mentionType === 'tool' || mentionType === 'file') && Math.random() < 0.2) {
                setTimeout(() => {
                    const devResponses = [
                        `@${username} We're looking into this! Thanks for the suggestion ðŸ› ï¸`,
                        `@${username} Added to our roadmap! Stay tuned for updates ðŸ“‹`,
                        `@${username} Great feedback! We'll discuss this in our next dev meeting ðŸ‘¨â€ðŸ’»`,
                        `@${username} This aligns with our plans! Thanks for confirming the need ðŸŽ¯`,
                        `@${username} Love seeing community engagement like this! Keep it coming! ðŸ’ª`
                    ];
                    const devResponse = devResponses[Math.floor(Math.random() * devResponses.length)];
                    addMessage(devResponse, true, "DevTeam", true); // true for admin
                }, 4000 + Math.random() * 4000);
            }

            // Clear input if it exists
            if (chatInput) {
                chatInput.value = '';
                chatInput.style.height = 'auto';
            }
        }

        function showAutocomplete(suggestions) {
            if (!chatAutocomplete || suggestions.length === 0) {
                hideAutocomplete();
                return;
            }

            chatAutocomplete.innerHTML = '';
            suggestions.slice(0, 8).forEach((suggestion, index) => {
                const item = document.createElement('div');
                item.className = 'autocomplete-item';
                if (index === selectedAutocompleteIndex) {
                    item.classList.add('selected');
                }
                item.innerHTML = `
                    <span class="autocomplete-icon">${suggestion.icon}</span>
                    <span>${suggestion.name}</span>
                    <small style="margin-left: auto; opacity: 0.7;">${suggestion.category}</small>
                `;
                item.addEventListener('click', () => {
                    insertSuggestion(suggestion.name);
                });
                chatAutocomplete.appendChild(item);
            });

            chatAutocomplete.style.display = 'block';
        }

        function hideAutocomplete() {
            if (chatAutocomplete) {
                chatAutocomplete.style.display = 'none';
            }
            selectedAutocompleteIndex = -1;
        }

        function insertSuggestion(suggestionName) {
            if (!chatInput) return;
            
            const cursorPos = chatInput.selectionStart;
            const textBefore = chatInput.value.substring(0, cursorPos);
            const textAfter = chatInput.value.substring(cursorPos);
            
            // Check if we are completing an @ mention
            const atIndex = textBefore.lastIndexOf('@');
            if (atIndex !== -1 && !textBefore.substring(atIndex + 1).includes(' ')) {
                // @ mention completion
                const newText = textBefore.substring(0, atIndex + 1) + suggestionName + ' ' + textAfter;
                chatInput.value = newText;
                const newCursorPos = atIndex + suggestionName.length + 2;
                chatInput.setSelectionRange(newCursorPos, newCursorPos);
            } else {
                // Regular word completion
                const words = textBefore.split(' ');
                const currentWordIndex = words.length - 1;
                words[currentWordIndex] = suggestionName;
                const newText = words.join(' ') + ' ' + textAfter;
                chatInput.value = newText;
                const newCursorPos = words.join(' ').length + 1;
                chatInput.setSelectionRange(newCursorPos, newCursorPos);
            }
            
            hideAutocomplete();
            chatInput.focus();
        }

        function handleAutocompleteInput() {
            if (!chatInput) return;
            
            const cursorPos = chatInput.selectionStart;
            const textBefore = chatInput.value.substring(0, cursorPos);
            
            // Find the last @ symbol before cursor
            const atIndex = textBefore.lastIndexOf('@');
            
            if (atIndex === -1) {
                // Regular chat autocomplete (without @)
                const words = textBefore.split(' ');
                const currentWord = words[words.length - 1].toLowerCase();
                
                if (currentWord.length >= 2) {
                    // Filter chat suggestions and tools
                    const chatSuggestions = allSuggestions.filter(suggestion =>
                        suggestion.name.toLowerCase().startsWith(currentWord) ||
                        suggestion.name.toLowerCase().includes(currentWord)
                    );
                    
                    if (chatSuggestions.length > 0) {
                        showAutocomplete(chatSuggestions);
                    } else {
                        hideAutocomplete();
                    }
                } else {
                    hideAutocomplete();
                }
                return;
            }

            // Get text after @ symbol
            const afterAt = textBefore.substring(atIndex + 1);
            
            // Check if there's a space after @, if so, hide autocomplete
            if (afterAt.includes(' ')) {
                hideAutocomplete();
                return;
            }

            // Filter suggestions based on input
            const filteredSuggestions = allSuggestions.filter(suggestion =>
                suggestion.name.toLowerCase().includes(afterAt.toLowerCase())
            );

            if (afterAt.length > 0) {
                showAutocomplete(filteredSuggestions);
            } else {
                // Show popular suggestions when just @ is typed
                const popularSuggestions = [
                    { name: 'tool', icon: 'ðŸ”§', category: 'General' },
                    { name: 'calculator', icon: 'ðŸ”¢', category: 'Math' },
                    { name: 'password generator', icon: 'ï¿½', category: 'Security' },
                    { name: 'bmi calculator', icon: 'ðŸ¥', category: 'Health' },
                    { name: 'text counter', icon: 'ðŸ“', category: 'Text' },
                    { name: 'image compressor', icon: 'ðŸ“¦', category: 'Image' },
                    { name: 'budget calculator', icon: 'ï¿½', category: 'Finance' },
                    { name: 'habit tracker', icon: 'ðŸ“…', category: 'Utility' }
                ];
                showAutocomplete(popularSuggestions);
            }
        }

        // Community Chat Popup Functions removed

        // Initialize chat system
        function initializeChat() {
            // Initialize chat DOM elements (they may not exist in main page)
            chatWindow = document.getElementById('chatWindow');
            chatInput = document.getElementById('chatInput');
            chatSend = document.getElementById('chatSend');
            chatMessages = document.getElementById('chatMessages');
            chatAutocomplete = document.getElementById('chatAutocomplete');
            
            // Only set up event listeners if chat elements exist
            if (chatInput && chatSend) {
                chatSend.addEventListener('click', sendMessage);
                chatInput.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendMessage();
                    }
                });
                chatInput.addEventListener('input', handleAutocompleteInput);
            }
            
            // Load chat history if available
            loadChatHistory();
        }

        // Event listeners
        window.addEventListener('hashchange', router);
        window.addEventListener('DOMContentLoaded', router);
        
        // Initialize chat system on page load
        window.addEventListener('DOMContentLoaded', initializeChat);
        
        // Mobile Navigation Toggle with auto-hide functionality
        function initializeMobileNavToggle() {
            const mobileToggle = document.getElementById('mobile-nav-toggle');
            const toolNav = document.getElementById('tool-nav');
            const toggleIcon = document.getElementById('nav-toggle-icon');
            const toggleText = document.getElementById('nav-toggle-text');
            
            if (mobileToggle && toolNav) {
                mobileToggle.addEventListener('click', function() {
                    const isHidden = toolNav.classList.contains('hidden');
                    
                    if (isHidden) {
                        // Show navigation
                        toolNav.classList.remove('hidden');
                        toolNav.classList.add('flex');
                        toggleText.textContent = 'Hide Tools Menu';
                        toggleIcon.style.transform = 'rotate(90deg)';
                    } else {
                        // Hide navigation
                        toolNav.classList.add('hidden');
                        toolNav.classList.remove('flex');
                        toggleText.textContent = 'Show Tools Menu';
                        toggleIcon.style.transform = 'rotate(0deg)';
                    }
                });
            }
        }
        
        // Mobile Header Toggle
        function initializeMobileHeaderToggle() {
            const headerToggle = document.getElementById('mobile-header-toggle');
            const headerMenu = document.getElementById('mobile-header-menu');
            const headerIcon = document.getElementById('mobile-header-icon');
            
            if (headerToggle && headerMenu) {
                headerToggle.addEventListener('click', function() {
                    const isHidden = headerMenu.classList.contains('hidden');
                    
                    if (isHidden) {
                        // Show header menu
                        headerMenu.classList.remove('hidden');
                        headerIcon.style.transform = 'rotate(90deg)';
                        // Change to X icon
                        headerIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />';
                    } else {
                        // Hide header menu
                        headerMenu.classList.add('hidden');
                        headerIcon.style.transform = 'rotate(0deg)';
                        // Change back to hamburger icon
                        headerIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />';
                    }
                });
                
                // Close mobile menu when clicking on a link
                const mobileNavLinks = headerMenu.querySelectorAll('.mobile-nav-link');
                mobileNavLinks.forEach(link => {
                    link.addEventListener('click', function() {
                        headerMenu.classList.add('hidden');
                        headerIcon.style.transform = 'rotate(0deg)';
                        headerIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />';
                    });
                });
            }
        }
        
        // Initialize mobile toggle on page load
        window.addEventListener('DOMContentLoaded', initializeMobileNavToggle);
        window.addEventListener('DOMContentLoaded', initializeMobileHeaderToggle);
        
        // Global dropdown auto-close functionality (works on both mobile and desktop)
        function initializeGlobalAutoClose() {
            const toolNav = document.getElementById('tool-nav');
            const mobileToggle = document.getElementById('mobile-nav-toggle');
            const toggleIcon = document.getElementById('nav-toggle-icon');
            const toggleText = document.getElementById('nav-toggle-text');
            
            if (!toolNav) return;
            
            console.log('Initializing global auto-close functionality');
            
            // Remove existing listeners first to prevent duplicates
            const existingHandler = toolNav.dataset.autoHideHandler;
            if (existingHandler && window[existingHandler]) {
                toolNav.removeEventListener('click', window[existingHandler]);
            }
            
            // Create a single event handler for the entire navigation
            const navClickHandler = function(e) {
                try {
                    // Check if clicked element is a navigation link
                    if (e.target.matches('.nav-link') || e.target.closest('.nav-link')) {
                        console.log('Tool link clicked, checking screen size...', window.innerWidth);
                        
                        // Track the tool click in database
                        const linkElement = e.target.matches('.nav-link') ? e.target : e.target.closest('.nav-link');
                        const href = linkElement.getAttribute('href');
                        
                        if (href && href.startsWith('#') && routes[href]) {
                            const toolPath = routes[href];
                            const toolInfo = getToolInfo(href);
                            
                            // Track click asynchronously (don't block navigation)
                            trackToolClick(toolInfo.toolName, toolPath, toolInfo.category);
                            
                            // Also track with existing analytics
                            trackToolNavigation(toolInfo.toolName);
                        }
                        
                        // Mobile: Hide the entire navigation menu
                        if (window.innerWidth < 768) {
                            console.log('Mobile: Hiding navigation menu');
                            if (toolNav && mobileToggle) {
                                toolNav.classList.add('hidden');
                                toolNav.classList.remove('flex');
                                if (toggleText) toggleText.textContent = 'Show Tools Menu';
                                if (toggleIcon) toggleIcon.style.transform = 'rotate(0deg)';
                            }
                        } 
                        // Desktop: Close all dropdown menus
                        else {
                            console.log('Desktop: Closing dropdown menus');
                            
                            // Use a more specific approach to find open dropdowns
                            const allDetails = toolNav.querySelectorAll('details');
                            const openDetails = Array.from(allDetails).filter(details => details.hasAttribute('open'));
                            
                            console.log(`Found ${openDetails.length} open dropdown(s)`);
                            
                            // Close all open details elements
                            openDetails.forEach(details => {
                                const summaryText = details.querySelector('summary')?.textContent?.trim();
                                console.log('Closing dropdown:', summaryText);
                                
                                details.removeAttribute('open');
                                
                                // Reset arrow indicator
                                const arrow = details.querySelector('summary .arrow');
                                if (arrow) {
                                    arrow.style.transform = 'rotate(0deg)';
                                }
                            });
                            
                            if (openDetails.length > 0) {
                                console.log(`Desktop: Successfully closed ${openDetails.length} dropdown(s) after tool selection`);
                            } else {
                                console.log('Desktop: No open dropdowns found to close');
                            }
                        }
                    }
                } catch (error) {
                    console.error('Error in navigation auto-close handler:', error);
                }
            };
            
            // Store handler reference and add event listener
            const handlerName = 'globalNavAutoHideHandler';
            window[handlerName] = navClickHandler;
            toolNav.dataset.autoHideHandler = handlerName;
            toolNav.addEventListener('click', navClickHandler);
            
            console.log('Global auto-close event handler attached to navigation');
        }
        
        // Initialize global auto-close on page load
        window.addEventListener('DOMContentLoaded', initializeGlobalAutoClose);
        
        // Simple periodic cleanup (no authentication needed)
        setInterval(() => {
            // Just clear any old temporary data occasionally
            const oldData = localStorage.getItem('temp_data');
            if (oldData) {
                try {
                    const data = JSON.parse(oldData);
                    const currentTime = Date.now();
                    
                    // Clean up data older than 24 hours
                    if (data.timestamp && currentTime - data.timestamp > 86400000) {
                        localStorage.removeItem('temp_data');
                    }
                } catch (error) {
                    localStorage.removeItem('temp_data');
                }
            }
        }, 60 * 60 * 1000); // Check every hour

        // Accordion functionality - Auto-close other sections when one is opened
        function setupAccordionBehavior() {
            const categories = document.querySelectorAll('.nav-category');
            const subcategories = document.querySelectorAll('.nav-subcategory');
            
            // For main categories (Text, Math, Financial, etc.)
            categories.forEach(category => {
                category.addEventListener('toggle', function(e) {
                    if (this.open) {
                        // Close all other main categories
                        categories.forEach(otherCategory => {
                            if (otherCategory !== this && otherCategory.open) {
                                otherCategory.open = false;
                            }
                        });
                    }
                });
            });
            
            // For subcategories within each main category
            subcategories.forEach(subcategory => {
                subcategory.addEventListener('toggle', function(e) {
                    if (this.open) {
                        // Find parent category
                        const parentCategory = this.closest('.nav-category');
                        
                        // Close all other subcategories within the same parent category
                        if (parentCategory) {
                            const siblingSubcategories = parentCategory.querySelectorAll('.nav-subcategory');
                            siblingSubcategories.forEach(sibling => {
                                if (sibling !== this && sibling.open) {
                                    sibling.open = false;
                                }
                            });
                        }
                    }
                });
            });
        }
        
        // Initialize accordion behavior when the page loads
        document.addEventListener('DOMContentLoaded', setupAccordionBehavior);
        
        // Also run it immediately in case DOMContentLoaded already fired
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', setupAccordionBehavior);
        } else {
            setupAccordionBehavior();
        }

        // Privacy Notice Functionality
        function initializePrivacyNotice() {
            const privacyBtn = document.getElementById('privacy-btn');
            const privacyModal = document.getElementById('privacy-modal');
            const closePrivacy = document.getElementById('close-privacy');
            const gotItBtn = document.getElementById('got-it-btn');
            const btnText = document.getElementById('btn-text');
            const lampIcon = document.getElementById('lamp-icon');

            if (!privacyBtn || !privacyModal) return;

            // Button hover effects - Magical Genie Animation
            privacyBtn.addEventListener('mouseenter', function() {
                btnText.textContent = 'Rub the Lamp';
                lampIcon.textContent = 'ðŸª”';
                privacyBtn.classList.add('jeene-mode');
                
                // Add magical glow effect
                privacyBtn.style.boxShadow = '0 0 25px rgba(138, 43, 226, 0.6), 0 0 50px rgba(255, 20, 147, 0.4)';
            });

            privacyBtn.addEventListener('mouseleave', function() {
                btnText.textContent = 'Privacy Notice';
                lampIcon.textContent = 'ðŸª”';
                privacyBtn.classList.remove('jeene-mode');
                
                // Remove magical glow
                privacyBtn.style.boxShadow = '';
            });

            // Open modal with magical effect
            privacyBtn.addEventListener('click', function() {
                privacyModal.classList.remove('hidden');
                const modalContent = privacyModal.querySelector('.bg-white');
                modalContent.classList.add('modal-enter');
                
                // Add magical sparkle effect to the modal
                createMagicalSparkles();
                
                // Track the magical interaction
                if (typeof trackCalculatorUsage === 'function') {
                    trackCalculatorUsage('Magic Genie Privacy', 'summon');
                }
            });

            // Close modal functions
            function closeModal() {
                privacyModal.classList.add('hidden');
                const modalContent = privacyModal.querySelector('.bg-white');
                modalContent.classList.remove('modal-enter');
                
                // Remove any remaining sparkles
                removeSparkles();
            }

            if (closePrivacy) closePrivacy.addEventListener('click', closeModal);
            if (gotItBtn) gotItBtn.addEventListener('click', closeModal);

            // Close on outside click
            privacyModal.addEventListener('click', function(e) {
                if (e.target === privacyModal) {
                    closeModal();
                }
            });

            // Close on escape key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && !privacyModal.classList.contains('hidden')) {
                    closeModal();
                }
            });

            // Add magical floating animation to the privacy button
            setInterval(() => {
                if (!privacyBtn.matches(':hover')) {
                    const time = Date.now() / 1000;
                    const float = Math.sin(time) * 3;
                    const rotate = Math.sin(time * 0.5) * 2;
                    privacyBtn.style.transform = `translateY(${float}px) rotate(${rotate}deg)`;
                }
            }, 50);

            // Create magical sparkles around the modal
            function createMagicalSparkles() {
                const modal = document.getElementById('privacy-modal');
                const sparkleEmojis = ['âœ¨', 'â­', 'ðŸ’«', 'ðŸŒŸ', 'ðŸ’Ž', 'ðŸ”®'];
                
                for (let i = 0; i < 15; i++) {
                    setTimeout(() => {
                        const sparkle = document.createElement('div');
                        sparkle.className = 'magical-sparkle fixed pointer-events-none z-50';
                        sparkle.textContent = sparkleEmojis[Math.floor(Math.random() * sparkleEmojis.length)];
                        sparkle.style.left = Math.random() * window.innerWidth + 'px';
                        sparkle.style.top = Math.random() * window.innerHeight + 'px';
                        sparkle.style.fontSize = (Math.random() * 20 + 15) + 'px';
                        sparkle.style.animation = 'sparkle ' + (Math.random() * 2 + 1) + 's ease-in-out infinite';
                        
                        document.body.appendChild(sparkle);
                        
                        // Remove sparkle after animation
                        setTimeout(() => {
                            if (sparkle.parentNode) {
                                sparkle.parentNode.removeChild(sparkle);
                            }
                        }, 3000);
                    }, i * 200);
                }
            }

            function removeSparkles() {
                const sparkles = document.querySelectorAll('.magical-sparkle');
                sparkles.forEach(sparkle => {
                    if (sparkle.parentNode) {
                        sparkle.parentNode.removeChild(sparkle);
                    }
                });
            }
        }

        // Initialize privacy notice when DOM is loaded
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializePrivacyNotice);
        } else {
            initializePrivacyNotice();
        }
    </script>

</body>
</html>
