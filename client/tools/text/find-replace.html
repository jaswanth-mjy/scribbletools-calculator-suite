<!-- File: tools/find-replace.html -->
<!-- This file contains the complete code for the "Find & Replace" tool, designed for the ScribbleTools theme. -->

<style>
    /* --- Custom styles for the Find & Replace Tool --- */
    .fr-textarea {
        background-color: #FDFBF5;
        border: 2px solid #EAE3D5;
        border-radius: 0.5rem;
        padding: 1rem;
        width: 100%;
        color: #4A4A4A;
        transition: all 0.2s;
        font-size: 1.1rem;
        line-height: 1.6;
    }
    .fr-textarea:focus {
        outline: none;
        border-color: #D9534F;
        box-shadow: 0 0 0 3px rgba(217, 83, 79, 0.2);
    }

    .fr-options-box {
        margin-top: 1.5rem;
        padding: 1.5rem;
        background-color: #FDFBF5;
        border-radius: 0.5rem;
        border: 1px solid #EAE3D5;
    }

    .fr-pair-row {
        display: grid;
        grid-template-columns: 1fr 1fr auto;
        gap: 0.75rem;
        align-items: center;
        margin-bottom: 0.75rem;
    }

    .fr-input {
        background-color: #fff;
        border: 1px solid #DCD5C3;
        border-radius: 0.375rem;
        padding: 0.5rem;
        width: 100%;
        color: #4A4A4A;
    }
    
    .fr-action-button {
        background-color: #fff;
        color: #4A4A4A;
        padding: 0.75rem 1.5rem;
        border-radius: 0.5rem;
        font-weight: 600;
        border: 1px solid #DCD5C3;
        cursor: pointer;
        transition: all 0.2s;
    }
    .fr-action-button:hover {
        background-color: #EFEAE0;
        border-color: #C8BFAC;
    }
    .fr-action-button:active {
        transform: scale(0.98);
    }
</style>

<div>
    <h2 class="handwritten text-5xl text-[#D9534F] mb-4">Find & Replace</h2>
    <div class="mb-6 p-6 bg-amber-50/70 rounded-lg border border-amber-200">
        <p class="text-lg text-gray-800 font-bold mb-2">The Find & Replace tool is designed to help you quickly search for specific words, phrases, or patterns in your text and replace them with new content. Itâ€™s perfect for editing documents, code, data, or any large block of text. With support for case sensitivity, whole word matching, and batch replacements, this tool streamlines repetitive editing tasks and ensures consistency throughout your text. Ideal for writers, editors, coders, and anyone who needs to make bulk changes efficiently.</p>
        <ul class="list-disc list-inside text-gray-700 text-base">
            <li>Find and replace words, phrases, or patterns</li>
            <li>Batch replace all occurrences or just the first</li>
            <li>Case sensitive and whole word options</li>
            <li>Efficient for editing documents, code, or data</li>
        </ul>
    </div>
    <p class="text-gray-600 mb-6">
        This tool allows you to find and replace multiple pieces of text within a document simultaneously. It's perfect for developers cleaning up code, writers making bulk edits to a story, or anyone needing to standardize data. Use the "Case Sensitive" option for more control over your replacements.
    </p>

    <div class="space-y-4">
        <div>
            <label for="fr-input" class="block text-sm font-medium text-gray-700 mb-2">Input Data</label>
            <textarea id="fr-input" class="fr-textarea" rows="8" placeholder="Type or paste your content here..."></textarea>
        </div>
        
        <div class="fr-options-box">
            <div class="flex justify-between items-center mb-4">
                <h3 class="font-bold text-lg text-gray-700">Find & Replace Pairs</h3>
                <label class="flex items-center space-x-2 cursor-pointer">
                    <input type="checkbox" id="fr-case-sensitive" class="h-4 w-4 rounded border-gray-300 text-red-500 focus:ring-red-400">
                    <span class="font-medium text-gray-700">Case Sensitive</span>
                </label>
            </div>
            <div id="fr-pairs-container">
                <!-- Dynamic pairs will be inserted here -->
            </div>
            <div class="mt-4">
                 <button id="fr-add-btn" class="fr-action-button bg-green-100 border-green-300 hover:bg-green-200">+ Add Pair</button>
            </div>
        </div>
        
        <div class="flex flex-wrap gap-4">
            <button id="fr-replace-btn" class="fr-action-button bg-[#D9534F] text-white border-red-600 hover:bg-red-600 flex-grow">Find & Replace</button>
            <button id="fr-reset-btn" class="fr-action-button">Reset</button>
        </div>

        <div>
            <label for="fr-output" class="block text-sm font-medium text-gray-700 mb-2">Output Data</label>
            <textarea id="fr-output" class="fr-textarea" rows="8" readonly placeholder="Results will be shown here..."></textarea>
        </div>
    </div>
</div>

<script>
    function initializeFindAndReplace() {
        const container = document.getElementById('fr-pairs-container');
        if (!container) {
            requestAnimationFrame(initializeFindAndReplace);
            return;
        }

        const inputArea = document.getElementById('fr-input');
        const outputArea = document.getElementById('fr-output');
        const addBtn = document.getElementById('fr-add-btn');
        const replaceBtn = document.getElementById('fr-replace-btn');
        const resetBtn = document.getElementById('fr-reset-btn');
        const caseSensitiveCheckbox = document.getElementById('fr-case-sensitive');

        function createNewPair() {
            const row = document.createElement('div');
            row.className = 'fr-pair-row';
            row.innerHTML = `
                <input type="text" class="fr-input fr-find-field" placeholder="Find text">
                <input type="text" class="fr-input fr-replace-field" placeholder="Replace with">
                <button class="fr-action-button bg-red-100 border-red-300 text-red-600 hover:bg-red-200 text-sm px-3 py-1">X</button>
            `;
            container.appendChild(row);
            
            row.querySelector('button').addEventListener('click', (e) => {
                e.target.parentElement.remove();
            });
        }

        function performReplace() {
            let currentText = inputArea.value;
            const pairs = container.querySelectorAll('.fr-pair-row');
            const isCaseSensitive = caseSensitiveCheckbox.checked;
            
            pairs.forEach(pair => {
                const findValue = pair.querySelector('.fr-find-field').value;
                const replaceValue = pair.querySelector('.fr-replace-field').value;

                if (findValue) {
                    const flags = isCaseSensitive ? 'g' : 'gi';
                    const regex = new RegExp(escapeRegExp(findValue), flags);
                    currentText = currentText.replace(regex, replaceValue);
                }
            });
            outputArea.value = currentText;
        }
        
        function escapeRegExp(string) {
            return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        }

        function resetAll() {
            inputArea.value = '';
            outputArea.value = '';
            container.innerHTML = '';
            caseSensitiveCheckbox.checked = false;
            createNewPair();
        }

        addBtn.addEventListener('click', createNewPair);
        replaceBtn.addEventListener('click', performReplace);
        resetBtn.addEventListener('click', resetAll);

        createNewPair();
    }

    initializeFindAndReplace();
</script>
