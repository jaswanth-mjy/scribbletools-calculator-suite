<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Add Name DOB to Photo - FREE ID Photo Text Overlay Tool</title>
  <meta name="description" content="Free tool to add name and date of birth text to photos! Perfect for passport photos, ID cards, visa applications. Custom text overlay tool. 100% free!">
  <meta name="keywords" content="add name to photo, add DOB to photo, photo text overlay, ID photo text, passport photo name, visa photo text, add text to image, photo name overlay, date of birth photo, ID card photo editor, passport photo editor, government photo requirements, official photo text, document photo editor, photo text generator, name DOB overlay, photo personalization, identity photo editor, official document photo, photo text tool, custom photo text, photo annotation tool, image text overlay, professional photo editor">
  <meta name="author" content="Scribble Tools">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://scribbletools.in/client/tools/image/add-name-dob-photo.html">
  <meta property="og:title" content="Add Name DOB to Photo - FREE ID Photo Text Overlay Tool">
  <meta property="og:description" content="Free tool to add name and date of birth text to photos! Perfect for passport photos, ID cards, visa applications. Custom text overlay tool. 100% free!">
  <meta property="og:image" content="https://scribbletools.in/assets/og-image.svg">
  <meta property="og:site_name" content="Scribble Tools">
  <meta property="og:locale" content="en_US">
  
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://scribbletools.in/client/tools/image/add-name-dob-photo.html">
  <meta property="twitter:title" content="Add Name DOB to Photo - FREE ID Photo Text Overlay Tool">
  <meta property="twitter:description" content="Free tool to add name and date of birth text to photos! Perfect for passport photos, ID cards, visa applications. Custom text overlay tool. 100% free!">
  <meta property="twitter:image" content="https://scribbletools.in/assets/og-image.svg">
  
  <!-- Additional SEO Meta Tags -->
  <meta name="robots" content="index, follow">
  <meta name="author" content="Scribble Tools">
  <meta name="generator" content="Scribble Tools">
  <meta name="application-name" content="Photo Text Overlay Tool">
  <meta name="apple-mobile-web-app-title" content="Photo Name DOB Tool">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#D9534F">
  <meta name="msapplication-navbutton-color" content="#D9534F">
  <meta name="apple-mobile-web-app-status-bar-style" content="#D9534F">
  
  <!-- Canonical URL -->
  <link rel="canonical" href="https://scribbletools.in/client/tools/image/add-name-dob-photo.html">
  
  <!-- Preconnect for Performance -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  
  <!-- JSON-LD Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Photo Name DOB Text Overlay Tool",
    "description": "Free online tool for adding name and date of birth text overlays to photos. Perfect for passport photos, ID cards, and official documents.",
    "url": "https://scribbletools.in/client/tools/image/add-name-dob-photo.html",
    "applicationCategory": "MultimediaApplication",
    "operatingSystem": "Any",
    "permissions": "browser",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    },
    "featureList": [
      "Add name text to photos",
      "Add date of birth overlay",
      "ID photo text editor",
      "Passport photo customization",
      "Visa application photos",
      "Custom text positioning",
      "Professional photo editing",
      "No registration required",
      "Free to use"
    ],
    "provider": {
      "@type": "Organization",
      "name": "Scribble Tools",
      "url": "https://scribbletools.in"
    }
  }
  </script>
  
  <style>
    .add-name-dob-tool body { font-family: 'Poppins', sans-serif; background: #F8F4E8; color: #333; }
    .add-name-dob-tool main { display: block; }
    .add-name-dob-tool .reduce-size-container { max-width: 800px; margin: 3em auto; background: #fff; border-radius: 1.2em; box-shadow: 0 4px 24px #eae3d5; padding: 2em 1.5em 2.5em 1.5em; }
    .add-name-dob-tool .handwritten { font-family: 'Caveat', cursive; }
    .add-name-dob-tool .upload-area { border: 3px dashed #D9534F; border-radius: 1em; padding: 3em 2em; text-align: center; margin: 2em 0; background: #FDFBF5; transition: all 0.3s; cursor: pointer; }
    .add-name-dob-tool .upload-area:hover { background: #F0F8FF; border-color: #4682B4; }
    .add-name-dob-tool .upload-icon { font-size: 3em; color: #D9534F; margin-bottom: 1em; text-align: center; }
    .add-name-dob-tool .file-input { display: none; }
    .add-name-dob-tool .upload-btn { background: #D9534F; color: #fff; border: none; border-radius: 0.5em; padding: 1em 2em; font-weight: 600; cursor: pointer; transition: all 0.2s; display: block; margin: 0 auto 1.5em auto; }
    .add-name-dob-tool .upload-btn:hover { background: #c9302c; }
    .add-name-dob-tool .choose-file-btn { background: #D9534F; color: #fff; border: none; border-radius: 0.5em; padding: 1em 2em; font-weight: 600; cursor: pointer; transition: all 0.2s; }
    .add-name-dob-tool .choose-file-btn:hover { background: #c9302c; }
    .add-name-dob-tool .preview-section { margin-top: 2em; text-align: center; display: none; }
    .add-name-dob-tool .preview-section h3 { color: #4682B4; margin-bottom: 1em; }
    .add-name-dob-tool .uploaded-preview { max-width: 100%; max-height: 300px; border-radius: 0.5em; margin: 1em 0; border: 2px solid #EAE3D5; }
    .add-name-dob-tool .controls-section { display: none; margin: 2em 0; background: #FDFBF5; border-radius: 0.7em; padding: 1.2em; border: 1px solid #FFEAA7; }
    .add-name-dob-tool .controls-section h3 { color: #4682B4; margin-bottom: 1em; font-weight: 600; }
    .add-name-dob-tool .form-group { margin: 1.2em 0; }
    .add-name-dob-tool .form-label { font-weight: 600; margin-bottom: 0.5em; display: block; color: #4682B4; }
    .add-name-dob-tool .form-input { width: 100%; padding: 0.8em; border: 2px solid #EAE3D5; border-radius: 0.5em; font-size: 1em; margin-bottom: 1em; background: #fff; }
    .add-name-dob-tool .process-btn { background: #228B22; color: #fff; border: none; border-radius: 0.5em; padding: 1em 2em; font-weight: 600; cursor: pointer; transition: all 0.2s; width: 100%; font-size: 1.1em; }
    .add-name-dob-tool .process-btn:hover { background: #1e7e1e; }
    .add-name-dob-tool .clear-btn { background: #6c757d; color: #fff; border: none; border-radius: 0.5em; padding: 0.8em 1.5em; font-weight: 600; cursor: pointer; transition: all 0.2s; margin-left: 1em; }
    .add-name-dob-tool .clear-btn:hover { background: #5a6268; }
    .add-name-dob-tool .output-preview { background: #FDFBF5; border-radius: 0.7em; padding: 1.2em; text-align: center; margin: 2em 0; border: 1px solid #FFEAA7; display: none; }
    .add-name-dob-tool .output-preview h3 { color: #4682B4; margin-bottom: 1em; font-weight: 600; }
    .add-name-dob-tool .preview-image { max-width: 100%; max-height: 300px; border-radius: 0.5em; margin: 1em 0; border: 2px solid #EAE3D5; }
    .add-name-dob-tool .output-card { display: none; margin-top: 1.5em; }
    .add-name-dob-tool .btn-download { background: #228B22; color: #fff; border: none; border-radius: 0.5em; padding: 1em 2em; font-weight: 600; cursor: pointer; transition: all 0.2s; text-decoration: none; display: inline-block; margin-right: 1em; font-size: 1.1em; }
    .add-name-dob-tool .btn-download:hover { background: #1e7e1e; color: #fff; text-decoration: none; }
    .add-name-dob-tool .related-links { margin-top: 2em; font-size: 1em; }
    .add-name-dob-tool .related-links a { color: #D9534F; text-decoration: underline; margin-right: 1.2em; }
    .add-name-dob-tool .related-links a:hover { color: #4682B4; }
    .add-name-dob-tool .color-control { margin-bottom: 1.5em; background: #fff; padding: 1em; border-radius: 0.5em; border: 1px solid #EAE3D5; }
    .add-name-dob-tool .color-control label { display: block; margin-bottom: 0.5em; color: #4682B4; font-weight: 600; }
    .add-name-dob-tool .color-control input[type="color"] { width: 60px; height: 40px; border: 2px solid #EAE3D5; border-radius: 0.5em; cursor: pointer; padding: 0; }
    .add-name-dob-tool .example-section { background: #FDFBF5; border: 1px solid #FFEAA7; border-radius: 0.7em; padding: 1.2em; margin: 2em 0; }
    .add-name-dob-tool .example-section h3 { color: #4682B4; margin-bottom: 1em; }
    .add-name-dob-tool .feature-list { background: #FDFBF5; border-radius: 0.7em; padding: 1.2em; margin: 2em 0; border: 1px solid #FFEAA7; }
    .add-name-dob-tool .feature-list h3 { color: #4682B4; margin-bottom: 1em; font-weight: 600; }
    .add-name-dob-tool .feature-list ul { list-style: none; padding: 0; }
    .add-name-dob-tool .feature-list li { color: #333; margin-bottom: 0.7em; padding-left: 1.5em; position: relative; }
    .add-name-dob-tool .feature-list li:before { content: "✓"; color: #4682B4; font-weight: bold; position: absolute; left: 0; }
    .add-name-dob-tool .step-list { margin: 1.2em 0 1.2em 1.2em; padding: 0; }
    .add-name-dob-tool .step-list li { margin-bottom: 0.7em; color: #666; }
    .add-name-dob-tool .step-list li strong { color: #4682B4; }
    .add-name-dob-tool .recent-tools { margin: 1em 0; padding: 1.2em; background: #FDFBF5; border-radius: 0.7em; font-size: 0.95em; border: 1px solid #FFEAA7; }
    .add-name-dob-tool .recent-tools strong { color: #4682B4; }
    .add-name-dob-tool .recent-tools a { color: #D9534F; text-decoration: none; margin: 0 0.5em; }
    .add-name-dob-tool .recent-tools a:hover { color: #4682B4; text-decoration: underline; }
    .add-name-dob-tool .recent-tools-list { margin-left: 0.5em; }
    .add-name-dob-tool .sr-only { position: absolute; left: -10000px; top: auto; width: 1px; height: 1px; overflow: hidden; }
    .add-name-dob-tool .instructions { background: #FFF3CD; border: 1px solid #FFD700; border-radius: 0.7em; padding: 1em; margin-bottom: 1.2em; color: #B8860B; font-weight: bold; font-size: 1.1em; }
    .add-name-dob-tool .tool-description h2 { color: #4682B4; margin-bottom: 1em; }
    @media (max-width: 600px) { 
      .add-name-dob-tool .reduce-size-container { padding: 1em 0.2em; }
      .add-name-dob-tool .recent-tools { padding: 1em; }
      .add-name-dob-tool .recent-tools-list { display: flex; flex-wrap: wrap; gap: 0.5em; margin-top: 0.5em; }
      .add-name-dob-tool .color-control { padding: 0.8em; }
    }
  </style>
</head>
<body>
<main>
  <div class="add-name-dob-tool">
    <div class="reduce-size-container">
      <header>
        <h1 style="font-family: 'Caveat', cursive; font-size: 3em; color: #FF6B6B; margin-bottom: 0.5em;">Add Name & DOB to Photo</h1>
        <p style="font-size:1.2em; margin-bottom:1em;">Transform your photos by adding name and date of birth with a professional layout. Fast, privacy-first, and free. No files are stored.</p>
      </header>

      <div style="margin-bottom: 1.5em;">
        <span style="color: #666;">Related:</span>
        <a href="#image-compressor" style="color: #FF6B6B; text-decoration: none; margin: 0 0.5em;">Image Compressor</a>
        <a href="#image-converter" style="color: #FF6B6B; text-decoration: none; margin: 0 0.5em;">Image Converter</a>
        <a href="#grayscale-image" style="color: #FF6B6B; text-decoration: none; margin: 0 0.5em;">Grayscale Image</a>
        <a href="#watermark-images" style="color: #FF6B6B; text-decoration: none; margin: 0 0.5em;">Watermark Images</a>
      </div>

      <div style="background:#FFF3CD; border:1px solid #FFD700; border-radius:0.7em; padding:1em; margin-bottom:1.2em; color:#B8860B; font-weight:bold; font-size:1.1em;">
        ✍️ <b>Add custom name and birth date to your photos with a professional layout.</b> Perfect for official documents, ID cards, and any photos requiring text overlay.
      </div>

      <section aria-labelledby="instructions-title" style="background: #F8FBFF; border-radius: 0.7em; padding: 1.5em; margin: 2em 0; border: 1px solid #4682B4;">
        <h2 id="instructions-title" style="color:#4682B4; margin-bottom: 1em; font-size: 1.5em;">How to Use</h2>
        <ol class="step-list" style="margin-left: 1.5em; line-height: 1.6;">
          <li><strong style="color: #4682B4">Upload Your Photo:</strong>
            <ul style="margin: 0.5em 0 0.5em 1.5em; color: #666;">
              <li>Drag & drop your image into the upload area</li>
              <li>Or click "Choose File" to browse</li>
              <li>Supports JPG, PNG, and other common formats</li>
            </ul>
          </li>
          <li><strong style="color: #4682B4">Add Personal Details:</strong>
            <ul style="margin: 0.5em 0 0.5em 1.5em; color: #666;">
              <li>Enter your full name as it should appear</li>
              <li>Select your date of birth from the calendar</li>
              <li>Choose text position and alignment</li>
            </ul>
          </li>
          <li><strong style="color: #4682B4">Customize Appearance:</strong>
            <ul style="margin: 0.5em 0 0.5em 1.5em; color: #666;">
              <li>Pick text colors for name and date</li>
              <li>Adjust font size if needed</li>
              <li>Preview changes in real-time</li>
            </ul>
          </li>
          <li><strong style="color: #4682B4">Save Your Image:</strong>
            <ul style="margin: 0.5em 0 0.5em 1.5em; color: #666;">
              <li>Click "Download" to save your edited photo</li>
              <li>Original quality maintained</li>
              <li>No watermarks added</li>
            </ul>
          </li>
        </ol>
      </section>
    
      <section class="example-section" style="background: #FDFBF5; border: 1px solid #FFEAA7; border-radius: 0.7em; padding: 1.5em; margin: 2em 0;">
        <h3 style="color: #4682B4; margin-bottom: 1em;">Usage Guide & Examples</h3>
        
        <div style="margin-bottom: 1.5em;">
          <h4 style="color: #FF6B6B; margin-bottom: 0.5em;">📄 Document Photos</h4>
          <ul style="color: #666; margin-left: 1.2em;">
            <li>ID card photos - clear, readable text</li>
            <li>Passport photos - standard format</li>
            <li>Visa applications - official layout</li>
            <li>School/employee IDs - professional style</li>
          </ul>
        </div>
        
        <div style="margin-bottom: 1.5em;">
          <h4 style="color: #FF6B6B; margin-bottom: 0.5em;">🎨 Styling Options</h4>
          <ul style="color: #666; margin-left: 1.2em;">
            <li>Black text - formal documents</li>
            <li>White text - dark backgrounds</li>
            <li>Custom colors - branded content</li>
            <li>Different fonts - various purposes</li>
          </ul>
        </div>
        
        <div>
          <h4 style="color: #FF6B6B; margin-bottom: 0.5em;">💡 Pro Tips</h4>
          <ul style="color: #666; margin-left: 1.2em;">
            <li>Use high-contrast colors for readability</li>
            <li>Position text in clear areas of the image</li>
            <li>Double-check spelling and dates</li>
            <li>Consider official document requirements</li>
          </ul>
        </div>
      </section>

      <section style="margin-top: 2em;">
        <h2 style="color:#FF6B6B; margin-bottom: 0.5em;">Privacy Notice</h2>
        <div style="background: #FFF3CD; border: 1px solid #FFD700; border-radius: 0.7em; padding: 1em; margin-bottom: 1.2em; color: #B8860B;">
                    <strong style="font-size: 1.1em;">🔒 Your files are never uploaded or stored. All processing happens in your browser.</strong>
        </div>
      </section>

      <div class="tool-interface">
        <div class="upload-area" id="upload-area" tabindex="0" aria-label="Upload photo area. Drag and drop or click to select a photo.">
          <div class="upload-icon" aria-hidden="true">🖼️</div>
          <h3>Drag & Drop your photo here</h3>
          <p>or click to browse files</p>
          <input type="file" id="file-input" class="file-input" accept="image/*">
          <button class="upload-btn" id="choose-file-btn">Choose File</button>
          <div id="upload-progress-bar" style="display:none; width:100%; background:#F0F8FF; border-radius:0.5em; margin-top:1.2em; height:1.5em; overflow:hidden; border:1px solid #B0C4DE; position:relative;">
            <div id="upload-progress-fill" style="height:100%; width:0; background:linear-gradient(90deg,#D9534F,#F0AD4E,#5BC0DE,#5CB85C,#A569BD); transition:width 0.2s;"></div>
            <span id="upload-progress-text" style="position:absolute; left:50%; top:0; transform:translateX(-50%); color:#333; font-weight:600; line-height:1.5em; font-size:1em;">Uploading: 0%</span>
          </div>
        </div>
      </div>

      <div class="image-description" id="image-description" style="display: none; background: #E8F5E8; border: 2px solid #5CB85C; border-radius: 0.7em; padding: 1.2em; margin: 1.5em 0; text-align: center;">
        <div style="font-size: 1.5em; color: #228B22; margin-bottom: 0.5em;">📸</div>
        <div style="font-size: 1.1em; color: #228B22; font-weight: 600; margin-bottom: 0.5em;">Image Uploaded Successfully!</div>
        <div style="color: #666; font-size: 0.95em;" id="image-info">Ready for name & DOB addition</div>
      </div>

      <div class="preview-section" id="preview-section">
        <h3>Uploaded Image <button class="clear-btn" id="clear-btn">Clear</button></h3>
        <img id="preview-image" class="uploaded-preview">
      </div>

      <div class="controls-section" id="controls-section">
        <h3>Text Settings</h3>
        
        <div class="form-group">
          <label for="name-input" class="form-label">Name:</label>
          <input type="text" id="name-input" class="form-input" placeholder="Enter full name" />
        </div>
        
        <div class="form-group">
          <label for="dob-input" class="form-label">Date of Birth:</label>
          <input type="date" id="dob-input" class="form-input" max="2025-08-24" />
          <small style="color: #666; display: block; margin-top: 4px;">Select date from calendar</small>
        </div>

        <div class="color-control">
          <label for="font-color">Name Color:</label>
          <input type="color" id="font-color" value="#000000">
        </div>
        
        <div class="color-control">
          <label for="dob-font-color">DOB Color:</label>
          <input type="color" id="dob-font-color" value="#666666">
        </div>
        
        <div class="form-group">
          <button class="process-btn" id="process-btn">Add Name & DOB</button>
        </div>
      </div>

      <div class="output-preview" id="output-preview">
        <h3>Result Preview</h3>
        <img id="result-image" class="preview-image" />
        
        <div class="output-card" id="output-card">
          <a href="#" class="btn-download" id="download-link" download="photo-with-name-dob.jpg">Download Photo</a>
          <button class="clear-btn" id="download-clear-btn">Start Over</button>
        </div>
      </div>

      <div class="feature-list" style="background: #F8F9FA; border-radius: 0.7em; padding: 1.2em; margin: 1.5em 0;">
        <h2 style="color: #4682B4; margin-bottom: 1em;">Key Features</h2>
        <ul>
          <li>Instant name and DOB addition</li>
          <li>Custom text colors and styling</li>
          <li>Clean white label background</li>
          <li>High-quality output</li>
          <li>Privacy-first - no uploads stored</li>
          <li>Works on all devices</li>
          <li>No registration required</li>
          <li>Perfect for official documents</li>
        </ul>
      </div>
      <nav class="recent-tools" aria-label="Recently used tools" style="background: #F8F9FA; border-radius: 0.7em; padding: 1.2em; margin: 1.5em 0;">
        <strong>Recent Tools:</strong>
        <div class="recent-tools-list" style="display: inline-block;">
          <a href="/client/tools/image/black-white-image.html">Black & White Image</a>
          <a href="/client/tools/image/image-color-picker.html">Color Picker</a>
          <a href="/client/tools/image/grayscale-image.html">Grayscale</a>
          <span class="separator" style="margin: 0 0.5em; color: #999;">•</span>
          <a href="#" id="clear-recent" style="color: #D9534F; font-size: 0.9em;">Clear History</a>
        </div>
      </nav>
    </div>
  </div>
</main>

<script>
(function() {
  'use strict';
  
  let uploadedImage = null;
  let canvas = null;
  let ctx = null;
  let isInitialized = false;
  let isProcessing = false;

  // Global initialization function for the main app
  window.initializeAddNameDobTool = function() {
    console.log('🏷️ Initializing Add Name & DOB Tool...');
    reset();
    init();
  };

  function reset() {
    console.log('Resetting tool state...');
    uploadedImage = null;
    canvas = null;
    ctx = null;
    isProcessing = false;
    isInitialized = false;
    
    // Reset UI elements
    const elements = {
      uploadArea: document.getElementById('upload-area'),
      previewSection: document.getElementById('preview-section'),
      controlsSection: document.getElementById('controls-section'),
      outputPreview: document.getElementById('output-preview'),
      imageDescription: document.getElementById('image-description'),
      nameInput: document.getElementById('name-input'),
      dobInput: document.getElementById('dob-input'),
      fontColor: document.getElementById('font-color'),
      dobFontColor: document.getElementById('dob-font-color'),
      fileInput: document.getElementById('file-input'),
      outputCard: document.getElementById('output-card'),
      resultImage: document.getElementById('result-image')
    };
    
    if (elements.uploadArea) elements.uploadArea.style.display = 'block';
    if (elements.previewSection) elements.previewSection.style.display = 'none';
    if (elements.controlsSection) elements.controlsSection.style.display = 'none';
    if (elements.outputPreview) elements.outputPreview.style.display = 'none';
    if (elements.imageDescription) elements.imageDescription.style.display = 'none';
    if (elements.outputCard) elements.outputCard.style.display = 'none';
    
    if (elements.nameInput) elements.nameInput.value = '';
    if (elements.dobInput) elements.dobInput.value = '';
    if (elements.fontColor) elements.fontColor.value = '#000000';
    if (elements.dobFontColor) elements.dobFontColor.value = '#666666';
    if (elements.fileInput) elements.fileInput.value = '';
    if (elements.resultImage) elements.resultImage.src = '';
  }

  function init() {
    if (isInitialized) {
      console.log('Already initialized');
      return;
    }

    console.log('Setting up event listeners...');
    
    // Get elements
    const uploadArea = document.getElementById('upload-area');
    const fileInput = document.getElementById('file-input');
    const chooseFileBtn = document.getElementById('choose-file-btn');
    
    if (!uploadArea || !fileInput || !chooseFileBtn) {
      console.error('Critical elements missing:', {
        uploadArea: !!uploadArea,
        fileInput: !!fileInput,
        chooseFileBtn: !!chooseFileBtn
      });
      setTimeout(init, 100); // Retry
      return;
    }

    // Remove old listeners by cloning
    [uploadArea, fileInput, chooseFileBtn].forEach(el => {
      if (el && el.parentNode) {
        const newEl = el.cloneNode(true);
        el.parentNode.replaceChild(newEl, el);
      }
    });

    // Re-get elements after cloning
    const newUploadArea = document.getElementById('upload-area');
    const newFileInput = document.getElementById('file-input');
    const newChooseFileBtn = document.getElementById('choose-file-btn');

    // Click handlers
    if (newChooseFileBtn) {
      newChooseFileBtn.onclick = function(e) {
        e.preventDefault();
        if (!isProcessing) {
          console.log('🖱️ Choose file clicked');
          newFileInput.click();
        }
      };
    }

    if (newUploadArea) {
      newUploadArea.onclick = function(e) {
        if (e.target !== newChooseFileBtn && !isProcessing) {
          console.log('🖱️ Upload area clicked');
          newFileInput.click();
        }
      };
    }

    // File input change
    if (newFileInput) {
      newFileInput.onchange = function(e) {
        if (e.target.files.length > 0) {
          const file = e.target.files[0];
          console.log('📁 File selected:', file.name);
          if (!isProcessing) {
            startUploadProgress(file);
          }
          e.target.value = '';
        }
      };
    }

    // Drag and drop
    if (newUploadArea) {
      newUploadArea.ondragover = function(e) {
        e.preventDefault();
        if (!isProcessing) {
          newUploadArea.style.backgroundColor = '#F0F8FF';
          newUploadArea.style.borderColor = '#4682B4';
        }
      };

      newUploadArea.ondragleave = function() {
        newUploadArea.style.backgroundColor = '#FDFBF5';
        newUploadArea.style.borderColor = '#D9534F';
      };

      newUploadArea.ondrop = function(e) {
        e.preventDefault();
        newUploadArea.style.backgroundColor = '#FDFBF5';
        newUploadArea.style.borderColor = '#D9534F';
        if (!isProcessing && e.dataTransfer.files.length > 0) {
          startUploadProgress(e.dataTransfer.files[0]);
        }
      };
    }

    // Process button
    const processBtn = document.getElementById('process-btn');
    if (processBtn) {
      processBtn.onclick = processImage;
    }

    // Clear buttons
    ['clear-btn', 'download-clear-btn'].forEach(id => {
      const btn = document.getElementById(id);
      if (btn) btn.onclick = reset;
    });

    // Download button
    const downloadLink = document.getElementById('download-link');
    if (downloadLink) {
      downloadLink.onclick = function(e) {
        if (!uploadedImage) {
          e.preventDefault();
          alert('Please process an image first');
          return;
        }
      };
    }

    isInitialized = true;
    console.log('✅ Add Name & DOB Tool initialized successfully');
  }

  function startUploadProgress(file) {
    if (isProcessing) return;
    const uploadProgressBar = document.getElementById('upload-progress-bar');
    const uploadProgressFill = document.getElementById('upload-progress-fill');
    const uploadProgressText = document.getElementById('upload-progress-text');

    if (!uploadProgressBar || !uploadProgressFill || !uploadProgressText) {
      // Fallback if elements are missing
      handleFile(file);
      return;
    }

    // Reset related UI while "uploading"
    const previewSection = document.getElementById('preview-section');
    const controlsSection = document.getElementById('controls-section');
    const outputPreview = document.getElementById('output-preview');
    if (previewSection) previewSection.style.display = 'none';
    if (controlsSection) controlsSection.style.display = 'none';
    if (outputPreview) outputPreview.style.display = 'none';

    uploadProgressBar.style.display = 'block';
    uploadProgressFill.style.width = '0%';
    uploadProgressText.textContent = 'Uploading: 0%';

    let percent = 0;
    const duration = 800 + Math.random() * 400; // 0.8s - 1.2s
    const start = Date.now();
    function animate() {
      percent = Math.min(100, Math.round(((Date.now() - start) / duration) * 100));
      uploadProgressFill.style.width = percent + '%';
      uploadProgressText.textContent = 'Uploading: ' + percent + '%';
      if (percent < 100) {
        requestAnimationFrame(animate);
      } else {
        setTimeout(() => {
          uploadProgressBar.style.display = 'none';
          handleFile(file);
        }, 200);
      }
    }
    animate();
  }

  function handleFile(file) {
    if (isProcessing) {
      console.log('⚠️ Already processing a file, skipping...');
      return;
    }
    
    isProcessing = true;
    console.log('📤 Processing file:', file.name, 'Size:', file.size, 'Type:', file.type);
    
    if (!file.type.startsWith('image/')) {
      alert('❌ Please select a valid image file (JPEG, PNG, etc.).');
      isProcessing = false;
      return;
    }

    if (file.size > 10 * 1024 * 1024) {
      alert('❌ File size must be less than 10 MB.');
      isProcessing = false;
      return;
    }

    const reader = new FileReader();
    
    reader.onload = function(e) {
      console.log('✅ File read successfully, loading image...');
      uploadedImage = new Image();
      
      uploadedImage.onload = function() {
        console.log('✅ Image loaded successfully:', uploadedImage.width, 'x', uploadedImage.height);
        const previewImage = document.getElementById('preview-image');
        const imageInfo = document.getElementById('image-info');
        const imageDescription = document.getElementById('image-description');
        
        previewImage.src = e.target.result;
        if (imageInfo) {
          const fileSize = (file.size / 1024).toFixed(1);
          imageInfo.textContent = `${file.name} (${fileSize} KB) - Ready for name & DOB addition`;
        }
        
        // Show preview and description
        document.getElementById('preview-section').style.display = 'block';
        document.getElementById('controls-section').style.display = 'block';
        document.getElementById('upload-area').style.display = 'none';
        if (imageDescription) imageDescription.style.display = 'block';
        
        isProcessing = false;
      };
      
      uploadedImage.onerror = function(err) {
        console.error('❌ Error loading image:', err);
        alert('Error loading image. Please try a different file.');
        isProcessing = false;
      };
      
      uploadedImage.src = e.target.result;
    };
    
    reader.onerror = function(err) {
      console.error('❌ Error reading file:', err);
      alert('Error reading file. Please try again.');
      isProcessing = false;
    };
    
    reader.readAsDataURL(file);
  }

  function processImage() {
    const nameText = document.getElementById('name-input').value.trim();
    const dobText = document.getElementById('dob-input').value.trim();
    
    if (!nameText || !dobText) {
      alert('❌ Please enter both name and date of birth');
      return;
    }
    
    // Convert YYYY-MM-DD to DD/MM/YYYY for display
    const dobDate = new Date(dobText);
    if (isNaN(dobDate.getTime())) {
      alert('❌ Please select a valid date of birth');
      return;
    }
    const formattedDOB = dobDate.toLocaleDateString('en-GB', {
      day: '2-digit',
      month: '2-digit',
      year: 'numeric'
    });
    
    if (!uploadedImage) {
      alert('❌ Please upload an image first');
      return;
    }
    
    if (isProcessing) {
      console.log('⚠️ Already processing, please wait...');
      return;
    }
    
    isProcessing = true;
    
    try {
      // Validate the image
      if (!uploadedImage.complete || uploadedImage.naturalWidth === 0) {
        throw new Error('Image not loaded properly. Please try uploading again.');
      }

      // Create canvas with error checking
      canvas = document.createElement('canvas');
      if (!canvas) {
        throw new Error('Could not create canvas. Please refresh your browser.');
      }

      ctx = canvas.getContext('2d');
      if (!ctx) {
        throw new Error('Could not get canvas context. Please try a different browser.');
      }
      
      // Set dimensions with validation
      const textHeight = 80;
      const maxWidth = 4096; // Most browsers support up to 4096px
      const maxHeight = 4096;
      
      if (uploadedImage.width > maxWidth || uploadedImage.height > maxHeight) {
        throw new Error('Image dimensions too large. Maximum size is 4096x4096 pixels.');
      }
      
      if (uploadedImage.width === 0 || uploadedImage.height === 0) {
        throw new Error('Invalid image dimensions. Please try a different image.');
      }
      
      canvas.width = uploadedImage.width;
      canvas.height = uploadedImage.height + textHeight;
      
      // Clear canvas first
      ctx.fillStyle = '#ffffff';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      
      // Draw image with error checking
      try {
        ctx.drawImage(uploadedImage, 0, 0);
      } catch (drawError) {
        throw new Error('Failed to draw image. The image might be corrupted.');
      }
      
      // Add white rectangle for text
      ctx.fillStyle = '#ffffff';
      ctx.fillRect(0, uploadedImage.height, canvas.width, textHeight);
      
      // Get and validate colors
      const nameColor = document.getElementById('font-color')?.value || '#000000';
      const dobColor = document.getElementById('dob-font-color')?.value || '#666666';
      
      // Add text with error checking
      try {
        ctx.fillStyle = nameColor;
        ctx.font = 'bold 24px Arial';
        ctx.textAlign = 'center';
        ctx.fillText(nameText, canvas.width / 2, uploadedImage.height + 30);
        
        ctx.fillStyle = dobColor;
        ctx.font = '20px Arial';
        ctx.fillText(formattedDOB, canvas.width / 2, uploadedImage.height + 60);
      } catch (textError) {
        throw new Error('Failed to add text to image. Please try different text.');
      }
      
      showResult();
      
      // Show success message
      const successMsg = document.createElement('div');
      successMsg.style.cssText = 'background: #E8F5E8; border: 2px solid #5CB85C; border-radius: 0.7em; padding: 1.2em; margin: 1.5em 0; text-align: center; animation: fadeIn 0.5s ease-in;';
      successMsg.innerHTML = `
        <div style="font-size: 1.5em; color: #228B22; margin-bottom: 0.5em;">✅</div>
        <div style="font-size: 1.1em; color: #228B22; font-weight: 600; margin-bottom: 0.5em;">Success!</div>
        <div style="color: #666; font-size: 0.95em;">Name and DOB added successfully. Click the download button below to save your image.</div>
      `;
      const outputPreview = document.getElementById('output-preview');
      outputPreview.insertBefore(successMsg, document.getElementById('output-card'));
      
      // Add fade-in animation style
      if (!document.getElementById('success-animation-style')) {
        const style = document.createElement('style');
        style.id = 'success-animation-style';
        style.textContent = `
          @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
          }
        `;
        document.head.appendChild(style);
      }
      
      console.log('✅ Image processed successfully');
    } catch (error) {
      console.error('❌ Error processing image:', error);
      // Show error message in the UI
      const errorMsg = document.createElement('div');
      errorMsg.style.cssText = 'background: #FFE8E8; border: 2px solid #DC3545; border-radius: 0.7em; padding: 1.2em; margin: 1.5em 0; text-align: center; animation: fadeIn 0.5s ease-in;';
      errorMsg.innerHTML = `
        <div style="font-size: 1.5em; color: #DC3545; margin-bottom: 0.5em;">❌</div>
        <div style="font-size: 1.1em; color: #DC3545; font-weight: 600; margin-bottom: 0.5em;">Error</div>
        <div style="color: #666; font-size: 0.95em;">${error.message || 'An error occurred while processing the image. Please try again.'}</div>
      `;
      const outputPreview = document.getElementById('output-preview');
      const existingError = outputPreview.querySelector('[style*="background: #FFE8E8"]');
      if (existingError) {
        existingError.remove();
      }
      outputPreview.insertBefore(errorMsg, document.getElementById('output-card'));
      outputPreview.style.display = 'block';
    } finally {
      isProcessing = false;
    }
  }

  function showResult() {
    try {
      const resultImage = document.getElementById('result-image');
      const outputPreview = document.getElementById('output-preview');
      const outputCard = document.getElementById('output-card');
      const downloadLink = document.getElementById('download-link');
      
      if (!resultImage || !outputPreview || !outputCard || !downloadLink) {
        throw new Error('Required UI elements not found. Please refresh the page.');
      }
      
      // Create data URL with error handling
      let dataURL;
      try {
        dataURL = canvas.toDataURL('image/jpeg', 0.9);
      } catch (error) {
        throw new Error('Failed to create image. The image might be too large.');
      }
      
      // Set the result image source
      resultImage.src = dataURL;
      
      // Set up download link
      downloadLink.href = dataURL;
      const nameInput = document.getElementById('name-input');
      downloadLink.download = `${nameInput?.value.toLowerCase().replace(/\s+/g, '-') || 'photo'}-with-dob.jpg`;
      
      // Remove any existing success message before showing new result
      const existingSuccess = outputPreview.querySelector('[style*="background: #E8F5E8"]');
      if (existingSuccess) {
        existingSuccess.remove();
      }
      
      // Show the result sections
      outputPreview.style.display = 'block';
      outputCard.style.display = 'block';
    } catch (error) {
      console.error('❌ Error showing result:', error);
      const errorMsg = document.createElement('div');
      errorMsg.style.cssText = 'background: #FFE8E8; border: 2px solid #DC3545; border-radius: 0.7em; padding: 1.2em; margin: 1.5em 0; text-align: center; animation: fadeIn 0.5s ease-in;';
      errorMsg.innerHTML = `
        <div style="font-size: 1.5em; color: #DC3545; margin-bottom: 0.5em;">❌</div>
        <div style="font-size: 1.1em; color: #DC3545; font-weight: 600; margin-bottom: 0.5em;">Error</div>
        <div style="color: #666; font-size: 0.95em;">${error.message}</div>
      `;
      const outputPreview = document.getElementById('output-preview');
      if (outputPreview) {
        const existingError = outputPreview.querySelector('[style*="background: #FFE8E8"]');
        if (existingError) {
          existingError.remove();
        }
        outputPreview.insertBefore(errorMsg, outputPreview.firstChild);
        outputPreview.style.display = 'block';
      }
    }
  }

  // Recent tools functionality
  const RECENT_TOOLS_KEY = 'recentImageTools';
  const MAX_RECENT_TOOLS = 4;

  function initRecentTools() {
    const clearRecentBtn = document.getElementById('clear-recent');
    if (clearRecentBtn) {
      clearRecentBtn.onclick = function(e) {
        e.preventDefault();
        localStorage.removeItem(RECENT_TOOLS_KEY);
        updateRecentToolsList();
      };
    }

    // Add current tool to recent
    const currentToolData = {
      name: 'Add Name & DOB',
      url: window.location.pathname
    };
    addToRecentTools(currentToolData);
    updateRecentToolsList();
  }

  function addToRecentTools(toolData) {
    let recentTools = JSON.parse(localStorage.getItem(RECENT_TOOLS_KEY) || '[]');
    
    // Remove if already exists
    recentTools = recentTools.filter(tool => tool.url !== toolData.url);
    
    // Add to front
    recentTools.unshift(toolData);
    
    // Keep only MAX_RECENT_TOOLS items
    recentTools = recentTools.slice(0, MAX_RECENT_TOOLS);
    
    localStorage.setItem(RECENT_TOOLS_KEY, JSON.stringify(recentTools));
  }

  function updateRecentToolsList() {
    const recentToolsList = document.querySelector('.recent-tools-list');
    if (!recentToolsList) return;

    const recentTools = JSON.parse(localStorage.getItem(RECENT_TOOLS_KEY) || '[]');
    
    if (recentTools.length === 0) {
      recentToolsList.innerHTML = '<span style="color: #666;">No recent tools</span>';
      return;
    }

    const toolLinks = recentTools
      .filter(tool => tool.url !== window.location.pathname) // Don't show current tool
      .map(tool => `<a href="${tool.url}">${tool.name}</a>`)
      .join('<span class="separator" style="margin: 0 0.5em; color: #999;">•</span>');

    recentToolsList.innerHTML = toolLinks + 
      '<span class="separator" style="margin: 0 0.5em; color: #999;">•</span>' +
      '<a href="#" id="clear-recent" style="color: #D9534F; font-size: 0.9em;">Clear History</a>';
    
    // Reattach clear event listener
    const clearRecentBtn = document.getElementById('clear-recent');
    if (clearRecentBtn) {
      clearRecentBtn.onclick = function(e) {
        e.preventDefault();
        localStorage.removeItem(RECENT_TOOLS_KEY);
        updateRecentToolsList();
      };
    }
  }

  // Add recent tools initialization to main init
  const originalInit = init;
  init = function() {
    originalInit();
    initRecentTools();
  };

  // Auto-initialize if DOM is ready
  if (document.readyState !== 'loading') {
    setTimeout(init, 50);
  } else {
    document.addEventListener('DOMContentLoaded', function() {
      setTimeout(init, 50);
    });
  }

})();
</script>
</body>
</html>
